var at={},Ac=(Vi,Fi,dc)=>(at.__chunk_51817=(Ge,Ue,V)=>{V.d(Ue,{CI:()=>k,Jv:()=>Pe,Y9:()=>Me,j2:()=>B});var ge=V(39491),be=V(65667),Ce=V(35237),He=V(52748),ne=V(2793);let fe=He._.ADMIN_PORTAL_USERNAME??"admin",ie=He._.ADMIN_PORTAL_PASSWORD??"admin123",J={id:"admin",name:"Administrator",email:`${fe}@local.dev`,role:"admin"};async function de(b){let y=`${fe}@local.dev`;b.getUserByEmail&&b.createUser&&(await b.getUserByEmail(y)||await b.createUser({id:J.id,name:J.name,email:y,emailVerified:new Date,role:J.role}))}let Ee=(0,ge.hr)(ne.Yh);de(Ee).catch(b=>{console.error("[auth] failed to seed admin user",b)});let{handlers:Me,auth:B,signIn:Pe,signOut:k}=(0,be.Ay)({providers:[(0,Ce.A)({id:"admin-credentials",name:"Admin",credentials:{username:{label:"Username",type:"text",placeholder:"admin"},password:{label:"Password",type:"password"}},async authorize(b){let y=typeof b?.username=="string"?b.username.trim():"",v=typeof b?.password=="string"?b.password:"";return y&&v&&y===fe&&v===ie?J:null}}),(0,Ce.A)({id:"email-login",name:"Email",credentials:{email:{label:"Email",type:"email",placeholder:"you@example.com"}},async authorize(b){let y=typeof b?.email=="string"?b.email.trim().toLowerCase():"";return!y||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(y)?null:await Ee.getUserByEmail?.(y)||(await Ee.createUser?.({id:crypto.randomUUID(),email:y,emailVerified:new Date,role:"user"})??null)}})],adapter:Ee,pages:{signIn:"/login",error:"/auth/error",verifyRequest:"/verify-request"},secret:He._.AUTH_SECRET,session:{strategy:"jwt"},callbacks:{jwt:async({token:b,user:y})=>(y?b.role=y.role==="admin"?"admin":"user":b.role||(b.role="user"),b),async session({session:b,token:y}){if(b.user){y.sub&&(b.user.id=y.sub);let v=y.role==="admin"?"admin":"user";b.user.role=v,b.user.isAdmin=v==="admin"}return b}}})},at.__chunk_70974=(Ge,Ue,V)=>{"use strict";V.d(Ue,{J8:()=>ge.J,Rp:()=>be.R});var ge=V(26804),be=V(11562);V(42409),typeof URLPattern>"u"||URLPattern,V(4515),V(70424),V(899),V(34319),V(10252),V(27223),V(37753),V(83689)},at.__chunk_65667=(Ge,Ue,V)=>{"use strict";let ge,be,Ce,He,ne,fe;V.d(Ue,{Ay:()=>uc});var ie={};V.r(ie),V.d(ie,{q:()=>_o,l:()=>ko});var J=function(e,t,r,i,a){if(i==="m")throw TypeError("Private method is not writable");if(i==="a"&&!a)throw TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?a.call(e,r):a?a.value=r:t.set(e,r),r},de=function(e,t,r,i){if(r==="a"&&!i)throw TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?i:r==="a"?i.call(e):i?i.value:t.get(e)};function Ee(e){let t=e?"__Secure-":"";return{sessionToken:{name:`${t}authjs.session-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},callbackUrl:{name:`${t}authjs.callback-url`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},csrfToken:{name:`${e?"__Host-":""}authjs.csrf-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},pkceCodeVerifier:{name:`${t}authjs.pkce.code_verifier`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}},state:{name:`${t}authjs.state`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}},nonce:{name:`${t}authjs.nonce`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},webauthnChallenge:{name:`${t}authjs.challenge`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}}}}class Me{constructor(t,r,i){if(lr.add(this),nt.set(this,{}),Mt.set(this,void 0),Or.set(this,void 0),J(this,Or,i,"f"),J(this,Mt,t,"f"),!r)return;let{name:a}=t;for(let[n,o]of Object.entries(r))n.startsWith(a)&&o&&(de(this,nt,"f")[n]=o)}get value(){return Object.keys(de(this,nt,"f")).sort((t,r)=>parseInt(t.split(".").pop()||"0")-parseInt(r.split(".").pop()||"0")).map(t=>de(this,nt,"f")[t]).join("")}chunk(t,r){let i=de(this,lr,"m",bi).call(this);for(let a of de(this,lr,"m",xn).call(this,{name:de(this,Mt,"f").name,value:t,options:{...de(this,Mt,"f").options,...r}}))i[a.name]=a;return Object.values(i)}clean(){return Object.values(de(this,lr,"m",bi).call(this))}}nt=new WeakMap,Mt=new WeakMap,Or=new WeakMap,lr=new WeakSet,xn=function(e){let t=Math.ceil(e.value.length/3936);if(t===1)return de(this,nt,"f")[e.name]=e.value,[e];let r=[];for(let i=0;i<t;i++){let a=`${e.name}.${i}`,n=e.value.substr(3936*i,3936);r.push({...e,name:a,value:n}),de(this,nt,"f")[a]=n}return de(this,Or,"f").debug("CHUNKING_SESSION_COOKIE",{message:"Session cookie exceeds allowed 4096 bytes.",emptyCookieSize:160,valueSize:e.value.length,chunks:r.map(i=>i.value.length+160)}),r},bi=function(){let e={};for(let t in de(this,nt,"f"))delete de(this,nt,"f")?.[t],e[t]={name:t,value:"",options:{...de(this,Mt,"f").options,maxAge:0}};return e};class B extends Error{constructor(t,r){t instanceof Error?super(void 0,{cause:{err:t,...t.cause,...r}}):typeof t=="string"?(r instanceof Error&&(r={err:r,...r.cause}),super(t,r)):super(void 0,t),this.name=this.constructor.name,this.type=this.constructor.type??"AuthError",this.kind=this.constructor.kind??"error",Error.captureStackTrace?.(this,this.constructor);let i=`https://errors.authjs.dev#${this.type.toLowerCase()}`;this.message+=`${this.message?". ":""}Read more at ${i}`}}class Pe extends B{}Pe.kind="signIn";class k extends B{}k.type="AdapterError";class b extends B{}b.type="AccessDenied";class y extends B{}y.type="CallbackRouteError";class v extends B{}v.type="ErrorPageLoop";class P extends B{}P.type="EventError";class xe extends B{}xe.type="InvalidCallbackUrl";class De extends Pe{constructor(){super(...arguments),this.code="credentials"}}De.type="CredentialsSignin";class Z extends B{}Z.type="InvalidEndpoints";class q extends B{}q.type="InvalidCheck";class R extends B{}R.type="JWTSessionError";class O extends B{}O.type="MissingAdapter";class ue extends B{}ue.type="MissingAdapterMethods";class Be extends B{}Be.type="MissingAuthorize";class ze extends B{}ze.type="MissingSecret";class ot extends Pe{}ot.type="OAuthAccountNotLinked";class It extends Pe{}It.type="OAuthCallbackError";class et extends B{}et.type="OAuthProfileParseError";class kt extends B{}kt.type="SessionTokenError";class Ot extends Pe{}Ot.type="OAuthSignInError";class Ht extends Pe{}Ht.type="EmailSignInError";class Yt extends B{}Yt.type="SignOutError";class qe extends B{}qe.type="UnknownAction";class Qt extends B{}Qt.type="UnsupportedStrategy";class tt extends B{}tt.type="InvalidProvider";class Wt extends B{}Wt.type="UntrustedHost";class er extends B{}er.type="Verification";class At extends Pe{}At.type="MissingCSRF";let tr=new Set(["CredentialsSignin","OAuthAccountNotLinked","OAuthCallbackError","AccessDenied","Verification","MissingCSRF","AccountNotLinked","WebAuthnVerificationError"]);class Kt extends B{}Kt.type="DuplicateConditionalUI";class rr extends B{}rr.type="MissingWebAuthnAutocomplete";class st extends B{}st.type="WebAuthnVerificationError";class Dt extends Pe{}Dt.type="AccountNotLinked";class vr extends B{}vr.type="ExperimentalFeatureNotEnabled";let ct=!1;function ir(e,t){try{return/^https?:/.test(new URL(e,e.startsWith("/")?t:void 0).protocol)}catch{return!1}}let lt=!1,St=!1,ut=!1,nr=["createVerificationToken","useVerificationToken","getUserByEmail"],_r=["createUser","getUser","getUserByEmail","getUserByAccount","updateUser","linkAccount","createSession","getSessionAndUser","updateSession","deleteSession"],kr=["createUser","getUser","linkAccount","getAccount","getAuthenticator","createAuthenticator","listAuthenticatorsByUserId","updateAuthenticatorCounter"],Ie=()=>{if(typeof Fi<"u")return Fi;if(typeof Vi<"u")return Vi;if(typeof window<"u")return window;throw Error("unable to locate global object")},dt=async(e,t,r,i,a)=>{let{crypto:{subtle:n}}=Ie();return new Uint8Array(await n.deriveBits({name:"HKDF",hash:`SHA-${e.substr(3)}`,salt:r,info:i},await n.importKey("raw",t,"HKDF",!1,["deriveBits"]),a<<3))};function pt(e,t){if(typeof e=="string")return new TextEncoder().encode(e);if(!(e instanceof Uint8Array))throw TypeError(`"${t}"" must be an instance of Uint8Array or a string`);return e}async function ee(e,t,r,i,a){return dt(function(n){switch(n){case"sha256":case"sha384":case"sha512":case"sha1":return n;default:throw TypeError('unsupported "digest" value')}}(e),function(n){let o=pt(n,"ikm");if(!o.byteLength)throw TypeError('"ikm" must be at least one byte in length');return o}(t),pt(r,"salt"),function(n){let o=pt(n,"info");if(o.byteLength>1024)throw TypeError('"info" must not contain more than 1024 bytes');return o}(i),function(n,o){if(typeof n!="number"||!Number.isInteger(n)||n<1)throw TypeError('"keylen" must be a positive integer');if(n>255*(parseInt(o.substr(3),10)>>3||20))throw TypeError('"keylen" too large');return n}(a,e))}let ae=async(e,t)=>{let r=`SHA-${e.slice(-3)}`;return new Uint8Array(await crypto.subtle.digest(r,t))},N=new TextEncoder,oe=new TextDecoder;function ve(...e){let t=new Uint8Array(e.reduce((i,{length:a})=>i+a,0)),r=0;for(let i of e)t.set(i,r),r+=i.length;return t}function te(e,t,r){if(t<0||t>=4294967296)throw RangeError(`value must be >= 0 and <= ${4294967295}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,255&t],r)}function je(e){let t=Math.floor(e/4294967296),r=new Uint8Array(8);return te(r,t,0),te(r,e%4294967296,4),r}function F(e){let t=new Uint8Array(4);return te(t,e),t}function ce(e){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(typeof e=="string"?e:oe.decode(e),{alphabet:"base64url"});let t=e;t instanceof Uint8Array&&(t=oe.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{var r=t;if(Uint8Array.fromBase64)return Uint8Array.fromBase64(r);let i=atob(r),a=new Uint8Array(i.length);for(let n=0;n<i.length;n++)a[n]=i.charCodeAt(n);return a}catch{throw TypeError("The input to be decoded is not correctly encoded.")}}function _e(e){let t=e;return typeof t=="string"&&(t=N.encode(t)),Uint8Array.prototype.toBase64?t.toBase64({alphabet:"base64url",omitPadding:!0}):function(r){if(Uint8Array.prototype.toBase64)return r.toBase64();let i=[];for(let a=0;a<r.length;a+=32768)i.push(String.fromCharCode.apply(null,r.subarray(a,a+32768)));return btoa(i.join(""))}(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}class Ne extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(t,r){super(t,r),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class We extends Ne{static code="ERR_JWT_CLAIM_VALIDATION_FAILED";code="ERR_JWT_CLAIM_VALIDATION_FAILED";claim;reason;payload;constructor(t,r,i="unspecified",a="unspecified"){super(t,{cause:{claim:i,reason:a,payload:r}}),this.claim=i,this.reason=a,this.payload=r}}class Gi extends Ne{static code="ERR_JWT_EXPIRED";code="ERR_JWT_EXPIRED";claim;reason;payload;constructor(t,r,i="unspecified",a="unspecified"){super(t,{cause:{claim:i,reason:a,payload:r}}),this.claim=i,this.reason=a,this.payload=r}}class Xi extends Ne{static code="ERR_JOSE_ALG_NOT_ALLOWED";code="ERR_JOSE_ALG_NOT_ALLOWED"}class we extends Ne{static code="ERR_JOSE_NOT_SUPPORTED";code="ERR_JOSE_NOT_SUPPORTED"}class oi extends Ne{static code="ERR_JWE_DECRYPTION_FAILED";code="ERR_JWE_DECRYPTION_FAILED";constructor(t="decryption operation failed",r){super(t,r)}}class M extends Ne{static code="ERR_JWE_INVALID";code="ERR_JWE_INVALID"}class ht extends Ne{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"}class Wa extends Ne{static code="ERR_JWK_INVALID";code="ERR_JWK_INVALID"}class pc extends Ne{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(t="multiple matching keys found in the JSON Web Key Set",r){super(t,r)}}function ar(e){if(!jt(e))throw Error("CryptoKey instance expected")}function jt(e){return e?.[Symbol.toStringTag]==="CryptoKey"}function si(e){return e?.[Symbol.toStringTag]==="KeyObject"}let ci=e=>jt(e)||si(e),rt=e=>{if(!function(r){return typeof r=="object"&&r!==null}(e)||Object.prototype.toString.call(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t};function Ar(e){return rt(e)&&typeof e.kty=="string"}function Zi(e,t,...r){if((r=r.filter(Boolean)).length>2){let i=r.pop();e+=`one of type ${r.join(", ")}, or ${i}.`}else r.length===2?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return t==null?e+=` Received ${t}`:typeof t=="function"&&t.name?e+=` Received function ${t.name}`:typeof t=="object"&&t!=null&&t.constructor?.name&&(e+=` Received an instance of ${t.constructor.name}`),e}let Nt=(e,...t)=>Zi("Key must be ",e,...t);function Yi(e,t,...r){return Zi(`Key for the ${e} algorithm must be `,t,...r)}async function Ka(e){if(si(e)){if(e.type!=="secret")return e.export({format:"jwk"});e=e.export()}if(e instanceof Uint8Array)return{kty:"oct",k:_e(e)};if(!jt(e))throw TypeError(Nt(e,"CryptoKey","KeyObject","Uint8Array"));if(!e.extractable)throw TypeError("non-extractable CryptoKey cannot be exported as a JWK");let{ext:t,key_ops:r,alg:i,use:a,...n}=await crypto.subtle.exportKey("jwk",e);return n}async function Qi(e){return Ka(e)}let ft=(e,t)=>{if(typeof e!="string"||!e)throw new Wa(`${t} missing or invalid`)};async function en(e,t){let r,i;if(Ar(e))r=e;else if(ci(e))r=await Qi(e);else throw TypeError(Nt(e,"CryptoKey","KeyObject","JSON Web Key"));if((t??="sha256")!=="sha256"&&t!=="sha384"&&t!=="sha512")throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(r.kty){case"EC":ft(r.crv,'"crv" (Curve) Parameter'),ft(r.x,'"x" (X Coordinate) Parameter'),ft(r.y,'"y" (Y Coordinate) Parameter'),i={crv:r.crv,kty:r.kty,x:r.x,y:r.y};break;case"OKP":ft(r.crv,'"crv" (Subtype of Key Pair) Parameter'),ft(r.x,'"x" (Public Key) Parameter'),i={crv:r.crv,kty:r.kty,x:r.x};break;case"RSA":ft(r.e,'"e" (Exponent) Parameter'),ft(r.n,'"n" (Modulus) Parameter'),i={e:r.e,kty:r.kty,n:r.n};break;case"oct":ft(r.k,'"k" (Key Value) Parameter'),i={k:r.k,kty:r.kty};break;default:throw new we('"kty" (Key Type) Parameter missing or unsupported')}let a=N.encode(JSON.stringify(i));return _e(await ae(t,a))}let Da=Symbol();function tn(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new we(`Unsupported JWE Algorithm: ${e}`)}}let ja=e=>crypto.getRandomValues(new Uint8Array(tn(e)>>3)),rn=(e,t)=>{if(t.length<<3!==tn(e))throw new M("Invalid Initialization Vector length")},Sr=(e,t)=>{let r=e.byteLength<<3;if(r!==t)throw new M(`Invalid Content Encryption Key length. Expected ${t} bits, got ${r} bits`)};function mt(e,t="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function Er(e,t){return e.name===t}function yt(e,t,r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!Er(e.algorithm,"AES-GCM"))throw mt("AES-GCM");let n=parseInt(t.slice(1,4),10);if(e.algorithm.length!==n)throw mt(n,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!Er(e.algorithm,"AES-KW"))throw mt("AES-KW");let n=parseInt(t.slice(1,4),10);if(e.algorithm.length!==n)throw mt(n,"algorithm.length");break}case"ECDH":switch(e.algorithm.name){case"ECDH":case"X25519":break;default:throw mt("ECDH or X25519")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!Er(e.algorithm,"PBKDF2"))throw mt("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!Er(e.algorithm,"RSA-OAEP"))throw mt("RSA-OAEP");let n=parseInt(t.slice(9),10)||1;if(parseInt(e.algorithm.hash.name.slice(4),10)!==n)throw mt(`SHA-${n}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}var i=e,a=r;if(a&&!i.usages.includes(a))throw TypeError(`CryptoKey does not support this operation, its usages must include ${a}.`)}async function Na(e,t,r,i,a){if(!(r instanceof Uint8Array))throw TypeError(Nt(r,"Uint8Array"));let n=parseInt(e.slice(1,4),10),o=await crypto.subtle.importKey("raw",r.subarray(n>>3),"AES-CBC",!1,["encrypt"]),s=await crypto.subtle.importKey("raw",r.subarray(0,n>>3),{hash:`SHA-${n<<1}`,name:"HMAC"},!1,["sign"]),l=new Uint8Array(await crypto.subtle.encrypt({iv:i,name:"AES-CBC"},o,t)),p=ve(a,i,l,je(a.length<<3));return{ciphertext:l,tag:new Uint8Array((await crypto.subtle.sign("HMAC",s,p)).slice(0,n>>3)),iv:i}}async function La(e,t,r,i,a){let n;r instanceof Uint8Array?n=await crypto.subtle.importKey("raw",r,"AES-GCM",!1,["encrypt"]):(yt(r,e,"encrypt"),n=r);let o=new Uint8Array(await crypto.subtle.encrypt({additionalData:a,iv:i,name:"AES-GCM",tagLength:128},n,t)),s=o.slice(-16);return{ciphertext:o.slice(0,-16),tag:s,iv:i}}let nn=async(e,t,r,i,a)=>{if(!jt(r)&&!(r instanceof Uint8Array))throw TypeError(Nt(r,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));switch(i?rn(e,i):i=ja(e),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return r instanceof Uint8Array&&Sr(r,parseInt(e.slice(-3),10)),Na(e,t,r,i,a);case"A128GCM":case"A192GCM":case"A256GCM":return r instanceof Uint8Array&&Sr(r,parseInt(e.slice(1,4),10)),La(e,t,r,i,a);default:throw new we("Unsupported JWE Content Encryption Algorithm")}};function an(e,t){if(e.algorithm.length!==parseInt(t.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${t}`)}function on(e,t,r){return e instanceof Uint8Array?crypto.subtle.importKey("raw",e,"AES-KW",!0,[r]):(yt(e,t,r),e)}async function li(e,t,r){let i=await on(t,e,"wrapKey");an(i,e);let a=await crypto.subtle.importKey("raw",r,{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.wrapKey("raw",a,i,"AES-KW"))}async function ui(e,t,r){let i=await on(t,e,"unwrapKey");an(i,e);let a=await crypto.subtle.unwrapKey("raw",r,i,"AES-KW",{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.exportKey("raw",a))}function di(e){return ve(F(e.length),e)}async function Ja(e,t,r){let i=Math.ceil((t>>3)/32),a=new Uint8Array(32*i);for(let n=0;n<i;n++){let o=new Uint8Array(4+e.length+r.length);o.set(F(n+1)),o.set(e,4),o.set(r,4+e.length),a.set(await ae("sha256",o),32*n)}return a.slice(0,t>>3)}async function sn(e,t,r,i,a=new Uint8Array(0),n=new Uint8Array(0)){let o;yt(e,"ECDH"),yt(t,"ECDH","deriveBits");let s=ve(di(N.encode(r)),di(a),di(n),F(i));return o=e.algorithm.name==="X25519"?256:Math.ceil(parseInt(e.algorithm.namedCurve.slice(-3),10)/8)<<3,Ja(new Uint8Array(await crypto.subtle.deriveBits({name:e.algorithm.name,public:e},t,o)),i,s)}function cn(e){switch(e.algorithm.namedCurve){case"P-256":case"P-384":case"P-521":return!0;default:return e.algorithm.name==="X25519"}}let Ma=(e,t)=>ve(N.encode(e),new Uint8Array([0]),t);async function ln(e,t,r,i){if(!(e instanceof Uint8Array)||e.length<8)throw new M("PBES2 Salt Input must be 8 or more octets");let a=Ma(t,e),n=parseInt(t.slice(13,16),10),o={hash:`SHA-${t.slice(8,11)}`,iterations:r,name:"PBKDF2",salt:a},s=await(i instanceof Uint8Array?crypto.subtle.importKey("raw",i,"PBKDF2",!1,["deriveBits"]):(yt(i,t,"deriveBits"),i));return new Uint8Array(await crypto.subtle.deriveBits(o,s,n))}async function Ba(e,t,r,i=2048,a=crypto.getRandomValues(new Uint8Array(16))){let n=await ln(a,e,i,t);return{encryptedKey:await li(e.slice(-6),n,r),p2c:i,p2s:_e(a)}}async function za(e,t,r,i,a){let n=await ln(a,e,i,t);return ui(e.slice(-6),n,r)}let un=(e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){let{modulusLength:r}=t.algorithm;if(typeof r!="number"||r<2048)throw TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}},dn=e=>{switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new we(`alg ${e} is not supported either by JOSE or your javascript runtime`)}};async function qa(e,t,r){return yt(t,e,"encrypt"),un(e,t),new Uint8Array(await crypto.subtle.encrypt(dn(e),t,r))}async function Va(e,t,r){return yt(t,e,"decrypt"),un(e,t),new Uint8Array(await crypto.subtle.decrypt(dn(e),t,r))}let pn=async e=>{if(!e.alg)throw TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:t,keyUsages:r}=function(a){let n,o;switch(a.kty){case"RSA":switch(a.alg){case"PS256":case"PS384":case"PS512":n={name:"RSA-PSS",hash:`SHA-${a.alg.slice(-3)}`},o=a.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":n={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${a.alg.slice(-3)}`},o=a.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":n={name:"RSA-OAEP",hash:`SHA-${parseInt(a.alg.slice(-3),10)||1}`},o=a.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new we('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(a.alg){case"ES256":n={name:"ECDSA",namedCurve:"P-256"},o=a.d?["sign"]:["verify"];break;case"ES384":n={name:"ECDSA",namedCurve:"P-384"},o=a.d?["sign"]:["verify"];break;case"ES512":n={name:"ECDSA",namedCurve:"P-521"},o=a.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":n={name:"ECDH",namedCurve:a.crv},o=a.d?["deriveBits"]:[];break;default:throw new we('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(a.alg){case"Ed25519":case"EdDSA":n={name:"Ed25519"},o=a.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":n={name:a.crv},o=a.d?["deriveBits"]:[];break;default:throw new we('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new we('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:n,keyUsages:o}}(e),i={...e};return delete i.alg,delete i.use,crypto.subtle.importKey("jwk",i,t,e.ext??!e.d,e.key_ops??r)},hn=async(e,t,r,i=!1)=>{let a=(ge||=new WeakMap).get(e);if(a?.[r])return a[r];let n=await pn({...t,alg:r});return i&&Object.freeze(e),a?a[r]=n:ge.set(e,{[r]:n}),n},Fa=(e,t)=>{let r,i=(ge||=new WeakMap).get(e);if(i?.[t])return i[t];let a=e.type==="public",n=!!a;if(e.asymmetricKeyType==="x25519"){switch(t){case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":break;default:throw TypeError("given KeyObject instance cannot be used for this algorithm")}r=e.toCryptoKey(e.asymmetricKeyType,n,a?[]:["deriveBits"])}if(e.asymmetricKeyType==="ed25519"){if(t!=="EdDSA"&&t!=="Ed25519")throw TypeError("given KeyObject instance cannot be used for this algorithm");r=e.toCryptoKey(e.asymmetricKeyType,n,[a?"verify":"sign"])}if(e.asymmetricKeyType==="rsa"){let o;switch(t){case"RSA-OAEP":o="SHA-1";break;case"RS256":case"PS256":case"RSA-OAEP-256":o="SHA-256";break;case"RS384":case"PS384":case"RSA-OAEP-384":o="SHA-384";break;case"RS512":case"PS512":case"RSA-OAEP-512":o="SHA-512";break;default:throw TypeError("given KeyObject instance cannot be used for this algorithm")}if(t.startsWith("RSA-OAEP"))return e.toCryptoKey({name:"RSA-OAEP",hash:o},n,a?["encrypt"]:["decrypt"]);r=e.toCryptoKey({name:t.startsWith("PS")?"RSA-PSS":"RSASSA-PKCS1-v1_5",hash:o},n,[a?"verify":"sign"])}if(e.asymmetricKeyType==="ec"){let o=new Map([["prime256v1","P-256"],["secp384r1","P-384"],["secp521r1","P-521"]]).get(e.asymmetricKeyDetails?.namedCurve);if(!o)throw TypeError("given KeyObject instance cannot be used for this algorithm");t==="ES256"&&o==="P-256"&&(r=e.toCryptoKey({name:"ECDSA",namedCurve:o},n,[a?"verify":"sign"])),t==="ES384"&&o==="P-384"&&(r=e.toCryptoKey({name:"ECDSA",namedCurve:o},n,[a?"verify":"sign"])),t==="ES512"&&o==="P-521"&&(r=e.toCryptoKey({name:"ECDSA",namedCurve:o},n,[a?"verify":"sign"])),t.startsWith("ECDH-ES")&&(r=e.toCryptoKey({name:"ECDH",namedCurve:o},n,a?[]:["deriveBits"]))}if(!r)throw TypeError("given KeyObject instance cannot be used for this algorithm");return i?i[t]=r:ge.set(e,{[t]:r}),r},pi=async(e,t)=>{if(e instanceof Uint8Array||jt(e))return e;if(si(e)){if(e.type==="secret")return e.export();if("toCryptoKey"in e&&typeof e.toCryptoKey=="function")try{return Fa(e,t)}catch(i){if(i instanceof TypeError)throw i}let r=e.export({format:"jwk"});return hn(e,r,t)}if(Ar(e))return e.k?ce(e.k):hn(e,e,t,!0);throw Error("unreachable")};function hi(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new we(`Unsupported JWE Algorithm: ${e}`)}}let Lt=e=>crypto.getRandomValues(new Uint8Array(hi(e)>>3));async function Ga(e,t){if(!(e instanceof Uint8Array))throw TypeError("First argument must be a buffer");if(!(t instanceof Uint8Array))throw TypeError("Second argument must be a buffer");let r={name:"HMAC",hash:"SHA-256"},i=await crypto.subtle.generateKey(r,!1,["sign"]),a=new Uint8Array(await crypto.subtle.sign(r,i,e)),n=new Uint8Array(await crypto.subtle.sign(r,i,t)),o=0,s=-1;for(;++s<32;)o|=a[s]^n[s];return o===0}async function Xa(e,t,r,i,a,n){let o,s;if(!(t instanceof Uint8Array))throw TypeError(Nt(t,"Uint8Array"));let l=parseInt(e.slice(1,4),10),p=await crypto.subtle.importKey("raw",t.subarray(l>>3),"AES-CBC",!1,["decrypt"]),d=await crypto.subtle.importKey("raw",t.subarray(0,l>>3),{hash:`SHA-${l<<1}`,name:"HMAC"},!1,["sign"]),c=ve(n,i,r,je(n.length<<3)),f=new Uint8Array((await crypto.subtle.sign("HMAC",d,c)).slice(0,l>>3));try{o=await Ga(a,f)}catch{}if(!o)throw new oi;try{s=new Uint8Array(await crypto.subtle.decrypt({iv:i,name:"AES-CBC"},p,r))}catch{}if(!s)throw new oi;return s}async function Za(e,t,r,i,a,n){let o;t instanceof Uint8Array?o=await crypto.subtle.importKey("raw",t,"AES-GCM",!1,["decrypt"]):(yt(t,e,"decrypt"),o=t);try{return new Uint8Array(await crypto.subtle.decrypt({additionalData:n,iv:i,name:"AES-GCM",tagLength:128},o,ve(r,a)))}catch{throw new oi}}let fn=async(e,t,r,i,a,n)=>{if(!jt(t)&&!(t instanceof Uint8Array))throw TypeError(Nt(t,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));if(!i)throw new M("JWE Initialization Vector missing");if(!a)throw new M("JWE Authentication Tag missing");switch(rn(e,i),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return t instanceof Uint8Array&&Sr(t,parseInt(e.slice(-3),10)),Xa(e,t,r,i,a,n);case"A128GCM":case"A192GCM":case"A256GCM":return t instanceof Uint8Array&&Sr(t,parseInt(e.slice(1,4),10)),Za(e,t,r,i,a,n);default:throw new we("Unsupported JWE Content Encryption Algorithm")}};async function Ya(e,t,r,i){let a=e.slice(0,7),n=await nn(a,r,t,i,new Uint8Array(0));return{encryptedKey:n.ciphertext,iv:_e(n.iv),tag:_e(n.tag)}}async function Qa(e,t,r,i,a){return fn(e.slice(0,7),t,r,i,a,new Uint8Array(0))}let eo=async(e,t,r,i,a={})=>{let n,o,s;switch(e){case"dir":s=r;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let l;if(ar(r),!cn(r))throw new we("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:p,apv:d}=a;l=a.epk?await pi(a.epk,e):(await crypto.subtle.generateKey(r.algorithm,!0,["deriveBits"])).privateKey;let{x:c,y:f,crv:h,kty:A}=await Qi(l),_=await sn(r,l,e==="ECDH-ES"?t:e,e==="ECDH-ES"?hi(t):parseInt(e.slice(-5,-2),10),p,d);if(o={epk:{x:c,crv:h,kty:A}},A==="EC"&&(o.epk.y=f),p&&(o.apu=_e(p)),d&&(o.apv=_e(d)),e==="ECDH-ES"){s=_;break}s=i||Lt(t);let S=e.slice(-6);n=await li(S,_,s);break}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":s=i||Lt(t),ar(r),n=await qa(e,r,s);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{s=i||Lt(t);let{p2c:l,p2s:p}=a;({encryptedKey:n,...o}=await Ba(e,r,s,l,p));break}case"A128KW":case"A192KW":case"A256KW":s=i||Lt(t),n=await li(e,r,s);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{s=i||Lt(t);let{iv:l}=a;({encryptedKey:n,...o}=await Ya(e,r,s,l));break}default:throw new we('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:s,encryptedKey:n,parameters:o}},mn=(...e)=>{let t,r=e.filter(Boolean);if(r.length===0||r.length===1)return!0;for(let i of r){let a=Object.keys(i);if(!t||t.size===0){t=new Set(a);continue}for(let n of a){if(t.has(n))return!1;t.add(n)}}return!0},yn=(e,t,r,i,a)=>{let n;if(a.crit!==void 0&&i?.crit===void 0)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!i||i.crit===void 0)return new Set;if(!Array.isArray(i.crit)||i.crit.length===0||i.crit.some(o=>typeof o!="string"||o.length===0))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let o of(n=r!==void 0?new Map([...Object.entries(r),...t.entries()]):t,i.crit)){if(!n.has(o))throw new we(`Extension Header Parameter "${o}" is not recognized`);if(a[o]===void 0)throw new e(`Extension Header Parameter "${o}" is missing`);if(n.get(o)&&i[o]===void 0)throw new e(`Extension Header Parameter "${o}" MUST be integrity protected`)}return new Set(i.crit)},Jt=e=>e?.[Symbol.toStringTag],fi=(e,t,r)=>{if(t.use!==void 0){let i;switch(r){case"sign":case"verify":i="sig";break;case"encrypt":case"decrypt":i="enc"}if(t.use!==i)throw TypeError(`Invalid key for this operation, its "use" must be "${i}" when present`)}if(t.alg!==void 0&&t.alg!==e)throw TypeError(`Invalid key for this operation, its "alg" must be "${e}" when present`);if(Array.isArray(t.key_ops)){let i;switch(!0){case(r==="sign"||r==="verify"):case e==="dir":case e.includes("CBC-HS"):i=r;break;case e.startsWith("PBES2"):i="deriveBits";break;case/^A\d{3}(?:GCM)?(?:KW)?$/.test(e):i=!e.includes("GCM")&&e.endsWith("KW")?r==="encrypt"?"wrapKey":"unwrapKey":r;break;case(r==="encrypt"&&e.startsWith("RSA")):i="wrapKey";break;case r==="decrypt":i=e.startsWith("RSA")?"unwrapKey":"deriveBits"}if(i&&t.key_ops?.includes?.(i)===!1)throw TypeError(`Invalid key for this operation, its "key_ops" must include "${i}" when present`)}return!0},to=(e,t,r)=>{if(!(t instanceof Uint8Array)){if(Ar(t)){if(function(i){return i.kty==="oct"&&typeof i.k=="string"}(t)&&fi(e,t,r))return;throw TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!ci(t))throw TypeError(Yi(e,t,"CryptoKey","KeyObject","JSON Web Key","Uint8Array"));if(t.type!=="secret")throw TypeError(`${Jt(t)} instances for symmetric algorithms must be of type "secret"`)}},ro=(e,t,r)=>{if(Ar(t))switch(r){case"decrypt":case"sign":if(function(i){return i.kty!=="oct"&&typeof i.d=="string"}(t)&&fi(e,t,r))return;throw TypeError("JSON Web Key for this operation be a private JWK");case"encrypt":case"verify":if(function(i){return i.kty!=="oct"&&i.d===void 0}(t)&&fi(e,t,r))return;throw TypeError("JSON Web Key for this operation be a public JWK")}if(!ci(t))throw TypeError(Yi(e,t,"CryptoKey","KeyObject","JSON Web Key"));if(t.type==="secret")throw TypeError(`${Jt(t)} instances for asymmetric algorithms must not be of type "secret"`);if(t.type==="public")switch(r){case"sign":throw TypeError(`${Jt(t)} instances for asymmetric algorithm signing must be of type "private"`);case"decrypt":throw TypeError(`${Jt(t)} instances for asymmetric algorithm decryption must be of type "private"`)}if(t.type==="private")switch(r){case"verify":throw TypeError(`${Jt(t)} instances for asymmetric algorithm verifying must be of type "public"`);case"encrypt":throw TypeError(`${Jt(t)} instances for asymmetric algorithm encryption must be of type "public"`)}},wn=(e,t,r)=>{e.startsWith("HS")||e==="dir"||e.startsWith("PBES2")||/^A(?:128|192|256)(?:GCM)?(?:KW)?$/.test(e)||/^A(?:128|192|256)CBC-HS(?:256|384|512)$/.test(e)?to(e,t,r):ro(e,t,r)};class io{#e;#t;#n;#r;#o;#a;#s;#i;constructor(t){if(!(t instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this.#e=t}setKeyManagementParameters(t){if(this.#i)throw TypeError("setKeyManagementParameters can only be called once");return this.#i=t,this}setProtectedHeader(t){if(this.#t)throw TypeError("setProtectedHeader can only be called once");return this.#t=t,this}setSharedUnprotectedHeader(t){if(this.#n)throw TypeError("setSharedUnprotectedHeader can only be called once");return this.#n=t,this}setUnprotectedHeader(t){if(this.#r)throw TypeError("setUnprotectedHeader can only be called once");return this.#r=t,this}setAdditionalAuthenticatedData(t){return this.#o=t,this}setContentEncryptionKey(t){if(this.#a)throw TypeError("setContentEncryptionKey can only be called once");return this.#a=t,this}setInitializationVector(t){if(this.#s)throw TypeError("setInitializationVector can only be called once");return this.#s=t,this}async encrypt(t,r){let i,a,n,o,s;if(!this.#t&&!this.#r&&!this.#n)throw new M("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!mn(this.#t,this.#r,this.#n))throw new M("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let l={...this.#t,...this.#r,...this.#n};if(yn(M,new Map,r?.crit,this.#t,l),l.zip!==void 0)throw new we('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:p,enc:d}=l;if(typeof p!="string"||!p)throw new M('JWE "alg" (Algorithm) Header Parameter missing or invalid');if(typeof d!="string"||!d)throw new M('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(this.#a&&(p==="dir"||p==="ECDH-ES"))throw TypeError(`setContentEncryptionKey cannot be called with JWE "alg" (Algorithm) Header ${p}`);wn(p==="dir"?d:p,t,"encrypt");{let _,S=await pi(t,p);({cek:a,encryptedKey:i,parameters:_}=await eo(p,d,S,this.#a,this.#i)),_&&(r&&Da in r?this.#r?this.#r={...this.#r,..._}:this.setUnprotectedHeader(_):this.#t?this.#t={...this.#t,..._}:this.setProtectedHeader(_))}o=this.#t?N.encode(_e(JSON.stringify(this.#t))):N.encode(""),this.#o?(s=_e(this.#o),n=ve(o,N.encode("."),N.encode(s))):n=o;let{ciphertext:c,tag:f,iv:h}=await nn(d,this.#e,a,this.#s,n),A={ciphertext:_e(c)};return h&&(A.iv=_e(h)),f&&(A.tag=_e(f)),i&&(A.encrypted_key=_e(i)),s&&(A.aad=s),this.#t&&(A.protected=oe.decode(o)),this.#n&&(A.unprotected=this.#n),this.#r&&(A.header=this.#r),A}}class no{#e;constructor(t){this.#e=new io(t)}setContentEncryptionKey(t){return this.#e.setContentEncryptionKey(t),this}setInitializationVector(t){return this.#e.setInitializationVector(t),this}setProtectedHeader(t){return this.#e.setProtectedHeader(t),this}setKeyManagementParameters(t){return this.#e.setKeyManagementParameters(t),this}async encrypt(t,r){let i=await this.#e.encrypt(t,r);return[i.protected,i.encrypted_key,i.iv,i.ciphertext,i.tag].join(".")}}let wt=e=>Math.floor(e.getTime()/1e3),ao=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,or=e=>{let t,r=ao.exec(e);if(!r||r[4]&&r[1])throw TypeError("Invalid time period format");let i=parseFloat(r[2]);switch(r[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":t=Math.round(i);break;case"minute":case"minutes":case"min":case"mins":case"m":t=Math.round(60*i);break;case"hour":case"hours":case"hr":case"hrs":case"h":t=Math.round(3600*i);break;case"day":case"days":case"d":t=Math.round(86400*i);break;case"week":case"weeks":case"w":t=Math.round(604800*i);break;default:t=Math.round(31557600*i)}return r[1]==="-"||r[4]==="ago"?-t:t};function Et(e,t){if(!Number.isFinite(t))throw TypeError(`Invalid ${e} input`);return t}let gn=e=>e.includes("/")?e.toLowerCase():`application/${e.toLowerCase()}`,oo=(e,t)=>typeof e=="string"?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e)));class so{#e;constructor(t){if(!rt(t))throw TypeError("JWT Claims Set MUST be an object");this.#e=structuredClone(t)}data(){return N.encode(JSON.stringify(this.#e))}get iss(){return this.#e.iss}set iss(t){this.#e.iss=t}get sub(){return this.#e.sub}set sub(t){this.#e.sub=t}get aud(){return this.#e.aud}set aud(t){this.#e.aud=t}set jti(t){this.#e.jti=t}set nbf(t){typeof t=="number"?this.#e.nbf=Et("setNotBefore",t):t instanceof Date?this.#e.nbf=Et("setNotBefore",wt(t)):this.#e.nbf=wt(new Date)+or(t)}set exp(t){typeof t=="number"?this.#e.exp=Et("setExpirationTime",t):t instanceof Date?this.#e.exp=Et("setExpirationTime",wt(t)):this.#e.exp=wt(new Date)+or(t)}set iat(t){t===void 0?this.#e.iat=wt(new Date):t instanceof Date?this.#e.iat=Et("setIssuedAt",wt(t)):typeof t=="string"?this.#e.iat=Et("setIssuedAt",wt(new Date)+or(t)):this.#e.iat=Et("setIssuedAt",t)}}class co{#e;#t;#n;#r;#o;#a;#s;#i;constructor(t={}){this.#i=new so(t)}setIssuer(t){return this.#i.iss=t,this}setSubject(t){return this.#i.sub=t,this}setAudience(t){return this.#i.aud=t,this}setJti(t){return this.#i.jti=t,this}setNotBefore(t){return this.#i.nbf=t,this}setExpirationTime(t){return this.#i.exp=t,this}setIssuedAt(t){return this.#i.iat=t,this}setProtectedHeader(t){if(this.#r)throw TypeError("setProtectedHeader can only be called once");return this.#r=t,this}setKeyManagementParameters(t){if(this.#n)throw TypeError("setKeyManagementParameters can only be called once");return this.#n=t,this}setContentEncryptionKey(t){if(this.#e)throw TypeError("setContentEncryptionKey can only be called once");return this.#e=t,this}setInitializationVector(t){if(this.#t)throw TypeError("setInitializationVector can only be called once");return this.#t=t,this}replicateIssuerAsHeader(){return this.#o=!0,this}replicateSubjectAsHeader(){return this.#a=!0,this}replicateAudienceAsHeader(){return this.#s=!0,this}async encrypt(t,r){let i=new no(this.#i.data());return this.#r&&(this.#o||this.#a||this.#s)&&(this.#r={...this.#r,iss:this.#o?this.#i.iss:void 0,sub:this.#a?this.#i.sub:void 0,aud:this.#s?this.#i.aud:void 0}),i.setProtectedHeader(this.#r),this.#t&&i.setInitializationVector(this.#t),this.#e&&i.setContentEncryptionKey(this.#e),this.#n&&i.setKeyManagementParameters(this.#n),i.encrypt(t,r)}}async function lo(e,t,r){let i;if(!rt(e))throw TypeError("JWK must be an object");switch(t??=e.alg,i??=r?.extractable??e.ext,e.kty){case"oct":if(typeof e.k!="string"||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');return ce(e.k);case"RSA":if("oth"in e&&e.oth!==void 0)throw new we('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return pn({...e,alg:t,ext:i});default:throw new we('Unsupported "kty" (Key Type) Parameter value')}}let uo=async(e,t,r,i,a)=>{switch(e){case"dir":if(r!==void 0)throw new M("Encountered unexpected JWE Encrypted Key");return t;case"ECDH-ES":if(r!==void 0)throw new M("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let n,o;if(!rt(i.epk))throw new M('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(ar(t),!cn(t))throw new we("ECDH with the provided key is not allowed or not supported by your javascript runtime");let s=await lo(i.epk,e);if(ar(s),i.apu!==void 0){if(typeof i.apu!="string")throw new M('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{n=ce(i.apu)}catch{throw new M("Failed to base64url decode the apu")}}if(i.apv!==void 0){if(typeof i.apv!="string")throw new M('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{o=ce(i.apv)}catch{throw new M("Failed to base64url decode the apv")}}let l=await sn(s,t,e==="ECDH-ES"?i.enc:e,e==="ECDH-ES"?hi(i.enc):parseInt(e.slice(-5,-2),10),n,o);if(e==="ECDH-ES")return l;if(r===void 0)throw new M("JWE Encrypted Key missing");return ui(e.slice(-6),l,r)}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(r===void 0)throw new M("JWE Encrypted Key missing");return ar(t),Va(e,t,r);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let n;if(r===void 0)throw new M("JWE Encrypted Key missing");if(typeof i.p2c!="number")throw new M('JOSE Header "p2c" (PBES2 Count) missing or invalid');let o=a?.maxPBES2Count||1e4;if(i.p2c>o)throw new M('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if(typeof i.p2s!="string")throw new M('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{n=ce(i.p2s)}catch{throw new M("Failed to base64url decode the p2s")}return za(e,t,r,i.p2c,n)}case"A128KW":case"A192KW":case"A256KW":if(r===void 0)throw new M("JWE Encrypted Key missing");return ui(e,t,r);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let n,o;if(r===void 0)throw new M("JWE Encrypted Key missing");if(typeof i.iv!="string")throw new M('JOSE Header "iv" (Initialization Vector) missing or invalid');if(typeof i.tag!="string")throw new M('JOSE Header "tag" (Authentication Tag) missing or invalid');try{n=ce(i.iv)}catch{throw new M("Failed to base64url decode the iv")}try{o=ce(i.tag)}catch{throw new M("Failed to base64url decode the tag")}return Qa(e,t,r,n,o)}default:throw new we('Invalid or unsupported "alg" (JWE Algorithm) header value')}},bn=(e,t)=>{if(t!==void 0&&(!Array.isArray(t)||t.some(r=>typeof r!="string")))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)};async function po(e,t,r){let i,a,n,o,s,l,p;if(!rt(e))throw new M("Flattened JWE must be an object");if(e.protected===void 0&&e.header===void 0&&e.unprotected===void 0)throw new M("JOSE Header missing");if(e.iv!==void 0&&typeof e.iv!="string")throw new M("JWE Initialization Vector incorrect type");if(typeof e.ciphertext!="string")throw new M("JWE Ciphertext missing or incorrect type");if(e.tag!==void 0&&typeof e.tag!="string")throw new M("JWE Authentication Tag incorrect type");if(e.protected!==void 0&&typeof e.protected!="string")throw new M("JWE Protected Header incorrect type");if(e.encrypted_key!==void 0&&typeof e.encrypted_key!="string")throw new M("JWE Encrypted Key incorrect type");if(e.aad!==void 0&&typeof e.aad!="string")throw new M("JWE AAD incorrect type");if(e.header!==void 0&&!rt(e.header))throw new M("JWE Shared Unprotected Header incorrect type");if(e.unprotected!==void 0&&!rt(e.unprotected))throw new M("JWE Per-Recipient Unprotected Header incorrect type");if(e.protected)try{let g=ce(e.protected);i=JSON.parse(oe.decode(g))}catch{throw new M("JWE Protected Header is invalid")}if(!mn(i,e.header,e.unprotected))throw new M("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let d={...i,...e.header,...e.unprotected};if(yn(M,new Map,r?.crit,i,d),d.zip!==void 0)throw new we('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:c,enc:f}=d;if(typeof c!="string"||!c)throw new M("missing JWE Algorithm (alg) in JWE Header");if(typeof f!="string"||!f)throw new M("missing JWE Encryption Algorithm (enc) in JWE Header");let h=r&&bn("keyManagementAlgorithms",r.keyManagementAlgorithms),A=r&&bn("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(h&&!h.has(c)||!h&&c.startsWith("PBES2"))throw new Xi('"alg" (Algorithm) Header Parameter value not allowed');if(A&&!A.has(f))throw new Xi('"enc" (Encryption Algorithm) Header Parameter value not allowed');if(e.encrypted_key!==void 0)try{a=ce(e.encrypted_key)}catch{throw new M("Failed to base64url decode the encrypted_key")}let _=!1;typeof t=="function"&&(t=await t(i,e),_=!0),wn(c==="dir"?f:c,t,"decrypt");let S=await pi(t,c);try{n=await uo(c,S,a,d,r)}catch(g){if(g instanceof TypeError||g instanceof M||g instanceof we)throw g;n=Lt(f)}if(e.iv!==void 0)try{o=ce(e.iv)}catch{throw new M("Failed to base64url decode the iv")}if(e.tag!==void 0)try{s=ce(e.tag)}catch{throw new M("Failed to base64url decode the tag")}let H=N.encode(e.protected??"");l=e.aad!==void 0?ve(H,N.encode("."),N.encode(e.aad)):H;try{p=ce(e.ciphertext)}catch{throw new M("Failed to base64url decode the ciphertext")}let T={plaintext:await fn(f,n,p,o,s,l)};if(e.protected!==void 0&&(T.protectedHeader=i),e.aad!==void 0)try{T.additionalAuthenticatedData=ce(e.aad)}catch{throw new M("Failed to base64url decode the aad")}return e.unprotected!==void 0&&(T.sharedUnprotectedHeader=e.unprotected),e.header!==void 0&&(T.unprotectedHeader=e.header),_?{...T,key:S}:T}async function ho(e,t,r){if(e instanceof Uint8Array&&(e=oe.decode(e)),typeof e!="string")throw new M("Compact JWE must be a string or Uint8Array");let{0:i,1:a,2:n,3:o,4:s,length:l}=e.split(".");if(l!==5)throw new M("Invalid Compact JWE");let p=await po({ciphertext:o,iv:n||void 0,protected:i,tag:s||void 0,encrypted_key:a||void 0},t,r),d={plaintext:p.plaintext,protectedHeader:p.protectedHeader};return typeof t=="function"?{...d,key:p.key}:d}async function fo(e,t,r){let i=await ho(e,t,r),a=function(s,l,p={}){let d,c;try{d=JSON.parse(oe.decode(l))}catch{}if(!rt(d))throw new ht("JWT Claims Set must be a top-level JSON object");let{typ:f}=p;if(f&&(typeof s.typ!="string"||gn(s.typ)!==gn(f)))throw new We('unexpected "typ" JWT header value',d,"typ","check_failed");let{requiredClaims:h=[],issuer:A,subject:_,audience:S,maxTokenAge:H}=p,T=[...h];for(let m of(H!==void 0&&T.push("iat"),S!==void 0&&T.push("aud"),_!==void 0&&T.push("sub"),A!==void 0&&T.push("iss"),new Set(T.reverse())))if(!(m in d))throw new We(`missing required "${m}" claim`,d,m,"missing");if(A&&!(Array.isArray(A)?A:[A]).includes(d.iss))throw new We('unexpected "iss" claim value',d,"iss","check_failed");if(_&&d.sub!==_)throw new We('unexpected "sub" claim value',d,"sub","check_failed");if(S&&!oo(d.aud,typeof S=="string"?[S]:S))throw new We('unexpected "aud" claim value',d,"aud","check_failed");switch(typeof p.clockTolerance){case"string":c=or(p.clockTolerance);break;case"number":c=p.clockTolerance;break;case"undefined":c=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:g}=p,u=wt(g||new Date);if((d.iat!==void 0||H)&&typeof d.iat!="number")throw new We('"iat" claim must be a number',d,"iat","invalid");if(d.nbf!==void 0){if(typeof d.nbf!="number")throw new We('"nbf" claim must be a number',d,"nbf","invalid");if(d.nbf>u+c)throw new We('"nbf" claim timestamp check failed',d,"nbf","check_failed")}if(d.exp!==void 0){if(typeof d.exp!="number")throw new We('"exp" claim must be a number',d,"exp","invalid");if(d.exp<=u-c)throw new Gi('"exp" claim timestamp check failed',d,"exp","check_failed")}if(H){let m=u-d.iat;if(m-c>(typeof H=="number"?H:or(H)))throw new Gi('"iat" claim timestamp check failed (too far in the past)',d,"iat","check_failed");if(m<0-c)throw new We('"iat" claim timestamp check failed (it should be in the past)',d,"iat","check_failed")}return d}(i.protectedHeader,i.plaintext,r),{protectedHeader:n}=i;if(n.iss!==void 0&&n.iss!==a.iss)throw new We('replicated "iss" claim header parameter mismatch',a,"iss","mismatch");if(n.sub!==void 0&&n.sub!==a.sub)throw new We('replicated "sub" claim header parameter mismatch',a,"sub","mismatch");if(n.aud!==void 0&&JSON.stringify(n.aud)!==JSON.stringify(a.aud))throw new We('replicated "aud" claim header parameter mismatch',a,"aud","mismatch");let o={payload:a,protectedHeader:n};return typeof t=="function"?{...o,key:i.key}:o}let mo=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,yo=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,wo=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,go=/^[\u0020-\u003A\u003D-\u007E]*$/,bo=Object.prototype.toString,vo=(()=>{let e=function(){};return e.prototype=Object.create(null),e})();function _o(e,t){let r=new vo,i=e.length;if(i<2)return r;let a=t?.decode||Ao,n=0;do{let o=e.indexOf("=",n);if(o===-1)break;let s=e.indexOf(";",n),l=s===-1?i:s;if(o>l){n=e.lastIndexOf(";",o-1)+1;continue}let p=vn(e,n,o),d=_n(e,o,p),c=e.slice(p,d);if(r[c]===void 0){let f=vn(e,o+1,l),h=_n(e,l,f),A=a(e.slice(f,h));r[c]=A}n=l+1}while(n<i);return r}function vn(e,t,r){do{let i=e.charCodeAt(t);if(i!==32&&i!==9)return t}while(++t<r);return r}function _n(e,t,r){for(;t>r;){let i=e.charCodeAt(--t);if(i!==32&&i!==9)return t+1}return r}function ko(e,t,r){let i=r?.encode||encodeURIComponent;if(!mo.test(e))throw TypeError(`argument name is invalid: ${e}`);let a=i(t);if(!yo.test(a))throw TypeError(`argument val is invalid: ${t}`);let n=e+"="+a;if(!r)return n;if(r.maxAge!==void 0){if(!Number.isInteger(r.maxAge))throw TypeError(`option maxAge is invalid: ${r.maxAge}`);n+="; Max-Age="+r.maxAge}if(r.domain){if(!wo.test(r.domain))throw TypeError(`option domain is invalid: ${r.domain}`);n+="; Domain="+r.domain}if(r.path){if(!go.test(r.path))throw TypeError(`option path is invalid: ${r.path}`);n+="; Path="+r.path}if(r.expires){var o;if(o=r.expires,bo.call(o)!=="[object Date]"||!Number.isFinite(r.expires.valueOf()))throw TypeError(`option expires is invalid: ${r.expires}`);n+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(n+="; HttpOnly"),r.secure&&(n+="; Secure"),r.partitioned&&(n+="; Partitioned"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():void 0){case"low":n+="; Priority=Low";break;case"medium":n+="; Priority=Medium";break;case"high":n+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":n+="; SameSite=Strict";break;case"lax":n+="; SameSite=Lax";break;case"none":n+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${r.sameSite}`)}return n}function Ao(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}let{q:hc}=ie,So=()=>Date.now()/1e3|0,mi="A256CBC-HS512";async function xr(e){let{token:t={},secret:r,maxAge:i=2592e3,salt:a}=e,n=Array.isArray(r)?r:[r],o=await kn(mi,n[0],a),s=await en({kty:"oct",k:_e(o)},`sha${o.byteLength<<3}`);return await new co(t).setProtectedHeader({alg:"dir",enc:mi,kid:s}).setIssuedAt().setExpirationTime(So()+i).setJti(crypto.randomUUID()).encrypt(o)}async function Tr(e){let{token:t,secret:r,salt:i}=e,a=Array.isArray(r)?r:[r];if(!t)return null;let{payload:n}=await fo(t,async({kid:o,enc:s})=>{for(let l of a){let p=await kn(s,l,i);if(o===void 0||o===await en({kty:"oct",k:_e(p)},`sha${p.byteLength<<3}`))return p}throw Error("no matching decryption secret")},{clockTolerance:15,keyManagementAlgorithms:["dir"],contentEncryptionAlgorithms:[mi,"A256GCM"]});return n}async function kn(e,t,r){let i;switch(e){case"A256CBC-HS512":i=64;break;case"A256GCM":i=32;break;default:throw Error("Unsupported JWT Content Encryption Algorithm")}return await ee("sha256",t,r,`Auth.js Generated Encryption Key (${r})`,i)}async function Eo({options:e,paramValue:t,cookieValue:r}){let{url:i,callbacks:a}=e,n=i.origin;return t?n=await a.redirect({url:t,baseUrl:i.origin}):r&&(n=await a.redirect({url:r,baseUrl:i.origin})),{callbackUrl:n,callbackUrlCookie:n!==r?n:void 0}}let yi="\x1B[31m",sr="\x1B[0m",xo={error(e){let t=e instanceof B?e.type:e.name;if(console.error(`${yi}[auth][error]${sr} ${t}: ${e.message}`),e.cause&&typeof e.cause=="object"&&"err"in e.cause&&e.cause.err instanceof Error){let{err:r,...i}=e.cause;console.error(`${yi}[auth][cause]${sr}:`,r.stack),i&&console.error(`${yi}[auth][details]${sr}:`,JSON.stringify(i,null,2))}else e.stack&&console.error(e.stack.replace(/.*/,"").substring(1))},warn(e){console.warn(`\x1B[33m[auth][warn][${e}]${sr}`,"Read more: https://warnings.authjs.dev")},debug(e,t){console.log(`\x1B[90m[auth][debug]:${sr} ${e}`,JSON.stringify(t,null,2))}};function cr(e){let t={...xo};return e.debug||(t.debug=()=>{}),e.logger?.error&&(t.error=e.logger.error),e.logger?.warn&&(t.warn=e.logger.warn),e.logger?.debug&&(t.debug=e.logger.debug),e.logger??(e.logger=t),t}let To=["providers","session","csrf","signin","signout","callback","verify-request","error","webauthn-options"],{q:Uo,l:Co}=ie;async function Po(e){if(!("body"in e)||!e.body||e.method!=="POST")return;let t=e.headers.get("content-type");return t?.includes("application/json")?await e.json():t?.includes("application/x-www-form-urlencoded")?Object.fromEntries(new URLSearchParams(await e.text())):void 0}async function Ro(e,t){try{if(e.method!=="GET"&&e.method!=="POST")throw new qe("Only GET and POST requests are supported");t.basePath??(t.basePath="/auth");let r=new URL(e.url),{action:i,providerId:a}=function(n,o){let s=n.match(RegExp(`^${o}(.+)`));if(s===null)throw new qe(`Cannot parse action at ${n}`);let l=s.at(-1).replace(/^\//,"").split("/").filter(Boolean);if(l.length!==1&&l.length!==2)throw new qe(`Cannot parse action at ${n}`);let[p,d]=l;if(!To.includes(p)||d&&!["signin","callback","webauthn-options"].includes(p))throw new qe(`Cannot parse action at ${n}`);return{action:p,providerId:d=="undefined"?void 0:d}}(r.pathname,t.basePath);return{url:r,action:i,providerId:a,method:e.method,headers:Object.fromEntries(e.headers),body:e.body?await Po(e):void 0,cookies:Uo(e.headers.get("cookie")??"")??{},error:r.searchParams.get("error")??void 0,query:Object.fromEntries(r.searchParams)}}catch(r){let i=cr(t);i.error(r),i.debug("request",e)}}function An(e){let t=new Headers(e.headers);e.cookies?.forEach(a=>{let{name:n,value:o,options:s}=a,l=Co(n,o,s);t.has("Set-Cookie")?t.append("Set-Cookie",l):t.set("Set-Cookie",l)});let r=e.body;t.get("content-type")==="application/json"?r=JSON.stringify(e.body):t.get("content-type")==="application/x-www-form-urlencoded"&&(r=new URLSearchParams(e.body).toString());let i=new Response(r,{headers:t,status:e.redirect?302:e.status??200});return e.redirect&&i.headers.set("Location",e.redirect),i}async function Ur(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(r=>r.toString(16).padStart(2,"0")).join("").toString()}function wi(e){let t=r=>("0"+r.toString(16)).slice(-2);return Array.from(crypto.getRandomValues(new Uint8Array(e))).reduce((r,i)=>r+t(i),"")}async function $o({options:e,cookieValue:t,isPost:r,bodyValue:i}){if(t){let[o,s]=t.split("|");if(s===await Ur(`${o}${e.secret}`))return{csrfTokenVerified:r&&o===i,csrfToken:o}}let a=wi(32),n=await Ur(`${a}${e.secret}`);return{cookie:`${a}|${n}`,csrfToken:a}}function Cr(e,t){if(!t)throw new At(`CSRF token was missing during an action ${e}`)}function Pr(e){return e!==null&&typeof e=="object"}function Rr(e,...t){if(!t.length)return e;let r=t.shift();if(Pr(e)&&Pr(r))for(let i in r)Pr(r[i])?(Pr(e[i])||(e[i]=Array.isArray(r[i])?[]:{}),Rr(e[i],r[i])):r[i]!==void 0&&(e[i]=r[i]);return Rr(e,...t)}let $r=Symbol("skip-csrf-check"),Ir=Symbol("return-type-raw"),it=Symbol("custom-fetch"),Sn=Symbol("conform-internal"),Io=e=>En({id:e.sub??e.id??crypto.randomUUID(),name:e.name??e.nickname??e.preferred_username,email:e.email,image:e.picture}),Oo=e=>En({access_token:e.access_token,id_token:e.id_token,refresh_token:e.refresh_token,expires_at:e.expires_at,scope:e.scope,token_type:e.token_type,session_state:e.session_state});function En(e){let t={};for(let[r,i]of Object.entries(e))i!==void 0&&(t[r]=i);return t}function gi(e,t){if(!e&&t)return;if(typeof e=="string")return{url:new URL(e)};let r=new URL(e?.url??"https://authjs.dev");if(e?.params!=null)for(let[i,a]of Object.entries(e.params))i==="claims"&&(a=JSON.stringify(a)),r.searchParams.set(i,String(a));return{url:r,request:e?.request,conform:e?.conform,...e?.clientPrivateKey?{clientPrivateKey:e?.clientPrivateKey}:null}}let Ho={signIn:()=>!0,redirect:({url:e,baseUrl:t})=>e.startsWith("/")?`${t}${e}`:new URL(e).origin===t?e:t,session:({session:e})=>({user:{name:e.user?.name,email:e.user?.email,image:e.user?.image},expires:e.expires?.toISOString?.()??e.expires}),jwt:({token:e})=>e};async function Wo({authOptions:e,providerId:t,action:r,url:i,cookies:a,callbackUrl:n,csrfToken:o,csrfDisabled:s,isPost:l}){var p,d;let c=cr(e),{providers:f,provider:h}=function(g){let{providerId:u,config:m}=g,w=new URL(m.basePath??"/auth",g.url.origin),E=m.providers.map(K=>{let C=typeof K=="function"?K():K,{options:x,...z}=C,G=x?.id??z.id,I=Rr(z,x,{signinUrl:`${w}/signin/${G}`,callbackUrl:`${w}/callback/${G}`});if(C.type==="oauth"||C.type==="oidc"){I.redirectProxyUrl??(I.redirectProxyUrl=x?.redirectProxyUrl??m.redirectProxyUrl);let W=function(D){D.issuer&&(D.wellKnown??(D.wellKnown=`${D.issuer}/.well-known/openid-configuration`));let le=gi(D.authorization,D.issuer);le&&!le.url?.searchParams.has("scope")&&le.url.searchParams.set("scope","openid profile email");let X=gi(D.token,D.issuer),pe=gi(D.userinfo,D.issuer),L=D.checks??["pkce"];return D.redirectProxyUrl&&(L.includes("state")||L.push("state"),D.redirectProxyUrl=`${D.redirectProxyUrl}/callback/${D.id}`),{...D,authorization:le,token:X,checks:L,userinfo:pe,profile:D.profile??Io,account:D.account??Oo}}(I);return W.authorization?.url.searchParams.get("response_mode")==="form_post"&&delete W.redirectProxyUrl,W[it]??(W[it]=x?.[it]),W}return I}),U=E.find(({id:K})=>K===u);if(u&&!U){let K=E.map(C=>C.id).join(", ");throw Error(`Provider with id "${u}" not found. Available providers: [${K}].`)}return{providers:E,provider:U}}({url:i,providerId:t,config:e}),A=!1;if((h?.type==="oauth"||h?.type==="oidc")&&h.redirectProxyUrl)try{A=new URL(h.redirectProxyUrl).origin===i.origin}catch{throw TypeError(`redirectProxyUrl must be a valid URL. Received: ${h.redirectProxyUrl}`)}let _={debug:!1,pages:{},theme:{colorScheme:"auto",logo:"",brandColor:"",buttonText:""},...e,url:i,action:r,provider:h,cookies:Rr(Ee(e.useSecureCookies??i.protocol==="https:"),e.cookies),providers:f,session:{strategy:e.adapter?"database":"jwt",maxAge:2592e3,updateAge:86400,generateSessionToken:()=>crypto.randomUUID(),...e.session},jwt:{secret:e.secret,maxAge:e.session?.maxAge??2592e3,encode:xr,decode:Tr,...e.jwt},events:(p=e.events??{},d=c,Object.keys(p).reduce((g,u)=>(g[u]=async(...m)=>{try{let w=p[u];return await w(...m)}catch(w){d.error(new P(w))}},g),{})),adapter:function(g,u){if(g)return Object.keys(g).reduce((m,w)=>(m[w]=async(...E)=>{try{u.debug(`adapter_${w}`,{args:E});let U=g[w];return await U(...E)}catch(U){let K=new k(U);throw u.error(K),K}},m),{})}(e.adapter,c),callbacks:{...Ho,...e.callbacks},logger:c,callbackUrl:i.origin,isOnRedirectProxy:A,experimental:{...e.experimental}},S=[];if(s)_.csrfTokenVerified=!0;else{let{csrfToken:g,cookie:u,csrfTokenVerified:m}=await $o({options:_,cookieValue:a?.[_.cookies.csrfToken.name],isPost:l,bodyValue:o});_.csrfToken=g,_.csrfTokenVerified=m,u&&S.push({name:_.cookies.csrfToken.name,value:u,options:_.cookies.csrfToken.options})}let{callbackUrl:H,callbackUrlCookie:T}=await Eo({options:_,cookieValue:a?.[_.cookies.callbackUrl.name],paramValue:n});return _.callbackUrl=H,T&&S.push({name:_.cookies.callbackUrl.name,value:T,options:_.cookies.callbackUrl.options}),{options:_,cookies:S}}var lr,nt,Mt,Or,xn,bi,Hr,Y,Tn,xt,Un,Cn,vi,_i,ki,Ai,ur={},Pn=[],Ko=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Si=Array.isArray;function gt(e,t){for(var r in t)e[r]=t[r];return e}function Rn(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function $n(e,t,r){var i,a,n,o={};for(n in t)n=="key"?i=t[n]:n=="ref"?a=t[n]:o[n]=t[n];if(arguments.length>2&&(o.children=arguments.length>3?Hr.call(arguments,2):r),typeof e=="function"&&e.defaultProps!=null)for(n in e.defaultProps)o[n]===void 0&&(o[n]=e.defaultProps[n]);return Wr(e,o,i,a,null)}function Wr(e,t,r,i,a){var n={type:e,props:t,key:r,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:a??++Tn,__i:-1,__u:0};return a==null&&Y.vnode!=null&&Y.vnode(n),n}function Xe(e){return e.children}function Kr(e,t){this.props=e,this.context=t}function Bt(e,t){if(t==null)return e.__?Bt(e.__,e.__i+1):null;for(var r;t<e.__k.length;t++)if((r=e.__k[t])!=null&&r.__e!=null)return r.__e;return typeof e.type=="function"?Bt(e):null}function In(e){(!e.__d&&(e.__d=!0)&&xt.push(e)&&!Dr.__r++||Un!==Y.debounceRendering)&&((Un=Y.debounceRendering)||Cn)(Dr)}function Dr(){var e,t,r,i,a,n,o,s;for(xt.sort(vi);e=xt.shift();)e.__d&&(t=xt.length,i=void 0,n=(a=(r=e).__v).__e,o=[],s=[],r.__P&&((i=gt({},a)).__v=a.__v+1,Y.vnode&&Y.vnode(i),Ei(r.__P,i,a,r.__n,r.__P.namespaceURI,32&a.__u?[n]:null,o,n??Bt(a),!!(32&a.__u),s),i.__v=a.__v,i.__.__k[i.__i]=i,Kn(o,i,s),i.__e!=n&&function l(p){var d,c;if((p=p.__)!=null&&p.__c!=null){for(p.__e=p.__c.base=null,d=0;d<p.__k.length;d++)if((c=p.__k[d])!=null&&c.__e!=null){p.__e=p.__c.base=c.__e;break}return l(p)}}(i)),xt.length>t&&xt.sort(vi));Dr.__r=0}function On(e,t,r,i,a,n,o,s,l,p,d){var c,f,h,A,_,S=i&&i.__k||Pn,H=t.length;for(r.__d=l,function(T,g,u){var m,w,E,U,K,C=g.length,x=u.length,z=x,G=0;for(T.__k=[],m=0;m<C;m++)(w=g[m])!=null&&typeof w!="boolean"&&typeof w!="function"?(U=m+G,(w=T.__k[m]=typeof w=="string"||typeof w=="number"||typeof w=="bigint"||w.constructor==String?Wr(null,w,null,null,null):Si(w)?Wr(Xe,{children:w},null,null,null):w.constructor===void 0&&w.__b>0?Wr(w.type,w.props,w.key,w.ref?w.ref:null,w.__v):w).__=T,w.__b=T.__b+1,E=null,(K=w.__i=function(I,W,D,le){var X=I.key,pe=I.type,L=D-1,Te=D+1,he=W[D];if(he===null||he&&X==he.key&&pe===he.type&&(131072&he.__u)==0)return D;if(le>+(he!=null&&(131072&he.__u)==0))for(;L>=0||Te<W.length;){if(L>=0){if((he=W[L])&&(131072&he.__u)==0&&X==he.key&&pe===he.type)return L;L--}if(Te<W.length){if((he=W[Te])&&(131072&he.__u)==0&&X==he.key&&pe===he.type)return Te;Te++}}return-1}(w,u,U,z))!==-1&&(z--,(E=u[K])&&(E.__u|=131072)),E==null||E.__v===null?(K==-1&&G--,typeof w.type!="function"&&(w.__u|=65536)):K!==U&&(K==U-1?G--:K==U+1?G++:(K>U?G--:G++,w.__u|=65536))):w=T.__k[m]=null;if(z)for(m=0;m<x;m++)(E=u[m])!=null&&(131072&E.__u)==0&&(E.__e==T.__d&&(T.__d=Bt(E)),function I(W,D,le){var X,pe;if(Y.unmount&&Y.unmount(W),(X=W.ref)&&(X.current&&X.current!==W.__e||xi(X,null,D)),(X=W.__c)!=null){if(X.componentWillUnmount)try{X.componentWillUnmount()}catch(L){Y.__e(L,D)}X.base=X.__P=null}if(X=W.__k)for(pe=0;pe<X.length;pe++)X[pe]&&I(X[pe],D,le||typeof W.type!="function");le||Rn(W.__e),W.__c=W.__=W.__e=W.__d=void 0}(E,E))}(r,t,S),l=r.__d,c=0;c<H;c++)(h=r.__k[c])!=null&&(f=h.__i===-1?ur:S[h.__i]||ur,h.__i=c,Ei(e,h,f,a,n,o,s,l,p,d),A=h.__e,h.ref&&f.ref!=h.ref&&(f.ref&&xi(f.ref,null,h),d.push(h.ref,h.__c||A,h)),_==null&&A!=null&&(_=A),65536&h.__u||f.__k===h.__k?l=function T(g,u,m){var w,E;if(typeof g.type=="function"){for(w=g.__k,E=0;w&&E<w.length;E++)w[E]&&(w[E].__=g,u=T(w[E],u,m));return u}g.__e!=u&&(u&&g.type&&!m.contains(u)&&(u=Bt(g)),m.insertBefore(g.__e,u||null),u=g.__e);do u=u&&u.nextSibling;while(u!=null&&u.nodeType===8);return u}(h,l,e):typeof h.type=="function"&&h.__d!==void 0?l=h.__d:A&&(l=A.nextSibling),h.__d=void 0,h.__u&=-196609);r.__d=l,r.__e=_}function Hn(e,t,r){t[0]==="-"?e.setProperty(t,r??""):e[t]=r==null?"":typeof r!="number"||Ko.test(t)?r:r+"px"}function jr(e,t,r,i,a){var n;e:if(t==="style")if(typeof r=="string")e.style.cssText=r;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(t in i)r&&t in r||Hn(e.style,t,"");if(r)for(t in r)i&&r[t]===i[t]||Hn(e.style,t,r[t])}else if(t[0]==="o"&&t[1]==="n")n=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e||t==="onFocusOut"||t==="onFocusIn"?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+n]=r,r?i?r.u=i.u:(r.u=_i,e.addEventListener(t,n?Ai:ki,n)):e.removeEventListener(t,n?Ai:ki,n);else{if(a=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&t[4]!=="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&r==1?"":r))}}function Wn(e){return function(t){if(this.l){var r=this.l[t.type+e];if(t.t==null)t.t=_i++;else if(t.t<r.u)return;return r(Y.event?Y.event(t):t)}}}function Ei(e,t,r,i,a,n,o,s,l,p){var d,c,f,h,A,_,S,H,T,g,u,m,w,E,U,K,C=t.type;if(t.constructor!==void 0)return null;128&r.__u&&(l=!!(32&r.__u),n=[s=t.__e=r.__e]),(d=Y.__b)&&d(t);e:if(typeof C=="function")try{if(H=t.props,T="prototype"in C&&C.prototype.render,g=(d=C.contextType)&&i[d.__c],u=d?g?g.props.value:d.__:i,r.__c?S=(c=t.__c=r.__c).__=c.__E:(T?t.__c=c=new C(H,u):(t.__c=c=new Kr(H,u),c.constructor=C,c.render=Do),g&&g.sub(c),c.props=H,c.state||(c.state={}),c.context=u,c.__n=i,f=c.__d=!0,c.__h=[],c._sb=[]),T&&c.__s==null&&(c.__s=c.state),T&&C.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=gt({},c.__s)),gt(c.__s,C.getDerivedStateFromProps(H,c.__s))),h=c.props,A=c.state,c.__v=t,f)T&&C.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),T&&c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(T&&C.getDerivedStateFromProps==null&&H!==h&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(H,u),!c.__e&&(c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(H,c.__s,u)===!1||t.__v===r.__v)){for(t.__v!==r.__v&&(c.props=H,c.state=c.__s,c.__d=!1),t.__e=r.__e,t.__k=r.__k,t.__k.some(function(x){x&&(x.__=t)}),m=0;m<c._sb.length;m++)c.__h.push(c._sb[m]);c._sb=[],c.__h.length&&o.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(H,c.__s,u),T&&c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(h,A,_)})}if(c.context=u,c.props=H,c.__P=e,c.__e=!1,w=Y.__r,E=0,T){for(c.state=c.__s,c.__d=!1,w&&w(t),d=c.render(c.props,c.state,c.context),U=0;U<c._sb.length;U++)c.__h.push(c._sb[U]);c._sb=[]}else do c.__d=!1,w&&w(t),d=c.render(c.props,c.state,c.context),c.state=c.__s;while(c.__d&&++E<25);c.state=c.__s,c.getChildContext!=null&&(i=gt(gt({},i),c.getChildContext())),T&&!f&&c.getSnapshotBeforeUpdate!=null&&(_=c.getSnapshotBeforeUpdate(h,A)),On(e,Si(K=d!=null&&d.type===Xe&&d.key==null?d.props.children:d)?K:[K],t,r,i,a,n,o,s,l,p),c.base=t.__e,t.__u&=-161,c.__h.length&&o.push(c),S&&(c.__E=c.__=null)}catch(x){if(t.__v=null,l||n!=null){for(t.__u|=l?160:128;s&&s.nodeType===8&&s.nextSibling;)s=s.nextSibling;n[n.indexOf(s)]=null,t.__e=s}else t.__e=r.__e,t.__k=r.__k;Y.__e(x,t,r)}else n==null&&t.__v===r.__v?(t.__k=r.__k,t.__e=r.__e):t.__e=function(x,z,G,I,W,D,le,X,pe){var L,Te,he,Zt,ye,Qe,Ke,Ae=G.props,me=z.props,Q=z.type;if(Q==="svg"?W="http://www.w3.org/2000/svg":Q==="math"?W="http://www.w3.org/1998/Math/MathML":W||(W="http://www.w3.org/1999/xhtml"),D!=null){for(L=0;L<D.length;L++)if((ye=D[L])&&"setAttribute"in ye==!!Q&&(Q?ye.localName===Q:ye.nodeType===3)){x=ye,D[L]=null;break}}if(x==null){if(Q===null)return document.createTextNode(me);x=document.createElementNS(W,Q,me.is&&me),X&&(Y.__m&&Y.__m(z,D),X=!1),D=null}if(Q===null)Ae===me||X&&x.data===me||(x.data=me);else{if(D=D&&Hr.call(x.childNodes),Ae=G.props||ur,!X&&D!=null)for(Ae={},L=0;L<x.attributes.length;L++)Ae[(ye=x.attributes[L]).name]=ye.value;for(L in Ae)if(ye=Ae[L],L!="children"){if(L=="dangerouslySetInnerHTML")he=ye;else if(!(L in me)){if(L=="value"&&"defaultValue"in me||L=="checked"&&"defaultChecked"in me)continue;jr(x,L,null,ye,W)}}for(L in me)ye=me[L],L=="children"?Zt=ye:L=="dangerouslySetInnerHTML"?Te=ye:L=="value"?Qe=ye:L=="checked"?Ke=ye:X&&typeof ye!="function"||Ae[L]===ye||jr(x,L,ye,Ae[L],W);if(Te)X||he&&(Te.__html===he.__html||Te.__html===x.innerHTML)||(x.innerHTML=Te.__html),z.__k=[];else if(he&&(x.innerHTML=""),On(x,Si(Zt)?Zt:[Zt],z,G,I,Q==="foreignObject"?"http://www.w3.org/1999/xhtml":W,D,le,D?D[0]:G.__k&&Bt(G,0),X,pe),D!=null)for(L=D.length;L--;)Rn(D[L]);X||(L="value",Q==="progress"&&Qe==null?x.removeAttribute("value"):Qe===void 0||Qe===x[L]&&(Q!=="progress"||Qe)&&(Q!=="option"||Qe===Ae[L])||jr(x,L,Qe,Ae[L],W),L="checked",Ke!==void 0&&Ke!==x[L]&&jr(x,L,Ke,Ae[L],W))}return x}(r.__e,t,r,i,a,n,o,l,p);(d=Y.diffed)&&d(t)}function Kn(e,t,r){t.__d=void 0;for(var i=0;i<r.length;i++)xi(r[i],r[++i],r[++i]);Y.__c&&Y.__c(t,e),e.some(function(a){try{e=a.__h,a.__h=[],e.some(function(n){n.call(a)})}catch(n){Y.__e(n,a.__v)}})}function xi(e,t,r){try{if(typeof e=="function"){var i=typeof e.__u=="function";i&&e.__u(),i&&t==null||(e.__u=e(t))}else e.current=t}catch(a){Y.__e(a,r)}}function Do(e,t,r){return this.constructor(e,r)}function bt(e,t){var r,i,a,n,o;r=e,Y.__&&Y.__(r,t),a=(i=typeof bt=="function")?null:bt&&bt.__k||t.__k,n=[],o=[],Ei(t,r=(!i&&bt||t).__k=$n(Xe,null,[r]),a||ur,ur,t.namespaceURI,!i&&bt?[bt]:a?null:t.firstChild?Hr.call(t.childNodes):null,n,!i&&bt?bt:a?a.__e:t.firstChild,i,o),Kn(n,r,o)}Hr=Pn.slice,Y={__e:function(e,t,r,i){for(var a,n,o;t=t.__;)if((a=t.__c)&&!a.__)try{if((n=a.constructor)&&n.getDerivedStateFromError!=null&&(a.setState(n.getDerivedStateFromError(e)),o=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(e,i||{}),o=a.__d),o)return a.__E=a}catch(s){e=s}throw e}},Tn=0,Kr.prototype.setState=function(e,t){var r;r=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=gt({},this.state),typeof e=="function"&&(e=e(gt({},r),this.props)),e&&gt(r,e),e!=null&&this.__v&&(t&&this._sb.push(t),In(this))},Kr.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),In(this))},Kr.prototype.render=Xe,xt=[],Cn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,vi=function(e,t){return e.__v.__b-t.__v.__b},Dr.__r=0,_i=0,ki=Wn(!1),Ai=Wn(!0);var Dn=/[\s\n\\/='"\0<>]/,jn=/^(xlink|xmlns|xml)([A-Z])/,jo=/^accessK|^auto[A-Z]|^cell|^ch|^col|cont|cross|dateT|encT|form[A-Z]|frame|hrefL|inputM|maxL|minL|noV|playsI|popoverT|readO|rowS|src[A-Z]|tabI|useM|item[A-Z]/,No=/^ac|^ali|arabic|basel|cap|clipPath$|clipRule$|color|dominant|enable|fill|flood|font|glyph[^R]|horiz|image|letter|lighting|marker[^WUH]|overline|panose|pointe|paint|rendering|shape|stop|strikethrough|stroke|text[^L]|transform|underline|unicode|units|^v[^i]|^w|^xH/,Lo=new Set(["draggable","spellcheck"]),Jo=/["&<]/;function Nr(e){if(e.length===0||Jo.test(e)===!1)return e;for(var t=0,r=0,i="",a="";r<e.length;r++){switch(e.charCodeAt(r)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;default:continue}r!==t&&(i+=e.slice(t,r)),i+=a,t=r+1}return r!==t&&(i+=e.slice(t,r)),i}var Nn={},Mo=new Set(["animation-iteration-count","border-image-outset","border-image-slice","border-image-width","box-flex","box-flex-group","box-ordinal-group","column-count","fill-opacity","flex","flex-grow","flex-negative","flex-order","flex-positive","flex-shrink","flood-opacity","font-weight","grid-column","grid-row","line-clamp","line-height","opacity","order","orphans","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","widows","z-index","zoom"]),Bo=/[A-Z]/g;function Ln(){this.__d=!0}var fc=null,Ti,Tt,dr,pr,Ui={},Jn=[],hr=Array.isArray,Ci=Object.assign;function Mn(e,t){var r,i=e.type,a=!0;return e.__c?(a=!1,(r=e.__c).state=r.__s):r=new i(e.props,t),e.__c=r,r.__v=e,r.props=e.props,r.context=t,r.__d=!0,r.state==null&&(r.state=Ui),r.__s==null&&(r.__s=r.state),i.getDerivedStateFromProps?r.state=Ci({},r.state,i.getDerivedStateFromProps(r.props,r.state)):a&&r.componentWillMount?(r.componentWillMount(),r.state=r.__s!==r.state?r.__s:r.state):!a&&r.componentWillUpdate&&r.componentWillUpdate(),dr&&dr(e),r.render(r.props,r.state,t)}var zo=new Set(["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),mc=/["&<]/,qo=0;function $(e,t,r,i,a,n){t||(t={});var o,s,l=t;"ref"in t&&(o=t.ref,delete t.ref);var p={type:e,props:l,key:r,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--qo,__i:-1,__u:0,__source:a,__self:n};if(typeof e=="function"&&(o=e.defaultProps))for(s in o)l[s]===void 0&&(l[s]=o[s]);return Y.vnode&&Y.vnode(p),p}async function Vo(e,t){let r=window.SimpleWebAuthnBrowser;async function i(d){let c=new URL(`${e}/webauthn-options/${t}`);d&&c.searchParams.append("action",d),n().forEach(h=>{c.searchParams.append(h.name,h.value)});let f=await fetch(c);return f.ok?f.json():void console.error("Failed to fetch options",f)}function a(){let d=`#${t}-form`,c=document.querySelector(d);if(!c)throw Error(`Form '${d}' not found`);return c}function n(){return Array.from(a().querySelectorAll("input[data-form-field]"))}async function o(d,c){let f=a();if(d){let h=document.createElement("input");h.type="hidden",h.name="action",h.value=d,f.appendChild(h)}if(c){let h=document.createElement("input");h.type="hidden",h.name="data",h.value=JSON.stringify(c),f.appendChild(h)}return f.submit()}async function s(d,c){let f=await r.startAuthentication(d,c);return await o("authenticate",f)}async function l(d){n().forEach(f=>{if(f.required&&!f.value)throw Error(`Missing required field: ${f.name}`)});let c=await r.startRegistration(d);return await o("register",c)}async function p(){if(!r.browserSupportsWebAuthnAutofill())return;let d=await i("authenticate");if(!d)return void console.error("Failed to fetch option for autofill authentication");try{await s(d.options,!0)}catch(c){console.error(c)}}(async function(){let d=a();if(!r.browserSupportsWebAuthn()){d.style.display="none";return}d&&d.addEventListener("submit",async c=>{c.preventDefault();let f=await i(void 0);if(!f)return void console.error("Failed to fetch options for form submission");if(f.action==="authenticate")try{await s(f.options,!1)}catch(h){console.error(h)}else if(f.action==="register")try{await l(f.options)}catch(h){console.error(h)}})})(),p()}let Bn={default:"Unable to sign in.",Signin:"Try signing in with a different account.",OAuthSignin:"Try signing in with a different account.",OAuthCallbackError:"Try signing in with a different account.",OAuthCreateAccount:"Try signing in with a different account.",EmailCreateAccount:"Try signing in with a different account.",Callback:"Try signing in with a different account.",OAuthAccountNotLinked:"To confirm your identity, sign in with the same account you used originally.",EmailSignin:"The e-mail could not be sent.",CredentialsSignin:"Sign in failed. Check the details you provided are correct.",SessionRequired:"Please sign in to access this page."},Fo=`:root {
  --border-width: 1px;
  --border-radius: 0.5rem;
  --color-error: #c94b4b;
  --color-info: #157efb;
  --color-info-hover: #0f6ddb;
  --color-info-text: #fff;
}

.__next-auth-theme-auto,
.__next-auth-theme-light {
  --color-background: #ececec;
  --color-background-hover: rgba(236, 236, 236, 0.8);
  --color-background-card: #fff;
  --color-text: #000;
  --color-primary: #444;
  --color-control-border: #bbb;
  --color-button-active-background: #f9f9f9;
  --color-button-active-border: #aaa;
  --color-separator: #ccc;
  --provider-bg: #fff;
  --provider-bg-hover: color-mix(
    in srgb,
    var(--provider-brand-color) 30%,
    #fff
  );
}

.__next-auth-theme-dark {
  --color-background: #161b22;
  --color-background-hover: rgba(22, 27, 34, 0.8);
  --color-background-card: #0d1117;
  --color-text: #fff;
  --color-primary: #ccc;
  --color-control-border: #555;
  --color-button-active-background: #060606;
  --color-button-active-border: #666;
  --color-separator: #444;
  --provider-bg: #161b22;
  --provider-bg-hover: color-mix(
    in srgb,
    var(--provider-brand-color) 30%,
    #000
  );
}

.__next-auth-theme-dark img[src$="42-school.svg"],
  .__next-auth-theme-dark img[src$="apple.svg"],
  .__next-auth-theme-dark img[src$="boxyhq-saml.svg"],
  .__next-auth-theme-dark img[src$="eveonline.svg"],
  .__next-auth-theme-dark img[src$="github.svg"],
  .__next-auth-theme-dark img[src$="mailchimp.svg"],
  .__next-auth-theme-dark img[src$="medium.svg"],
  .__next-auth-theme-dark img[src$="okta.svg"],
  .__next-auth-theme-dark img[src$="patreon.svg"],
  .__next-auth-theme-dark img[src$="ping-id.svg"],
  .__next-auth-theme-dark img[src$="roblox.svg"],
  .__next-auth-theme-dark img[src$="threads.svg"],
  .__next-auth-theme-dark img[src$="wikimedia.svg"] {
    filter: invert(1);
  }

.__next-auth-theme-dark #submitButton {
    background-color: var(--provider-bg, var(--color-info));
  }

@media (prefers-color-scheme: dark) {
  .__next-auth-theme-auto {
    --color-background: #161b22;
    --color-background-hover: rgba(22, 27, 34, 0.8);
    --color-background-card: #0d1117;
    --color-text: #fff;
    --color-primary: #ccc;
    --color-control-border: #555;
    --color-button-active-background: #060606;
    --color-button-active-border: #666;
    --color-separator: #444;
    --provider-bg: #161b22;
    --provider-bg-hover: color-mix(
      in srgb,
      var(--provider-brand-color) 30%,
      #000
    );
  }
    .__next-auth-theme-auto img[src$="42-school.svg"],
    .__next-auth-theme-auto img[src$="apple.svg"],
    .__next-auth-theme-auto img[src$="boxyhq-saml.svg"],
    .__next-auth-theme-auto img[src$="eveonline.svg"],
    .__next-auth-theme-auto img[src$="github.svg"],
    .__next-auth-theme-auto img[src$="mailchimp.svg"],
    .__next-auth-theme-auto img[src$="medium.svg"],
    .__next-auth-theme-auto img[src$="okta.svg"],
    .__next-auth-theme-auto img[src$="patreon.svg"],
    .__next-auth-theme-auto img[src$="ping-id.svg"],
    .__next-auth-theme-auto img[src$="roblox.svg"],
    .__next-auth-theme-auto img[src$="threads.svg"],
    .__next-auth-theme-auto img[src$="wikimedia.svg"] {
      filter: invert(1);
    }
    .__next-auth-theme-auto #submitButton {
      background-color: var(--provider-bg, var(--color-info));
    }
}

html {
  box-sizing: border-box;
}

*,
*:before,
*:after {
  box-sizing: inherit;
  margin: 0;
  padding: 0;
}

body {
  background-color: var(--color-background);
  margin: 0;
  padding: 0;
  font-family:
    ui-sans-serif,
    system-ui,
    -apple-system,
    BlinkMacSystemFont,
    "Segoe UI",
    Roboto,
    "Helvetica Neue",
    Arial,
    "Noto Sans",
    sans-serif,
    "Apple Color Emoji",
    "Segoe UI Emoji",
    "Segoe UI Symbol",
    "Noto Color Emoji";
}

h1 {
  margin-bottom: 1.5rem;
  padding: 0 1rem;
  font-weight: 400;
  color: var(--color-text);
}

p {
  margin-bottom: 1.5rem;
  padding: 0 1rem;
  color: var(--color-text);
}

form {
  margin: 0;
  padding: 0;
}

label {
  font-weight: 500;
  text-align: left;
  margin-bottom: 0.25rem;
  display: block;
  color: var(--color-text);
}

input[type] {
  box-sizing: border-box;
  display: block;
  width: 100%;
  padding: 0.5rem 1rem;
  border: var(--border-width) solid var(--color-control-border);
  background: var(--color-background-card);
  font-size: 1rem;
  border-radius: var(--border-radius);
  color: var(--color-text);
}

p {
  font-size: 1.1rem;
  line-height: 2rem;
}

a.button {
  text-decoration: none;
  line-height: 1rem;
}

a.button:link,
  a.button:visited {
    background-color: var(--color-background);
    color: var(--color-primary);
  }

button,
a.button {
  padding: 0.75rem 1rem;
  color: var(--provider-color, var(--color-primary));
  background-color: var(--provider-bg, var(--color-background));
  border: 1px solid #00000031;
  font-size: 0.9rem;
  height: 50px;
  border-radius: var(--border-radius);
  transition: background-color 250ms ease-in-out;
  font-weight: 300;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

:is(button,a.button):hover {
    background-color: var(--provider-bg-hover, var(--color-background-hover));
    cursor: pointer;
  }

:is(button,a.button):active {
    cursor: pointer;
  }

:is(button,a.button) span {
    color: var(--provider-bg);
  }

#submitButton {
  color: var(--button-text-color, var(--color-info-text));
  background-color: var(--brand-color, var(--color-info));
  width: 100%;
}

#submitButton:hover {
    background-color: var(
      --button-hover-bg,
      var(--color-info-hover)
    ) !important;
  }

a.site {
  color: var(--color-primary);
  text-decoration: none;
  font-size: 1rem;
  line-height: 2rem;
}

a.site:hover {
    text-decoration: underline;
  }

.page {
  position: absolute;
  width: 100%;
  height: 100%;
  display: grid;
  place-items: center;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

.page > div {
    text-align: center;
  }

.error a.button {
    padding-left: 2rem;
    padding-right: 2rem;
    margin-top: 0.5rem;
  }

.error .message {
    margin-bottom: 1.5rem;
  }

.signin input[type="text"] {
    margin-left: auto;
    margin-right: auto;
    display: block;
  }

.signin hr {
    display: block;
    border: 0;
    border-top: 1px solid var(--color-separator);
    margin: 2rem auto 1rem auto;
    overflow: visible;
  }

.signin hr::before {
      content: "or";
      background: var(--color-background-card);
      color: #888;
      padding: 0 0.4rem;
      position: relative;
      top: -0.7rem;
    }

.signin .error {
    background: #f5f5f5;
    font-weight: 500;
    border-radius: 0.3rem;
    background: var(--color-error);
  }

.signin .error p {
      text-align: left;
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
      line-height: 1.2rem;
      color: var(--color-info-text);
    }

.signin > div,
  .signin form {
    display: block;
  }

.signin > div input[type], .signin form input[type] {
      margin-bottom: 0.5rem;
    }

.signin > div button, .signin form button {
      width: 100%;
    }

.signin .provider + .provider {
    margin-top: 1rem;
  }

.logo {
  display: inline-block;
  max-width: 150px;
  margin: 1.25rem 0;
  max-height: 70px;
}

.card {
  background-color: var(--color-background-card);
  border-radius: 1rem;
  padding: 1.25rem 2rem;
}

.card .header {
    color: var(--color-primary);
  }

.card input[type]::-moz-placeholder {
    color: color-mix(
      in srgb,
      var(--color-text) 20%,
      var(--color-button-active-background)
    );
  }

.card input[type]::placeholder {
    color: color-mix(
      in srgb,
      var(--color-text) 20%,
      var(--color-button-active-background)
    );
  }

.card input[type] {
    background: color-mix(in srgb, var(--color-background-card) 95%, black);
  }

.section-header {
  color: var(--color-text);
}

@media screen and (min-width: 450px) {
  .card {
    margin: 2rem 0;
    width: 368px;
  }
}

@media screen and (max-width: 450px) {
  .card {
    margin: 1rem 0;
    width: 343px;
  }
}
`;function Lr({html:e,title:t,status:r,cookies:i,theme:a,headTags:n}){return{cookies:i,status:r,headers:{"Content-Type":"text/html"},body:`<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>${Fo}</style><title>${t}</title>${n??""}</head><body class="__next-auth-theme-${a?.colorScheme??"auto"}"><div class="page">${function(o,s,l){var p=Y.__s;Y.__s=!0,Ti=Y.__b,Tt=Y.diffed,dr=Y.__r,pr=Y.unmount;var d=$n(Xe,null);d.__k=[o];try{var c=function f(h,A,_,S,H,T,g){if(h==null||h===!0||h===!1||h==="")return"";var u=typeof h;if(u!="object")return u=="function"?"":u=="string"?Nr(h):h+"";if(hr(h)){var m,w="";H.__k=h;for(var E=0;E<h.length;E++){var U=h[E];if(U!=null&&typeof U!="boolean"){var K,C=f(U,A,_,S,H,T,g);typeof C=="string"?w+=C:(m||(m=[]),w&&m.push(w),w="",hr(C)?(K=m).push.apply(K,C):m.push(C))}}return m?(w&&m.push(w),m):w}if(h.constructor!==void 0)return"";h.__=H,Ti&&Ti(h);var x=h.type,z=h.props;if(typeof x=="function"){var G,I,W,D=A;if(x===Xe){if("tpl"in z){for(var le="",X=0;X<z.tpl.length;X++)if(le+=z.tpl[X],z.exprs&&X<z.exprs.length){var pe=z.exprs[X];if(pe==null)continue;typeof pe=="object"&&(pe.constructor===void 0||hr(pe))?le+=f(pe,A,_,S,h,T,g):le+=pe}return le}if("UNSTABLE_comment"in z)return"<!--"+Nr(z.UNSTABLE_comment)+"-->";I=z.children}else{if((G=x.contextType)!=null){var L=A[G.__c];D=L?L.props.value:G.__}var Te=x.prototype&&typeof x.prototype.render=="function";if(Te)I=Mn(h,D),W=h.__c;else{h.__c=W={__v:h,context:D,props:h.props,setState:Ln,forceUpdate:Ln,__d:!0,__h:[]};for(var he=0;W.__d&&he++<25;)W.__d=!1,dr&&dr(h),I=x.call(W,z,D);W.__d=!0}if(W.getChildContext!=null&&(A=Ci({},A,W.getChildContext())),Te&&Y.errorBoundaries&&(x.getDerivedStateFromError||W.componentDidCatch)){I=I!=null&&I.type===Xe&&I.key==null&&I.props.tpl==null?I.props.children:I;try{return f(I,A,_,S,h,T,g)}catch(Je){return x.getDerivedStateFromError&&(W.__s=x.getDerivedStateFromError(Je)),W.componentDidCatch&&W.componentDidCatch(Je,Ui),W.__d?(I=Mn(h,A),(W=h.__c).getChildContext!=null&&(A=Ci({},A,W.getChildContext())),f(I=I!=null&&I.type===Xe&&I.key==null&&I.props.tpl==null?I.props.children:I,A,_,S,h,T,g)):""}finally{Tt&&Tt(h),h.__=null,pr&&pr(h)}}}I=I!=null&&I.type===Xe&&I.key==null&&I.props.tpl==null?I.props.children:I;try{var Zt=f(I,A,_,S,h,T,g);return Tt&&Tt(h),h.__=null,Y.unmount&&Y.unmount(h),Zt}catch(Je){if(!T&&g&&g.onError){var ye=g.onError(Je,h,function($t){return f($t,A,_,S,h,T,g)});if(ye!==void 0)return ye;var Qe=Y.__e;return Qe&&Qe(Je,h),""}if(!T||!Je||typeof Je.then!="function")throw Je;return Je.then(function $t(){try{return f(I,A,_,S,h,T,g)}catch(Fe){if(!Fe||typeof Fe.then!="function")throw Fe;return Fe.then(function(){return f(I,A,_,S,h,T,g)},$t)}})}}var Ke,Ae="<"+x,me="";for(var Q in z){var Se=z[Q];if(typeof Se!="function"||Q==="class"||Q==="className"){switch(Q){case"children":Ke=Se;continue;case"key":case"ref":case"__self":case"__source":continue;case"htmlFor":if("for"in z)continue;Q="for";break;case"className":if("class"in z)continue;Q="class";break;case"defaultChecked":Q="checked";break;case"defaultSelected":Q="selected";break;case"defaultValue":case"value":switch(Q="value",x){case"textarea":Ke=Se;continue;case"select":S=Se;continue;case"option":S!=Se||"selected"in z||(Ae+=" selected")}break;case"dangerouslySetInnerHTML":me=Se&&Se.__html;continue;case"style":typeof Se=="object"&&(Se=function(Je){var $t="";for(var Fe in Je){var ai=Je[Fe];if(ai!=null&&ai!==""){var qi=Fe[0]=="-"?Fe:Nn[Fe]||(Nn[Fe]=Fe.replace(Bo,"-$&").toLowerCase()),Ha=";";typeof ai!="number"||qi.startsWith("--")||Mo.has(qi)||(Ha="px;"),$t=$t+qi+":"+ai+Ha}}return $t||void 0}(Se));break;case"acceptCharset":Q="accept-charset";break;case"httpEquiv":Q="http-equiv";break;default:if(jn.test(Q))Q=Q.replace(jn,"$1:$2").toLowerCase();else{if(Dn.test(Q))continue;(Q[4]==="-"||Lo.has(Q))&&Se!=null?Se+="":_?No.test(Q)&&(Q=Q==="panose1"?"panose-1":Q.replace(/([A-Z])/g,"-$1").toLowerCase()):jo.test(Q)&&(Q=Q.toLowerCase())}}Se!=null&&Se!==!1&&(Ae=Se===!0||Se===""?Ae+" "+Q:Ae+" "+Q+'="'+(typeof Se=="string"?Nr(Se):Se+"")+'"')}}if(Dn.test(x))throw Error(x+" is not a valid HTML tag name in "+Ae+">");if(me||(typeof Ke=="string"?me=Nr(Ke):Ke!=null&&Ke!==!1&&Ke!==!0&&(me=f(Ke,A,x==="svg"||x!=="foreignObject"&&_,S,h,T,g))),Tt&&Tt(h),h.__=null,pr&&pr(h),!me&&zo.has(x))return Ae+"/>";var Bi="</"+x+">",zi=Ae+">";return hr(me)?[zi].concat(me,[Bi]):typeof me!="string"?[zi,me,Bi]:zi+me+Bi}(o,Ui,!1,void 0,d,!1,void 0);return hr(c)?c.join(""):c}catch(f){throw f.then?Error('Use "renderToStringAsync" for suspenseful rendering.'):f}finally{Y.__c&&Y.__c(o,Jn),Y.__s=p,Jn.length=0}}(e)}</div></body></html>`}}function zn(e){let{url:t,theme:r,query:i,cookies:a,pages:n,providers:o}=e;return{csrf:(s,l,p)=>s?(l.logger.warn("csrf-disabled"),p.push({name:l.cookies.csrfToken.name,value:"",options:{...l.cookies.csrfToken.options,maxAge:0}}),{status:404,cookies:p}):{headers:{"Content-Type":"application/json","Cache-Control":"private, no-cache, no-store",Expires:"0",Pragma:"no-cache"},body:{csrfToken:l.csrfToken},cookies:p},providers:s=>({headers:{"Content-Type":"application/json"},body:s.reduce((l,{id:p,name:d,type:c,signinUrl:f,callbackUrl:h})=>(l[p]={id:p,name:d,type:c,signinUrl:f,callbackUrl:h},l),{})}),signin(s,l){if(s)throw new qe("Unsupported action");if(n?.signIn){let c=`${n.signIn}${n.signIn.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:e.callbackUrl??"/"})}`;return l&&(c=`${c}&${new URLSearchParams({error:l})}`),{redirect:c,cookies:a}}let p=o?.find(c=>c.type==="webauthn"&&c.enableConditionalUI&&!!c.simpleWebAuthnBrowserVersion),d="";if(p){let{simpleWebAuthnBrowserVersion:c}=p;d=`<script src="https://unpkg.com/@simplewebauthn/browser@${c}/dist/bundle/index.umd.min.js" crossorigin="anonymous"><\/script>`}return Lr({cookies:a,theme:r,html:function(c){let{csrfToken:f,providers:h=[],callbackUrl:A,theme:_,email:S,error:H}=c;typeof document<"u"&&_?.brandColor&&document.documentElement.style.setProperty("--brand-color",_.brandColor),typeof document<"u"&&_?.buttonText&&document.documentElement.style.setProperty("--button-text-color",_.buttonText);let T=H&&(Bn[H]??Bn.default),g=h.find(u=>u.type==="webauthn"&&u.enableConditionalUI)?.id;return $("div",{className:"signin",children:[_?.brandColor&&$("style",{dangerouslySetInnerHTML:{__html:`:root {--brand-color: ${_.brandColor}}`}}),_?.buttonText&&$("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${_.buttonText}
        }
      `}}),$("div",{className:"card",children:[T&&$("div",{className:"error",children:$("p",{children:T})}),_?.logo&&$("img",{src:_.logo,alt:"Logo",className:"logo"}),h.map((u,m)=>{let w,E,U;(u.type==="oauth"||u.type==="oidc")&&({bg:w="#fff",brandColor:E,logo:U=`https://authjs.dev/img/providers/${u.id}.svg`}=u.style??{});let K=E??w??"#fff";return $("div",{className:"provider",children:[u.type==="oauth"||u.type==="oidc"?$("form",{action:u.signinUrl,method:"POST",children:[$("input",{type:"hidden",name:"csrfToken",value:f}),A&&$("input",{type:"hidden",name:"callbackUrl",value:A}),$("button",{type:"submit",className:"button",style:{"--provider-brand-color":K},tabIndex:0,children:[$("span",{style:{filter:"invert(1) grayscale(1) brightness(1.3) contrast(9000)","mix-blend-mode":"luminosity",opacity:.95},children:["Sign in with ",u.name]}),U&&$("img",{loading:"lazy",height:24,src:U})]})]}):null,(u.type==="email"||u.type==="credentials"||u.type==="webauthn")&&m>0&&h[m-1].type!=="email"&&h[m-1].type!=="credentials"&&h[m-1].type!=="webauthn"&&$("hr",{}),u.type==="email"&&$("form",{action:u.signinUrl,method:"POST",children:[$("input",{type:"hidden",name:"csrfToken",value:f}),$("label",{className:"section-header",htmlFor:`input-email-for-${u.id}-provider`,children:"Email"}),$("input",{id:`input-email-for-${u.id}-provider`,autoFocus:!0,type:"email",name:"email",value:S,placeholder:"email@example.com",required:!0}),$("button",{id:"submitButton",type:"submit",tabIndex:0,children:["Sign in with ",u.name]})]}),u.type==="credentials"&&$("form",{action:u.callbackUrl,method:"POST",children:[$("input",{type:"hidden",name:"csrfToken",value:f}),Object.keys(u.credentials).map(C=>$("div",{children:[$("label",{className:"section-header",htmlFor:`input-${C}-for-${u.id}-provider`,children:u.credentials[C].label??C}),$("input",{name:C,id:`input-${C}-for-${u.id}-provider`,type:u.credentials[C].type??"text",placeholder:u.credentials[C].placeholder??"",...u.credentials[C]})]},`input-group-${u.id}`)),$("button",{id:"submitButton",type:"submit",tabIndex:0,children:["Sign in with ",u.name]})]}),u.type==="webauthn"&&$("form",{action:u.callbackUrl,method:"POST",id:`${u.id}-form`,children:[$("input",{type:"hidden",name:"csrfToken",value:f}),Object.keys(u.formFields).map(C=>$("div",{children:[$("label",{className:"section-header",htmlFor:`input-${C}-for-${u.id}-provider`,children:u.formFields[C].label??C}),$("input",{name:C,"data-form-field":!0,id:`input-${C}-for-${u.id}-provider`,type:u.formFields[C].type??"text",placeholder:u.formFields[C].placeholder??"",...u.formFields[C]})]},`input-group-${u.id}`)),$("button",{id:`submitButton-${u.id}`,type:"submit",tabIndex:0,children:["Sign in with ",u.name]})]}),(u.type==="email"||u.type==="credentials"||u.type==="webauthn")&&m+1<h.length&&$("hr",{})]},u.id)})]}),g&&$(Xe,{children:$("script",{dangerouslySetInnerHTML:{__html:`
const currentURL = window.location.href;
const authURL = currentURL.substring(0, currentURL.lastIndexOf('/'));
(${Vo})(authURL, "${g}");
`}})})]})}({csrfToken:e.csrfToken,providers:e.providers?.filter(c=>["email","oauth","oidc"].includes(c.type)||c.type==="credentials"&&c.credentials||c.type==="webauthn"&&c.formFields||!1),callbackUrl:e.callbackUrl,theme:e.theme,error:l,...i}),title:"Sign In",headTags:d})},signout:()=>n?.signOut?{redirect:n.signOut,cookies:a}:Lr({cookies:a,theme:r,html:function(s){let{url:l,csrfToken:p,theme:d}=s;return $("div",{className:"signout",children:[d?.brandColor&&$("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${d.brandColor}
        }
      `}}),d?.buttonText&&$("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${d.buttonText}
        }
      `}}),$("div",{className:"card",children:[d?.logo&&$("img",{src:d.logo,alt:"Logo",className:"logo"}),$("h1",{children:"Signout"}),$("p",{children:"Are you sure you want to sign out?"}),$("form",{action:l?.toString(),method:"POST",children:[$("input",{type:"hidden",name:"csrfToken",value:p}),$("button",{id:"submitButton",type:"submit",children:"Sign out"})]})]})]})}({csrfToken:e.csrfToken,url:t,theme:r}),title:"Sign Out"}),verifyRequest:s=>n?.verifyRequest?{redirect:`${n.verifyRequest}${t?.search??""}`,cookies:a}:Lr({cookies:a,theme:r,html:function(l){let{url:p,theme:d}=l;return $("div",{className:"verify-request",children:[d.brandColor&&$("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${d.brandColor}
        }
      `}}),$("div",{className:"card",children:[d.logo&&$("img",{src:d.logo,alt:"Logo",className:"logo"}),$("h1",{children:"Check your email"}),$("p",{children:"A sign in link has been sent to your email address."}),$("p",{children:$("a",{className:"site",href:p.origin,children:p.host})})]})]})}({url:t,theme:r,...s}),title:"Verify Request"}),error:s=>n?.error?{redirect:`${n.error}${n.error.includes("?")?"&":"?"}error=${s}`,cookies:a}:Lr({cookies:a,theme:r,...function(l){let{url:p,error:d="default",theme:c}=l,f=`${p}/signin`,h={default:{status:200,heading:"Error",message:$("p",{children:$("a",{className:"site",href:p?.origin,children:p?.host})})},Configuration:{status:500,heading:"Server error",message:$("div",{children:[$("p",{children:"There is a problem with the server configuration."}),$("p",{children:"Check the server logs for more information."})]})},AccessDenied:{status:403,heading:"Access Denied",message:$("div",{children:[$("p",{children:"You do not have permission to sign in."}),$("p",{children:$("a",{className:"button",href:f,children:"Sign in"})})]})},Verification:{status:403,heading:"Unable to sign in",message:$("div",{children:[$("p",{children:"The sign in link is no longer valid."}),$("p",{children:"It may have been used already or it may have expired."})]}),signin:$("a",{className:"button",href:f,children:"Sign in"})}},{status:A,heading:_,message:S,signin:H}=h[d]??h.default;return{status:A,html:$("div",{className:"error",children:[c?.brandColor&&$("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${c?.brandColor}
        }
      `}}),$("div",{className:"card",children:[c?.logo&&$("img",{src:c?.logo,alt:"Logo",className:"logo"}),$("h1",{children:_}),$("div",{className:"message",children:S}),H]})]})}}({url:t,theme:r,error:s}),title:"Error"})}}function Ut(e,t=Date.now()){return new Date(t+1e3*e)}async function Pi(e,t,r,i){if(!r?.providerAccountId||!r.type)throw Error("Missing or invalid provider account");if(!["email","oauth","oidc","webauthn"].includes(r.type))throw Error("Provider not supported");let{adapter:a,jwt:n,events:o,session:{strategy:s,generateSessionToken:l}}=i;if(!a)return{user:t,account:r};let p=r,{createUser:d,updateUser:c,getUser:f,getUserByAccount:h,getUserByEmail:A,linkAccount:_,createSession:S,getSessionAndUser:H,deleteSession:T}=a,g=null,u=null,m=!1,w=s==="jwt";if(e)if(w)try{let U=i.cookies.sessionToken.name;(g=await n.decode({...n,token:e,salt:U}))&&"sub"in g&&g.sub&&(u=await f(g.sub))}catch{}else{let U=await H(e);U&&(g=U.session,u=U.user)}if(p.type==="email"){let U=await A(t.email);return U?(u?.id!==U.id&&!w&&e&&await T(e),u=await c({id:U.id,emailVerified:new Date}),await o.updateUser?.({user:u})):(u=await d({...t,emailVerified:new Date}),await o.createUser?.({user:u}),m=!0),{session:g=w?{}:await S({sessionToken:l(),userId:u.id,expires:Ut(i.session.maxAge)}),user:u,isNewUser:m}}if(p.type==="webauthn"){let U=await h({providerAccountId:p.providerAccountId,provider:p.provider});if(U){if(u){if(U.id===u.id){let C={...p,userId:u.id};return{session:g,user:u,isNewUser:m,account:C}}throw new Dt("The account is already associated with another user",{provider:p.provider})}g=w?{}:await S({sessionToken:l(),userId:U.id,expires:Ut(i.session.maxAge)});let K={...p,userId:U.id};return{session:g,user:U,isNewUser:m,account:K}}{if(u){await _({...p,userId:u.id}),await o.linkAccount?.({user:u,account:p,profile:t});let C={...p,userId:u.id};return{session:g,user:u,isNewUser:m,account:C}}if(t.email&&await A(t.email))throw new Dt("Another account already exists with the same e-mail address",{provider:p.provider});u=await d({...t}),await o.createUser?.({user:u}),await _({...p,userId:u.id}),await o.linkAccount?.({user:u,account:p,profile:t}),g=w?{}:await S({sessionToken:l(),userId:u.id,expires:Ut(i.session.maxAge)});let K={...p,userId:u.id};return{session:g,user:u,isNewUser:!0,account:K}}}let E=await h({providerAccountId:p.providerAccountId,provider:p.provider});if(E){if(u){if(E.id===u.id)return{session:g,user:u,isNewUser:m};throw new ot("The account is already associated with another user",{provider:p.provider})}return{session:g=w?{}:await S({sessionToken:l(),userId:E.id,expires:Ut(i.session.maxAge)}),user:E,isNewUser:m}}{let{provider:U}=i,{type:K,provider:C,providerAccountId:x,userId:z,...G}=p;if(p=Object.assign(U.account(G)??{},{providerAccountId:x,provider:C,type:K,userId:z}),u)return await _({...p,userId:u.id}),await o.linkAccount?.({user:u,account:p,profile:t}),{session:g,user:u,isNewUser:m};let I=t.email?await A(t.email):null;if(I)if(i.provider?.allowDangerousEmailAccountLinking)u=I,m=!1;else throw new ot("Another account already exists with the same e-mail address",{provider:p.provider});else u=await d({...t,emailVerified:null}),m=!0;return await o.createUser?.({user:u}),await _({...p,userId:u.id}),await o.linkAccount?.({user:u,account:p,profile:t}),{session:g=w?{}:await S({sessionToken:l(),userId:u.id,expires:Ut(i.session.maxAge)}),user:u,isNewUser:m}}}function zt(e,t){if(e==null)return!1;try{return e instanceof t||Object.getPrototypeOf(e)[Symbol.toStringTag]===t.prototype[Symbol.toStringTag]}catch{return!1}}typeof navigator<"u"&&navigator.userAgent?.startsWith?.("Mozilla/5.0 ")||(be="oauth4webapi/v3.5.5");let Re="ERR_INVALID_ARG_VALUE",Oe="ERR_INVALID_ARG_TYPE";function se(e,t,r){let i=TypeError(e,{cause:r});return Object.assign(i,{code:t}),i}let Ze=Symbol(),qn=Symbol(),Go=Symbol(),Ye=Symbol(),Vn=Symbol(),Jr=Symbol(),qt=Symbol(),Xo=new TextEncoder,Zo=new TextDecoder;function Le(e){return typeof e=="string"?Xo.encode(e):Zo.decode(e)}function Ve(e){return typeof e=="string"?He(e):Ce(e)}Ce=Uint8Array.prototype.toBase64?e=>(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e.toBase64({alphabet:"base64url",omitPadding:!0})):e=>{e instanceof ArrayBuffer&&(e=new Uint8Array(e));let t=[];for(let r=0;r<e.byteLength;r+=32768)t.push(String.fromCharCode.apply(null,e.subarray(r,r+32768)));return btoa(t.join("")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},He=Uint8Array.fromBase64?e=>{try{return Uint8Array.fromBase64(e,{alphabet:"base64url"})}catch(t){throw se("The input to be decoded is not correctly encoded.",Re,t)}}:e=>{try{let t=atob(e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"")),r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}catch(t){throw se("The input to be decoded is not correctly encoded.",Re,t)}};class $e extends Error{code;constructor(t,r){super(t,r),this.name=this.constructor.name,this.code=Rs,Error.captureStackTrace?.(this,this.constructor)}}class Yo extends Error{code;constructor(t,r){super(t,r),this.name=this.constructor.name,r?.code&&(this.code=r?.code),Error.captureStackTrace?.(this,this.constructor)}}function j(e,t,r){return new Yo(e,{code:t,cause:r})}function Qo(e,t){if(!(e instanceof CryptoKey))throw se(`${t} must be a CryptoKey`,Oe)}function es(e,t){if(Qo(e,t),e.type!=="private")throw se(`${t} must be a private CryptoKey`,Re)}function Ct(e){return!(e===null||typeof e!="object"||Array.isArray(e))}function fr(e){zt(e,Headers)&&(e=Object.fromEntries(e.entries()));let t=new Headers(e??{});if(be&&!t.has("user-agent")&&t.set("user-agent",be),t.has("authorization"))throw se('"options.headers" must not include the "authorization" header name',Re);return t}function Mr(e){if(typeof e=="function"&&(e=e()),!(e instanceof AbortSignal))throw se('"options.signal" must return or be an instance of AbortSignal',Oe);return e}function Fn(e){return e.includes("//")?e.replace("//","/"):e}async function ts(e,t,r,i){if(!(e instanceof URL))throw se(`"${t}" must be an instance of URL`,Oe);Ii(e,i?.[Ze]!==!0);let a=r(new URL(e.href)),n=fr(i?.headers);return n.set("accept","application/json"),(i?.[Ye]||fetch)(a.href,{body:void 0,headers:Object.fromEntries(n.entries()),method:"GET",redirect:"manual",signal:i?.signal?Mr(i.signal):void 0})}async function Ri(e,t){return ts(e,"issuerIdentifier",r=>{switch(t?.algorithm){case void 0:case"oidc":r.pathname=Fn(`${r.pathname}/.well-known/openid-configuration`);break;case"oauth2":(function(i,a,n=!1){i.pathname==="/"?i.pathname=a:i.pathname=Fn(`${a}/${n?i.pathname:i.pathname.replace(/(\/)$/,"")}`)})(r,".well-known/oauth-authorization-server");break;default:throw se('"options.algorithm" must be "oidc" (default), or "oauth2"',Re)}return r},t)}function mr(e,t,r,i,a){try{if(typeof e!="number"||!Number.isFinite(e))throw se(`${r} must be a number`,Oe,a);if(e>0)return;if(t){if(e!==0)throw se(`${r} must be a non-negative number`,Re,a);return}throw se(`${r} must be a positive number`,Re,a)}catch(n){throw i?j(n.message,i,a):n}}function ke(e,t,r,i){try{if(typeof e!="string")throw se(`${t} must be a string`,Oe,i);if(e.length===0)throw se(`${t} must not be empty`,Re,i)}catch(a){throw r?j(a.message,r,i):a}}async function $i(e,t){if(!(e instanceof URL)&&e!==ga)throw se('"expectedIssuerIdentifier" must be an instance of URL',Oe);if(!zt(t,Response))throw se('"response" must be an instance of Response',Oe);if(t.status!==200)throw j('"response" is not a conform Authorization Server Metadata response (unexpected HTTP status code)',Fr,t);wr(t);let r=await Xr(t);if(ke(r.issuer,'"response" body "issuer" property',re,{body:r}),e!==ga&&new URL(r.issuer).href!==e.href)throw j('"response" body "issuer" property does not match the expected value',da,{expected:e.href,body:r,attribute:"issuer"});return r}function Gn(e){var t=e,r="application/json";if(Vr(t)!==r)throw Xn(t,r)}function Xn(e,...t){let r='"response" content-type must be ';if(t.length>2){let i=t.pop();r+=`${t.join(", ")}, or ${i}`}else t.length===2?r+=`${t[0]} or ${t[1]}`:r+=t[0];return j(r,Os,e)}function Br(){return Ve(crypto.getRandomValues(new Uint8Array(32)))}async function rs(e){return ke(e,"codeVerifier"),Ve(await crypto.subtle.digest("SHA-256",Le(e)))}function is(e){switch(e.algorithm.name){case"RSA-PSS":switch(e.algorithm.hash.name){case"SHA-256":return"PS256";case"SHA-384":return"PS384";case"SHA-512":return"PS512";default:throw new $e("unsupported RsaHashedKeyAlgorithm hash name",{cause:e})}case"RSASSA-PKCS1-v1_5":switch(e.algorithm.hash.name){case"SHA-256":return"RS256";case"SHA-384":return"RS384";case"SHA-512":return"RS512";default:throw new $e("unsupported RsaHashedKeyAlgorithm hash name",{cause:e})}case"ECDSA":switch(e.algorithm.namedCurve){case"P-256":return"ES256";case"P-384":return"ES384";case"P-521":return"ES512";default:throw new $e("unsupported EcKeyAlgorithm namedCurve",{cause:e})}case"Ed25519":case"EdDSA":return"Ed25519";default:throw new $e("unsupported CryptoKey algorithm name",{cause:e})}}function Vt(e){let t=e?.[qn];return typeof t=="number"&&Number.isFinite(t)?t:0}function zr(e){let t=e?.[Go];return typeof t=="number"&&Number.isFinite(t)&&Math.sign(t)!==-1?t:30}function Pt(){return Math.floor(Date.now()/1e3)}function Ft(e){if(typeof e!="object"||e===null)throw se('"as" must be an object',Oe);ke(e.issuer,'"as.issuer"')}function yr(e){if(typeof e!="object"||e===null)throw se('"client" must be an object',Oe);ke(e.client_id,'"client.client_id"')}function Zn(e,t){let r=Pt()+Vt(t);return{jti:Br(),aud:e.issuer,exp:r+60,iat:r,nbf:r,iss:t.client_id,sub:t.client_id}}async function ns(e,t,r){if(!r.usages.includes("sign"))throw se('CryptoKey instances used for signing assertions must include "sign" in their "usages"',Re);let i=`${Ve(Le(JSON.stringify(e)))}.${Ve(Le(JSON.stringify(t)))}`,a=Ve(await crypto.subtle.sign(fa(r),r,Le(i)));return`${i}.${a}`}async function as(e){let{kty:t,e:r,n:i,x:a,y:n,crv:o}=await crypto.subtle.exportKey("jwk",e),s={kty:t,e:r,n:i,x:a,y:n,crv:o};return ne.set(e,s),s}async function yc(e){return(ne||=new WeakMap).get(e)||as(e)}let os=URL.parse?(e,t)=>URL.parse(e,t):(e,t)=>{try{return new URL(e,t)}catch{return null}};function Ii(e,t){if(t&&e.protocol!=="https:")throw j("only requests to HTTPS are allowed",Hs,e);if(e.protocol!=="https:"&&e.protocol!=="http:")throw j("only HTTP and HTTPS requests are allowed",Ws,e)}function Yn(e,t,r,i){let a;if(typeof e!="string"||!(a=os(e)))throw j(`authorization server metadata does not contain a valid ${r?`"as.mtls_endpoint_aliases.${t}"`:`"as.${t}"`}`,e===void 0?Ks:Ds,{attribute:r?`mtls_endpoint_aliases.${t}`:t});return Ii(a,i),a}function Oi(e,t,r,i){return r&&e.mtls_endpoint_aliases&&t in e.mtls_endpoint_aliases?Yn(e.mtls_endpoint_aliases[t],t,r,i):Yn(e[t],t,r,i)}class ss extends Error{cause;code;error;status;error_description;response;constructor(t,r){super(t,r),this.name=this.constructor.name,this.code=Ps,this.cause=r.cause,this.error=r.cause.error,this.status=r.response.status,this.error_description=r.cause.error_description,Object.defineProperty(this,"response",{enumerable:!1,value:r.response}),Error.captureStackTrace?.(this,this.constructor)}}class Qn extends Error{cause;code;error;error_description;constructor(t,r){super(t,r),this.name=this.constructor.name,this.code=$s,this.cause=r.cause,this.error=r.cause.get("error"),this.error_description=r.cause.get("error_description")??void 0,Error.captureStackTrace?.(this,this.constructor)}}class cs extends Error{cause;code;response;status;constructor(t,r){super(t,r),this.name=this.constructor.name,this.code=Cs,this.cause=r.cause,this.status=r.response.status,this.response=r.response,Object.defineProperty(this,"response",{enumerable:!1}),Error.captureStackTrace?.(this,this.constructor)}}let qr="[a-zA-Z0-9!#$%&\\'\\*\\+\\-\\.\\^_`\\|~]+",ls=RegExp("^[,\\s]*("+qr+")\\s(.*)"),us=RegExp("^[,\\s]*("+qr+')\\s*=\\s*"((?:[^"\\\\]|\\\\.)*)"[,\\s]*(.*)'),ds=RegExp("^[,\\s]*"+("("+qr+")\\s*=\\s*(")+qr+")[,\\s]*(.*)"),ps=RegExp("^([a-zA-Z0-9\\-\\._\\~\\+\\/]+[=]{0,2})(?:$|[,\\s])(.*)");async function hs(e){if(e.status>399&&e.status<500){wr(e),Gn(e);try{let t=await e.clone().json();if(Ct(t)&&typeof t.error=="string"&&t.error.length)return t}catch{}}}async function fs(e,t,r){if(e.status!==t){let i;throw(i=await hs(e))?(await e.body?.cancel(),new ss("server responded with an error in the response body",{cause:i,response:e})):j(`"response" is not a conform ${r} response (unexpected HTTP status code)`,Fr,e)}}function ea(e){if(!Wi.has(e))throw se('"options.DPoP" is not a valid DPoPHandle',Re)}async function ms(e,t,r,i,a,n){if(ke(e,'"accessToken"'),!(r instanceof URL))throw se('"url" must be an instance of URL',Oe);Ii(r,n?.[Ze]!==!0),i=fr(i),n?.DPoP&&(ea(n.DPoP),await n.DPoP.addProof(r,i,t.toUpperCase(),e)),i.set("authorization",`${i.has("dpop")?"DPoP":"Bearer"} ${e}`);let o=await(n?.[Ye]||fetch)(r.href,{body:a,headers:Object.fromEntries(i.entries()),method:t,redirect:"manual",signal:n?.signal?Mr(n.signal):void 0});return n?.DPoP?.cacheNonce(o),o}async function ta(e,t,r,i){Ft(e),yr(t);let a=Oi(e,"userinfo_endpoint",t.use_mtls_endpoint_aliases,i?.[Ze]!==!0),n=fr(i?.headers);return t.userinfo_signed_response_alg?n.set("accept","application/jwt"):(n.set("accept","application/json"),n.append("accept","application/jwt")),ms(r,"GET",a,n,null,{...i,[qn]:Vt(t)})}function ra(e,t,r,i){(fe||=new WeakMap).set(e,{jwks:t,uat:r,get age(){return Pt()-this.uat}}),i&&Object.assign(i,{jwks:structuredClone(t),uat:r})}function ia(e,t){fe?.delete(e),delete t?.jwks,delete t?.uat}async function na(e,t,r){var i;let a,n,o,{alg:s,kid:l}=r;if(function(f){if(!Ls(f.alg))throw new $e('unsupported JWS "alg" identifier',{cause:{alg:f.alg}})}(r),!fe?.has(e)&&!(typeof(i=t?.[qt])!="object"||i===null||!("uat"in i)||typeof i.uat!="number"||Pt()-i.uat>=300)&&"jwks"in i&&Ct(i.jwks)&&Array.isArray(i.jwks.keys)&&Array.prototype.every.call(i.jwks.keys,Ct)&&ra(e,t?.[qt].jwks,t?.[qt].uat),fe?.has(e)){if({jwks:a,age:n}=fe.get(e),n>=300)return ia(e,t?.[qt]),na(e,t,r)}else a=await js(e,t).then(Ns),n=0,ra(e,a,Pt(),t?.[qt]);switch(s.slice(0,2)){case"RS":case"PS":o="RSA";break;case"ES":o="EC";break;case"Ed":o="OKP";break;default:throw new $e("unsupported JWS algorithm",{cause:{alg:s}})}let p=a.keys.filter(f=>{if(f.kty!==o||l!==void 0&&l!==f.kid||f.alg!==void 0&&s!==f.alg||f.use!==void 0&&f.use!=="sig"||f.key_ops?.includes("verify")===!1)return!1;switch(!0){case(s==="ES256"&&f.crv!=="P-256"):case(s==="ES384"&&f.crv!=="P-384"):case(s==="ES512"&&f.crv!=="P-521"):case(s==="Ed25519"&&f.crv!=="Ed25519"):case(s==="EdDSA"&&f.crv!=="Ed25519"):return!1}return!0}),{0:d,length:c}=p;if(!c){if(n>=60)return ia(e,t?.[qt]),na(e,t,r);throw j("error when selecting a JWT verification key, no applicable keys found",pa,{header:r,candidates:p,jwks_uri:new URL(e.jwks_uri)})}if(c!==1)throw j('error when selecting a JWT verification key, multiple applicable keys found, a "kid" JWT Header Parameter is required',pa,{header:r,candidates:p,jwks_uri:new URL(e.jwks_uri)});return qs(s,d)}let ys=Symbol();function Vr(e){return e.headers.get("content-type")?.split(";")[0]}async function ws(e,t,r,i,a){let n;if(Ft(e),yr(t),!zt(i,Response))throw se('"response" must be an instance of Response',Oe);if(ca(i),i.status!==200)throw j('"response" is not a conform UserInfo Endpoint response (unexpected HTTP status code)',Fr,i);if(wr(i),Vr(i)==="application/jwt"){let{claims:o,jwt:s}=await ma(await i.text(),ya.bind(void 0,t.userinfo_signed_response_alg,e.userinfo_signing_alg_values_supported,void 0),Vt(t),zr(t),a?.[Jr]).then(vs.bind(void 0,t.client_id)).then(_s.bind(void 0,e));oa.set(i,s),n=o}else{if(t.userinfo_signed_response_alg)throw j("JWT UserInfo Response expected",Is,i);n=await Xr(i)}if(ke(n.sub,'"response" body "sub" property',re,{body:n}),r!==ys){if(ke(r,'"expectedSubject"'),n.sub!==r)throw j('unexpected "response" body "sub" property value',da,{expected:r,body:n,attribute:"sub"})}return n}async function gs(e,t,r,i,a,n,o){return await r(e,t,a,n),n.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),(o?.[Ye]||fetch)(i.href,{body:a,headers:Object.fromEntries(n.entries()),method:"POST",redirect:"manual",signal:o?.signal?Mr(o.signal):void 0})}async function bs(e,t,r,i,a,n){let o=Oi(e,"token_endpoint",t.use_mtls_endpoint_aliases,n?.[Ze]!==!0);a.set("grant_type",i);let s=fr(n?.headers);s.set("accept","application/json"),n?.DPoP!==void 0&&(ea(n.DPoP),await n.DPoP.addProof(o,s,"POST"));let l=await gs(e,t,r,o,a,s,n);return n?.DPoP?.cacheNonce(l),l}let aa=new WeakMap,oa=new WeakMap;function Hi(e){if(!e.id_token)return;let t=aa.get(e);if(!t)throw se('"ref" was already garbage collected or did not resolve from the proper sources',Re);return t}async function sa(e,t,r,i,a){if(Ft(e),yr(t),!zt(r,Response))throw se('"response" must be an instance of Response',Oe);ca(r),await fs(r,200,"Token Endpoint"),wr(r);let n=await Xr(r);if(ke(n.access_token,'"response" body "access_token" property',re,{body:n}),ke(n.token_type,'"response" body "token_type" property',re,{body:n}),n.token_type=n.token_type.toLowerCase(),n.token_type!=="dpop"&&n.token_type!=="bearer")throw new $e("unsupported `token_type` value",{cause:{body:n}});if(n.expires_in!==void 0){let o=typeof n.expires_in!="number"?parseFloat(n.expires_in):n.expires_in;mr(o,!1,'"response" body "expires_in" property',re,{body:n}),n.expires_in=o}if(n.refresh_token!==void 0&&ke(n.refresh_token,'"response" body "refresh_token" property',re,{body:n}),n.scope!==void 0&&typeof n.scope!="string")throw j('"response" body "scope" property must be a string',re,{body:n});if(n.id_token!==void 0){ke(n.id_token,'"response" body "id_token" property',re,{body:n});let o=["aud","exp","iat","iss","sub"];t.require_auth_time===!0&&o.push("auth_time"),t.default_max_age!==void 0&&(mr(t.default_max_age,!1,'"client.default_max_age"'),o.push("auth_time")),i?.length&&o.push(...i);let{claims:s,jwt:l}=await ma(n.id_token,ya.bind(void 0,t.id_token_signed_response_alg,e.id_token_signing_alg_values_supported,"RS256"),Vt(t),zr(t),a?.[Jr]).then(Es.bind(void 0,o)).then(ua.bind(void 0,e)).then(la.bind(void 0,t.client_id));if(Array.isArray(s.aud)&&s.aud.length!==1){if(s.azp===void 0)throw j('ID Token "aud" (audience) claim includes additional untrusted audiences',vt,{claims:s,claim:"aud"});if(s.azp!==t.client_id)throw j('unexpected ID Token "azp" (authorized party) claim value',vt,{expected:t.client_id,claims:s,claim:"azp"})}s.auth_time!==void 0&&mr(s.auth_time,!1,'ID Token "auth_time" (authentication time)',re,{claims:s}),oa.set(r,l),aa.set(n,s)}return n}function ca(e){let t;if(t=function(r){if(!zt(r,Response))throw se('"response" must be an instance of Response',Oe);let i=r.headers.get("www-authenticate");if(i===null)return;let a=[],n=i;for(;n;){let o,s=n.match(ls),l=s?.[1].toLowerCase();if(n=s?.["2"],!l)return;let p={};for(;n;){let c,f;if(s=n.match(us)){if([,c,f,n]=s,f.includes("\\"))try{f=JSON.parse(`"${f}"`)}catch{}p[c.toLowerCase()]=f;continue}if(s=n.match(ds)){[,c,f,n]=s,p[c.toLowerCase()]=f;continue}if(s=n.match(ps)){if(Object.keys(p).length)break;[,o,n]=s;break}return}let d={scheme:l,parameters:p};o&&(d.token68=o),a.push(d)}if(a.length)return a}(e))throw new cs("server responded with a challenge in the WWW-Authenticate HTTP Header",{cause:t,response:e})}function vs(e,t){return t.claims.aud!==void 0?la(e,t):t}function la(e,t){if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(e))throw j('unexpected JWT "aud" (audience) claim value',vt,{expected:e,claims:t.claims,claim:"aud"})}else if(t.claims.aud!==e)throw j('unexpected JWT "aud" (audience) claim value',vt,{expected:e,claims:t.claims,claim:"aud"});return t}function _s(e,t){return t.claims.iss!==void 0?ua(e,t):t}function ua(e,t){let r=e[Vs]?.(t)??e.issuer;if(t.claims.iss!==r)throw j('unexpected JWT "iss" (issuer) claim value',vt,{expected:r,claims:t.claims,claim:"iss"});return t}let Wi=new WeakSet,ks=Symbol();async function As(e,t,r,i,a,n,o){if(Ft(e),yr(t),!Wi.has(i))throw se('"callbackParameters" must be an instance of URLSearchParams obtained from "validateAuthResponse()", or "validateJwtAuthResponse()',Re);ke(a,'"redirectUri"');let s=Rt(i,"code");if(!s)throw j('no authorization code in "callbackParameters"',re);let l=new URLSearchParams(o?.additionalParameters);return l.set("redirect_uri",a),l.set("code",s),n!==ks&&(ke(n,'"codeVerifier"'),l.set("code_verifier",n)),bs(e,t,r,"authorization_code",l,o)}let Ss={aud:"audience",c_hash:"code hash",client_id:"client id",exp:"expiration time",iat:"issued at",iss:"issuer",jti:"jwt id",nonce:"nonce",s_hash:"state hash",sub:"subject",ath:"access token hash",htm:"http method",htu:"http uri",cnf:"confirmation",auth_time:"authentication time"};function Es(e,t){for(let r of e)if(t.claims[r]===void 0)throw j(`JWT "${r}" (${Ss[r]}) claim missing`,re,{claims:t.claims});return t}let Ki=Symbol(),Di=Symbol();async function xs(e,t,r,i){return typeof i?.expectedNonce=="string"||typeof i?.maxAge=="number"||i?.requireIdToken?Ts(e,t,r,i.expectedNonce,i.maxAge,{[Jr]:i[Jr]}):Us(e,t,r,i)}async function Ts(e,t,r,i,a,n){let o=[];switch(i){case void 0:i=Ki;break;case Ki:break;default:ke(i,'"expectedNonce" argument'),o.push("nonce")}switch(a??=t.default_max_age){case void 0:a=Di;break;case Di:break;default:mr(a,!1,'"maxAge" argument'),o.push("auth_time")}let s=await sa(e,t,r,o,n);ke(s.id_token,'"response" body "id_token" property',re,{body:s});let l=Hi(s);if(a!==Di){let p=Pt()+Vt(t),d=zr(t);if(l.auth_time+a<p-d)throw j("too much time has elapsed since the last End-User authentication",Gr,{claims:l,now:p,tolerance:d,claim:"auth_time"})}if(i===Ki){if(l.nonce!==void 0)throw j('unexpected ID Token "nonce" claim value',vt,{expected:void 0,claims:l,claim:"nonce"})}else if(l.nonce!==i)throw j('unexpected ID Token "nonce" claim value',vt,{expected:i,claims:l,claim:"nonce"});return s}async function Us(e,t,r,i){let a=await sa(e,t,r,void 0,i),n=Hi(a);if(n){if(t.default_max_age!==void 0){mr(t.default_max_age,!1,'"client.default_max_age"');let o=Pt()+Vt(t),s=zr(t);if(n.auth_time+t.default_max_age<o-s)throw j("too much time has elapsed since the last End-User authentication",Gr,{claims:n,now:o,tolerance:s,claim:"auth_time"})}if(n.nonce!==void 0)throw j('unexpected ID Token "nonce" claim value',vt,{expected:void 0,claims:n,claim:"nonce"})}return a}let Cs="OAUTH_WWW_AUTHENTICATE_CHALLENGE",Ps="OAUTH_RESPONSE_BODY_ERROR",Rs="OAUTH_UNSUPPORTED_OPERATION",$s="OAUTH_AUTHORIZATION_RESPONSE_ERROR",Is="OAUTH_JWT_USERINFO_EXPECTED",ji="OAUTH_PARSE_ERROR",re="OAUTH_INVALID_RESPONSE",wc="OAUTH_INVALID_REQUEST",Os="OAUTH_RESPONSE_IS_NOT_JSON",Fr="OAUTH_RESPONSE_IS_NOT_CONFORM",Hs="OAUTH_HTTP_REQUEST_FORBIDDEN",Ws="OAUTH_REQUEST_PROTOCOL_FORBIDDEN",Gr="OAUTH_JWT_TIMESTAMP_CHECK_FAILED",vt="OAUTH_JWT_CLAIM_COMPARISON_FAILED",da="OAUTH_JSON_ATTRIBUTE_COMPARISON_FAILED",pa="OAUTH_KEY_SELECTION_FAILED",Ks="OAUTH_MISSING_SERVER_METADATA",Ds="OAUTH_INVALID_SERVER_METADATA";function gc(e,t){if(typeof t.header.typ!="string"||t.header.typ.toLowerCase().replace(/^application\//,"")!==e)throw j('unexpected JWT "typ" header parameter value',re,{header:t.header});return t}function wr(e){if(e.bodyUsed)throw se('"response" body has been used already',Re)}async function js(e,t){Ft(e);let r=Oi(e,"jwks_uri",!1,t?.[Ze]!==!0),i=fr(t?.headers);return i.set("accept","application/json"),i.append("accept","application/jwk-set+json"),(t?.[Ye]||fetch)(r.href,{body:void 0,headers:Object.fromEntries(i.entries()),method:"GET",redirect:"manual",signal:t?.signal?Mr(t.signal):void 0})}async function Ns(e){if(!zt(e,Response))throw se('"response" must be an instance of Response',Oe);if(e.status!==200)throw j('"response" is not a conform JSON Web Key Set response (unexpected HTTP status code)',Fr,e);wr(e);let t=await Xr(e,r=>function(i,...a){if(!a.includes(Vr(i)))throw Xn(i,...a)}(r,"application/json","application/jwk-set+json"));if(!Array.isArray(t.keys))throw j('"response" body "keys" property must be an array',re,{body:t});if(!Array.prototype.every.call(t.keys,Ct))throw j('"response" body "keys" property members must be JWK formatted objects',re,{body:t});return t}function Ls(e){switch(e){case"PS256":case"ES256":case"RS256":case"PS384":case"ES384":case"RS384":case"PS512":case"ES512":case"RS512":case"Ed25519":case"EdDSA":return!0;default:return!1}}function ha(e){let{algorithm:t}=e;if(typeof t.modulusLength!="number"||t.modulusLength<2048)throw new $e(`unsupported ${t.name} modulusLength`,{cause:e})}function fa(e){switch(e.algorithm.name){case"ECDSA":return{name:e.algorithm.name,hash:function(t){let{algorithm:r}=t;switch(r.namedCurve){case"P-256":return"SHA-256";case"P-384":return"SHA-384";case"P-521":return"SHA-512";default:throw new $e("unsupported ECDSA namedCurve",{cause:t})}}(e)};case"RSA-PSS":switch(ha(e),e.algorithm.hash.name){case"SHA-256":case"SHA-384":case"SHA-512":return{name:e.algorithm.name,saltLength:parseInt(e.algorithm.hash.name.slice(-3),10)>>3};default:throw new $e("unsupported RSA-PSS hash name",{cause:e})}case"RSASSA-PKCS1-v1_5":return ha(e),e.algorithm.name;case"Ed25519":return e.algorithm.name}throw new $e("unsupported CryptoKey algorithm name",{cause:e})}async function bc(e,t,r,i){let a=Le(`${e}.${t}`),n=fa(r);if(!await crypto.subtle.verify(n,r,i,a))throw j("JWT signature verification failed",re,{key:r,data:a,signature:i,algorithm:n})}async function ma(e,t,r,i,a){let n,o,{0:s,1:l,length:p}=e.split(".");if(p===5)if(a!==void 0)e=await a(e),{0:s,1:l,length:p}=e.split(".");else throw new $e("JWE decryption is not configured",{cause:e});if(p!==3)throw j("Invalid JWT",re,e);try{n=JSON.parse(Le(Ve(s)))}catch(c){throw j("failed to parse JWT Header body as base64url encoded JSON",ji,c)}if(!Ct(n))throw j("JWT Header must be a top level object",re,e);if(t(n),n.crit!==void 0)throw new $e('no JWT "crit" header parameter extensions are supported',{cause:{header:n}});try{o=JSON.parse(Le(Ve(l)))}catch(c){throw j("failed to parse JWT Payload body as base64url encoded JSON",ji,c)}if(!Ct(o))throw j("JWT Payload must be a top level object",re,e);let d=Pt()+r;if(o.exp!==void 0){if(typeof o.exp!="number")throw j('unexpected JWT "exp" (expiration time) claim type',re,{claims:o});if(o.exp<=d-i)throw j('unexpected JWT "exp" (expiration time) claim value, expiration is past current timestamp',Gr,{claims:o,now:d,tolerance:i,claim:"exp"})}if(o.iat!==void 0&&typeof o.iat!="number")throw j('unexpected JWT "iat" (issued at) claim type',re,{claims:o});if(o.iss!==void 0&&typeof o.iss!="string")throw j('unexpected JWT "iss" (issuer) claim type',re,{claims:o});if(o.nbf!==void 0){if(typeof o.nbf!="number")throw j('unexpected JWT "nbf" (not before) claim type',re,{claims:o});if(o.nbf>d+i)throw j('unexpected JWT "nbf" (not before) claim value',Gr,{claims:o,now:d,tolerance:i,claim:"nbf"})}if(o.aud!==void 0&&typeof o.aud!="string"&&!Array.isArray(o.aud))throw j('unexpected JWT "aud" (audience) claim type',re,{claims:o});return{header:n,claims:o,jwt:e}}async function Js(e,t,r){let i;switch(t.alg){case"RS256":case"PS256":case"ES256":i="SHA-256";break;case"RS384":case"PS384":case"ES384":i="SHA-384";break;case"RS512":case"PS512":case"ES512":case"Ed25519":case"EdDSA":i="SHA-512";break;default:throw new $e(`unsupported JWS algorithm for ${r} calculation`,{cause:{alg:t.alg}})}let a=await crypto.subtle.digest(i,Le(e));return Ve(a.slice(0,a.byteLength/2))}async function vc(e,t,r,i){return t===await Js(e,r,i)}async function Ms(e){if(e.bodyUsed)throw se("form_post Request instances must contain a readable body",Re,{cause:e});return e.text()}async function _c(e){if(e.method!=="POST")throw se("form_post responses are expected to use the POST method",Re,{cause:e});if(Vr(e)!=="application/x-www-form-urlencoded")throw se("form_post responses are expected to use the application/x-www-form-urlencoded content-type",Re,{cause:e});return Ms(e)}function ya(e,t,r,i){if(e!==void 0){if(typeof e=="string"?i.alg!==e:!e.includes(i.alg))throw j('unexpected JWT "alg" header parameter',re,{header:i,expected:e,reason:"client configuration"});return}if(Array.isArray(t)){if(!t.includes(i.alg))throw j('unexpected JWT "alg" header parameter',re,{header:i,expected:t,reason:"authorization server metadata"});return}if(r!==void 0){if(typeof r=="string"?i.alg!==r:typeof r=="function"?!r(i.alg):!r.includes(i.alg))throw j('unexpected JWT "alg" header parameter',re,{header:i,expected:r,reason:"default value"});return}throw j('missing client or server configuration to verify used JWT "alg" header parameter',void 0,{client:e,issuer:t,fallback:r})}function Rt(e,t){let{0:r,length:i}=e.getAll(t);if(i>1)throw j(`"${t}" parameter must be provided only once`,re);return r}let wa=Symbol(),Bs=Symbol();function zs(e,t,r,i){var a;if(Ft(e),yr(t),r instanceof URL&&(r=r.searchParams),!(r instanceof URLSearchParams))throw se('"parameters" must be an instance of URLSearchParams, or URL',Oe);if(Rt(r,"response"))throw j('"parameters" contains a JARM response, use validateJwtAuthResponse() instead of validateAuthResponse()',re,{parameters:r});let n=Rt(r,"iss"),o=Rt(r,"state");if(!n&&e.authorization_response_iss_parameter_supported)throw j('response parameter "iss" (issuer) missing',re,{parameters:r});if(n&&n!==e.issuer)throw j('unexpected "iss" (issuer) response parameter value',re,{expected:e.issuer,parameters:r});switch(i){case void 0:case Bs:if(o!==void 0)throw j('unexpected "state" response parameter encountered',re,{expected:void 0,parameters:r});break;case wa:break;default:if(ke(i,'"expectedState" argument'),o!==i)throw j(o===void 0?'response parameter "state" missing':'unexpected "state" response parameter value',re,{expected:i,parameters:r})}if(Rt(r,"error"))throw new Qn("authorization response from the server is an error",{cause:r});let s=Rt(r,"id_token"),l=Rt(r,"token");if(s!==void 0||l!==void 0)throw new $e("implicit and hybrid flows are not supported");return a=new URLSearchParams(r),Wi.add(a),a}async function qs(e,t){let{ext:r,key_ops:i,use:a,...n}=t;return crypto.subtle.importKey("jwk",n,function(o){switch(o){case"PS256":case"PS384":case"PS512":return{name:"RSA-PSS",hash:`SHA-${o.slice(-3)}`};case"RS256":case"RS384":case"RS512":return{name:"RSASSA-PKCS1-v1_5",hash:`SHA-${o.slice(-3)}`};case"ES256":case"ES384":return{name:"ECDSA",namedCurve:`P-${o.slice(-3)}`};case"ES512":return{name:"ECDSA",namedCurve:"P-521"};case"Ed25519":case"EdDSA":return"Ed25519";default:throw new $e("unsupported JWS algorithm",{cause:{alg:o}})}}(e),!0,["verify"])}function kc(e){let t=new URL(e);return t.search="",t.hash="",t.href}async function Xr(e,t=Gn){let r;try{r=await e.json()}catch(i){throw t(e),j('failed to parse "response" body as JSON',ji,i)}if(!Ct(r))throw j('"response" body must be a top level object',re,{body:r});return r}let ga=Symbol(),Vs=Symbol();async function Zr(e,t,r){let{cookies:i,logger:a}=r,n=i[e],o=new Date;o.setTime(o.getTime()+9e5),a.debug(`CREATE_${e.toUpperCase()}`,{name:n.name,payload:t,COOKIE_TTL:900,expires:o});let s=await xr({...r.jwt,maxAge:900,token:{value:t},salt:n.name}),l={...n.options,expires:o};return{name:n.name,value:s,options:l}}async function ba(e,t,r){try{let{logger:i,cookies:a,jwt:n}=r;if(i.debug(`PARSE_${e.toUpperCase()}`,{cookie:t}),!t)throw new q(`${e} cookie was missing`);let o=await Tr({...n,token:t,salt:a[e].name});if(o?.value)return o.value;throw Error("Invalid cookie")}catch(i){throw new q(`${e} value could not be parsed`,{cause:i})}}function va(e,t,r){let{logger:i,cookies:a}=t,n=a[e];i.debug(`CLEAR_${e.toUpperCase()}`,{cookie:n}),r.push({name:n.name,value:"",options:{...a[e].options,maxAge:0}})}function Ni(e,t){return async function(r,i,a){let{provider:n,logger:o}=a;if(!n?.checks?.includes(e))return;let s=r?.[a.cookies[t].name];o.debug(`USE_${t.toUpperCase()}`,{value:s});let l=await ba(t,s,a);return va(t,a,i),l}}let _a={async create(e){let t=Br(),r=await rs(t);return{cookie:await Zr("pkceCodeVerifier",t,e),value:r}},use:Ni("pkce","pkceCodeVerifier")},ka="encodedState",Li={async create(e,t){let{provider:r}=e;if(!r.checks.includes("state")){if(t)throw new q("State data was provided but the provider is not configured to use state");return}let i={origin:t,random:Br()},a=await xr({secret:e.jwt.secret,token:i,salt:ka,maxAge:900});return{cookie:await Zr("state",a,e),value:a}},use:Ni("state","state"),async decode(e,t){try{t.logger.debug("DECODE_STATE",{state:e});let r=await Tr({secret:t.jwt.secret,token:e,salt:ka});if(r)return r;throw Error("Invalid state")}catch(r){throw new q("State could not be decoded",{cause:r})}}},Aa={async create(e){if(!e.provider.checks.includes("nonce"))return;let t=Br();return{cookie:await Zr("nonce",t,e),value:t}},use:Ni("nonce","nonce")},Sa="encodedWebauthnChallenge",Yr={create:async(e,t,r)=>({cookie:await Zr("webauthnChallenge",await xr({secret:e.jwt.secret,token:{challenge:t,registerData:r},salt:Sa,maxAge:900}),e)}),async use(e,t,r){let i=t?.[e.cookies.webauthnChallenge.name],a=await ba("webauthnChallenge",i,e),n=await Tr({secret:e.jwt.secret,token:a,salt:Sa});if(va("webauthnChallenge",e,r),!n)throw new q("WebAuthn challenge was missing");return n}};function Ea(e){return encodeURIComponent(e).replace(/%20/g,"+")}async function Fs(e,t,r){let i,a,n,{logger:o,provider:s}=r,{token:l,userinfo:p}=s;if(l?.url&&l.url.host!=="authjs.dev"||p?.url&&p.url.host!=="authjs.dev")i={issuer:s.issuer??"https://authjs.dev",token_endpoint:l?.url.toString(),userinfo_endpoint:p?.url.toString()};else{let u=new URL(s.issuer),m=await Ri(u,{[Ze]:!0,[Ye]:s[it]});if(!(i=await $i(u,m)).token_endpoint)throw TypeError("TODO: Authorization server did not provide a token endpoint.");if(!i.userinfo_endpoint)throw TypeError("TODO: Authorization server did not provide a userinfo endpoint.")}let d={client_id:s.clientId,...s.client};switch(d.token_endpoint_auth_method){case void 0:case"client_secret_basic":a=(u,m,w,E)=>{E.set("authorization",function(U,K){let C=Ea(U),x=Ea(K);return`Basic ${btoa(`${C}:${x}`)}`}(s.clientId,s.clientSecret))};break;case"client_secret_post":var c;ke(c=s.clientSecret,'"clientSecret"'),a=(u,m,w,E)=>{w.set("client_id",m.client_id),w.set("client_secret",c)};break;case"client_secret_jwt":a=function(u,m){let w;ke(u,'"clientSecret"');let E;return async(U,K,C,x)=>{w||=await crypto.subtle.importKey("raw",Le(u),{hash:"SHA-256",name:"HMAC"},!1,["sign"]);let z={alg:"HS256"},G=Zn(U,K);E?.(z,G);let I=`${Ve(Le(JSON.stringify(z)))}.${Ve(Le(JSON.stringify(G)))}`,W=await crypto.subtle.sign(w.algorithm,w,Le(I));C.set("client_id",K.client_id),C.set("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),C.set("client_assertion",`${I}.${Ve(new Uint8Array(W))}`)}}(s.clientSecret);break;case"private_key_jwt":a=function(u,m){var w;let{key:E,kid:U}=(w=u)instanceof CryptoKey?{key:w}:w?.key instanceof CryptoKey?(w.kid!==void 0&&ke(w.kid,'"kid"'),{key:w.key,kid:w.kid}):{};return es(E,'"clientPrivateKey.key"'),async(K,C,x,z)=>{let G={alg:is(E),kid:U},I=Zn(K,C);m?.[Vn]?.(G,I),x.set("client_id",C.client_id),x.set("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),x.set("client_assertion",await ns(G,I,E))}}(s.token.clientPrivateKey,{[Vn](u,m){m.aud=[i.issuer,i.token_endpoint]}});break;case"none":a=(u,m,w,E)=>{w.set("client_id",m.client_id)};break;default:throw Error("unsupported client authentication method")}let f=[],h=await Li.use(t,f,r);try{n=zs(i,d,new URLSearchParams(e),s.checks.includes("state")?h:wa)}catch(u){if(u instanceof Qn){let m={providerId:s.id,...Object.fromEntries(u.cause.entries())};throw o.debug("OAuthCallbackError",m),new It("OAuth Provider returned an error",m)}throw u}let A=await _a.use(t,f,r),_=s.callbackUrl;!r.isOnRedirectProxy&&s.redirectProxyUrl&&(_=s.redirectProxyUrl);let S=await As(i,d,a,n,_,A??"decoy",{[Ze]:!0,[Ye]:(...u)=>(s.checks.includes("pkce")||u[1].body.delete("code_verifier"),(s[it]??fetch)(...u))});s.token?.conform&&(S=await s.token.conform(S.clone())??S);let H={},T=s.type==="oidc";if(s[Sn])switch(s.id){case"microsoft-entra-id":case"azure-ad":{let u=await S.clone().json();if(u.error){let w={providerId:s.id,...u};throw new It(`OAuth Provider returned an error: ${u.error}`,w)}let{tid:m}=function(w){let E,U;if(typeof w!="string")throw new ht("JWTs must use Compact JWS serialization, JWT must be a string");let{1:K,length:C}=w.split(".");if(C===5)throw new ht("Only JWTs using Compact JWS serialization can be decoded");if(C!==3)throw new ht("Invalid JWT");if(!K)throw new ht("JWTs must contain a payload");try{E=ce(K)}catch{throw new ht("Failed to base64url decode the payload")}try{U=JSON.parse(oe.decode(E))}catch{throw new ht("Failed to parse the decoded payload as JSON")}if(!rt(U))throw new ht("Invalid JWT Claims Set");return U}(u.id_token);if(typeof m=="string"){let w=i.issuer?.match(/microsoftonline\.com\/(\w+)\/v2\.0/)?.[1]??"common",E=new URL(i.issuer.replace(w,m)),U=await Ri(E,{[Ye]:s[it]});i=await $i(E,U)}}}let g=await xs(i,d,S,{expectedNonce:await Aa.use(t,f,r),requireIdToken:T});if(T){let u=Hi(g);if(H=u,s[Sn]&&s.id==="apple")try{H.user=JSON.parse(e?.user)}catch{}if(s.idToken===!1){let m=await ta(i,d,g.access_token,{[Ye]:s[it],[Ze]:!0});H=await ws(i,d,u.sub,m)}}else if(p?.request){let u=await p.request({tokens:g,provider:s});u instanceof Object&&(H=u)}else if(p?.url)H=await(await ta(i,d,g.access_token,{[Ye]:s[it],[Ze]:!0})).json();else throw TypeError("No userinfo endpoint configured");return g.expires_in&&(g.expires_at=Math.floor(Date.now()/1e3)+Number(g.expires_in)),{...await Gs(H,s,g,o),profile:H,cookies:f}}async function Gs(e,t,r,i){try{let a=await t.profile(e,r);return{user:{...a,id:crypto.randomUUID(),email:a.email?.toLowerCase()},account:{...r,provider:t.id,type:t.type,providerAccountId:a.id??crypto.randomUUID()}}}catch(a){i.debug("getProfile error details",e),i.error(new et(a,{provider:t.id}))}}var xa=V(25356).Buffer;async function Xs(e,t,r,i){let a=await tc(e,t,r),{cookie:n}=await Yr.create(e,a.challenge,r);return{status:200,cookies:[...i??[],n],body:{action:"register",options:a},headers:{"Content-Type":"application/json"}}}async function Zs(e,t,r,i){let a=await ec(e,t,r),{cookie:n}=await Yr.create(e,a.challenge);return{status:200,cookies:[...i??[],n],body:{action:"authenticate",options:a},headers:{"Content-Type":"application/json"}}}async function Ys(e,t,r){let i,{adapter:a,provider:n}=e,o=t.body&&typeof t.body.data=="string"?JSON.parse(t.body.data):void 0;if(!o||typeof o!="object"||!("id"in o)||typeof o.id!="string")throw new B("Invalid WebAuthn Authentication response");let s=Qr(gr(o.id)),l=await a.getAuthenticator(s);if(!l)throw new B(`WebAuthn authenticator not found in database: ${JSON.stringify({credentialID:s})}`);let{challenge:p}=await Yr.use(e,t.cookies,r);try{var d;let _=n.getRelayingParty(e,t);i=await n.simpleWebAuthn.verifyAuthenticationResponse({...n.verifyAuthenticationOptions,expectedChallenge:p,response:o,authenticator:{...d=l,credentialDeviceType:d.credentialDeviceType,transports:Ji(d.transports),credentialID:gr(d.credentialID),credentialPublicKey:gr(d.credentialPublicKey)},expectedOrigin:_.origin,expectedRPID:_.id})}catch(_){throw new st(_)}let{verified:c,authenticationInfo:f}=i;if(!c)throw new st("WebAuthn authentication response could not be verified");try{let{newCounter:_}=f;await a.updateAuthenticatorCounter(l.credentialID,_)}catch(_){throw new k(`Failed to update authenticator counter. This may cause future authentication attempts to fail. ${JSON.stringify({credentialID:s,oldCounter:l.counter,newCounter:f.newCounter})}`,_)}let h=await a.getAccount(l.providerAccountId,n.id);if(!h)throw new B(`WebAuthn account not found in database: ${JSON.stringify({credentialID:s,providerAccountId:l.providerAccountId})}`);let A=await a.getUser(h.userId);if(!A)throw new B(`WebAuthn user not found in database: ${JSON.stringify({credentialID:s,providerAccountId:l.providerAccountId,userID:h.userId})}`);return{account:h,user:A}}async function Qs(e,t,r){var i;let a,{provider:n}=e,o=t.body&&typeof t.body.data=="string"?JSON.parse(t.body.data):void 0;if(!o||typeof o!="object"||!("id"in o)||typeof o.id!="string")throw new B("Invalid WebAuthn Registration response");let{challenge:s,registerData:l}=await Yr.use(e,t.cookies,r);if(!l)throw new B("Missing user registration data in WebAuthn challenge cookie");try{let c=n.getRelayingParty(e,t);a=await n.simpleWebAuthn.verifyRegistrationResponse({...n.verifyRegistrationOptions,expectedChallenge:s,response:o,expectedOrigin:c.origin,expectedRPID:c.id})}catch(c){throw new st(c)}if(!a.verified||!a.registrationInfo)throw new st("WebAuthn registration response could not be verified");let p={providerAccountId:Qr(a.registrationInfo.credentialID),provider:e.provider.id,type:n.type},d={providerAccountId:p.providerAccountId,counter:a.registrationInfo.counter,credentialID:Qr(a.registrationInfo.credentialID),credentialPublicKey:Qr(a.registrationInfo.credentialPublicKey),credentialBackedUp:a.registrationInfo.credentialBackedUp,credentialDeviceType:a.registrationInfo.credentialDeviceType,transports:(i=o.response.transports,i?.join(","))};return{user:l,account:p,authenticator:d}}async function ec(e,t,r){let{provider:i,adapter:a}=e,n=r&&r.id?await a.listAuthenticatorsByUserId(r.id):null,o=i.getRelayingParty(e,t);return await i.simpleWebAuthn.generateAuthenticationOptions({...i.authenticationOptions,rpID:o.id,allowCredentials:n?.map(s=>({id:gr(s.credentialID),type:"public-key",transports:Ji(s.transports)}))})}async function tc(e,t,r){let{provider:i,adapter:a}=e,n=r.id?await a.listAuthenticatorsByUserId(r.id):null,o=wi(32),s=i.getRelayingParty(e,t);return await i.simpleWebAuthn.generateRegistrationOptions({...i.registrationOptions,userID:o,userName:r.email,userDisplayName:r.name??void 0,rpID:s.id,rpName:s.name,excludeCredentials:n?.map(l=>({id:gr(l.credentialID),type:"public-key",transports:Ji(l.transports)}))})}function Ta(e){let{provider:t,adapter:r}=e;if(!r)throw new O("An adapter is required for the WebAuthn provider");if(!t||t.type!=="webauthn")throw new tt("Provider must be WebAuthn");return{...e,provider:t,adapter:r}}function gr(e){return new Uint8Array(xa.from(e,"base64"))}function Qr(e){return xa.from(e).toString("base64")}function Ji(e){return e?e.split(","):void 0}async function Ua(e,t,r,i){if(!t.provider)throw new tt("Callback route called without provider");let{query:a,body:n,method:o,headers:s}=e,{provider:l,adapter:p,url:d,callbackUrl:c,pages:f,jwt:h,events:A,callbacks:_,session:{strategy:S,maxAge:H},logger:T}=t,g=S==="jwt";try{if(l.type==="oauth"||l.type==="oidc"){let u,m=l.authorization?.url.searchParams.get("response_mode")==="form_post"?n:a;if(t.isOnRedirectProxy&&m?.state){let I=await Li.decode(m.state,t);if(I?.origin&&new URL(I.origin).origin!==t.url.origin){let W=`${I.origin}?${new URLSearchParams(m)}`;return T.debug("Proxy redirecting to",W),{redirect:W,cookies:i}}}let w=await Fs(m,e.cookies,t);w.cookies.length&&i.push(...w.cookies),T.debug("authorization result",w);let{user:E,account:U,profile:K}=w;if(!E||!U||!K)return{redirect:`${d}/signin`,cookies:i};if(p){let{getUserByAccount:I}=p;u=await I({providerAccountId:U.providerAccountId,provider:l.id})}let C=await ei({user:u??E,account:U,profile:K},t);if(C)return{redirect:C,cookies:i};let{user:x,session:z,isNewUser:G}=await Pi(r.value,E,U,t);if(g){let I={name:x.name,email:x.email,picture:x.image,sub:x.id?.toString()},W=await _.jwt({token:I,user:x,account:U,profile:K,isNewUser:G,trigger:G?"signUp":"signIn"});if(W===null)i.push(...r.clean());else{let D=t.cookies.sessionToken.name,le=await h.encode({...h,token:W,salt:D}),X=new Date;X.setTime(X.getTime()+1e3*H);let pe=r.chunk(le,{expires:X});i.push(...pe)}}else i.push({name:t.cookies.sessionToken.name,value:z.sessionToken,options:{...t.cookies.sessionToken.options,expires:z.expires}});return await A.signIn?.({user:x,account:U,profile:K,isNewUser:G}),G&&f.newUser?{redirect:`${f.newUser}${f.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:c})}`,cookies:i}:{redirect:c,cookies:i}}if(l.type==="email"){let u=a?.token,m=a?.email;if(!u){let le=TypeError("Missing token. The sign-in URL was manually opened without token or the link was not sent correctly in the email.",{cause:{hasToken:!!u}});throw le.name="Configuration",le}let w=l.secret??t.secret,E=await p.useVerificationToken({identifier:m,token:await Ur(`${u}${w}`)}),U=!!E,K=U&&E.expires.valueOf()<Date.now();if(!U||K||m&&E.identifier!==m)throw new er({hasInvite:U,expired:K});let{identifier:C}=E,x=await p.getUserByEmail(C)??{id:crypto.randomUUID(),email:C,emailVerified:null},z={providerAccountId:x.email,userId:x.id,type:"email",provider:l.id},G=await ei({user:x,account:z},t);if(G)return{redirect:G,cookies:i};let{user:I,session:W,isNewUser:D}=await Pi(r.value,x,z,t);if(g){let le={name:I.name,email:I.email,picture:I.image,sub:I.id?.toString()},X=await _.jwt({token:le,user:I,account:z,isNewUser:D,trigger:D?"signUp":"signIn"});if(X===null)i.push(...r.clean());else{let pe=t.cookies.sessionToken.name,L=await h.encode({...h,token:X,salt:pe}),Te=new Date;Te.setTime(Te.getTime()+1e3*H);let he=r.chunk(L,{expires:Te});i.push(...he)}}else i.push({name:t.cookies.sessionToken.name,value:W.sessionToken,options:{...t.cookies.sessionToken.options,expires:W.expires}});return await A.signIn?.({user:I,account:z,isNewUser:D}),D&&f.newUser?{redirect:`${f.newUser}${f.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:c})}`,cookies:i}:{redirect:c,cookies:i}}if(l.type==="credentials"&&o==="POST"){let u=n??{};Object.entries(a??{}).forEach(([C,x])=>d.searchParams.set(C,x));let m=await l.authorize(u,new Request(d,{headers:s,method:o,body:JSON.stringify(n)}));if(m)m.id=m.id?.toString()??crypto.randomUUID();else throw new De;let w={providerAccountId:m.id,type:"credentials",provider:l.id},E=await ei({user:m,account:w,credentials:u},t);if(E)return{redirect:E,cookies:i};let U={name:m.name,email:m.email,picture:m.image,sub:m.id},K=await _.jwt({token:U,user:m,account:w,isNewUser:!1,trigger:"signIn"});if(K===null)i.push(...r.clean());else{let C=t.cookies.sessionToken.name,x=await h.encode({...h,token:K,salt:C}),z=new Date;z.setTime(z.getTime()+1e3*H);let G=r.chunk(x,{expires:z});i.push(...G)}return await A.signIn?.({user:m,account:w}),{redirect:c,cookies:i}}else if(l.type==="webauthn"&&o==="POST"){let u,m,w,E=e.body?.action;if(typeof E!="string"||E!=="authenticate"&&E!=="register")throw new B("Invalid action parameter");let U=Ta(t);switch(E){case"authenticate":{let G=await Ys(U,e,i);u=G.user,m=G.account;break}case"register":{let G=await Qs(t,e,i);u=G.user,m=G.account,w=G.authenticator}}await ei({user:u,account:m},t);let{user:K,isNewUser:C,session:x,account:z}=await Pi(r.value,u,m,t);if(!z)throw new B("Error creating or finding account");if(w&&K.id&&await U.adapter.createAuthenticator({...w,userId:K.id}),g){let G={name:K.name,email:K.email,picture:K.image,sub:K.id?.toString()},I=await _.jwt({token:G,user:K,account:z,isNewUser:C,trigger:C?"signUp":"signIn"});if(I===null)i.push(...r.clean());else{let W=t.cookies.sessionToken.name,D=await h.encode({...h,token:I,salt:W}),le=new Date;le.setTime(le.getTime()+1e3*H);let X=r.chunk(D,{expires:le});i.push(...X)}}else i.push({name:t.cookies.sessionToken.name,value:x.sessionToken,options:{...t.cookies.sessionToken.options,expires:x.expires}});return await A.signIn?.({user:K,account:z,isNewUser:C}),C&&f.newUser?{redirect:`${f.newUser}${f.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:c})}`,cookies:i}:{redirect:c,cookies:i}}throw new tt(`Callback for provider type (${l.type}) is not supported`)}catch(u){if(u instanceof B)throw u;let m=new y(u,{provider:l.id});throw T.debug("callback route error details",{method:o,query:a,body:n}),m}}async function ei(e,t){let r,{signIn:i,redirect:a}=t.callbacks;try{r=await i(e)}catch(n){throw n instanceof B?n:new b(n)}if(!r)throw new b("AccessDenied");if(typeof r=="string")return await a({url:r,baseUrl:t.url.origin})}async function Ca(e,t,r,i,a){let{adapter:n,jwt:o,events:s,callbacks:l,logger:p,session:{strategy:d,maxAge:c}}=e,f={body:null,headers:{"Content-Type":"application/json",...!i&&{"Cache-Control":"private, no-cache, no-store",Expires:"0",Pragma:"no-cache"}},cookies:r},h=t.value;if(!h)return f;if(d==="jwt"){try{let A=e.cookies.sessionToken.name,_=await o.decode({...o,token:h,salt:A});if(!_)throw Error("Invalid JWT");let S=await l.jwt({token:_,...i&&{trigger:"update"},session:a}),H=Ut(c);if(S!==null){let T={user:{name:S.name,email:S.email,image:S.picture},expires:H.toISOString()},g=await l.session({session:T,token:S});f.body=g;let u=await o.encode({...o,token:S,salt:A}),m=t.chunk(u,{expires:H});f.cookies?.push(...m),await s.session?.({session:g,token:S})}else f.cookies?.push(...t.clean())}catch(A){p.error(new R(A)),f.cookies?.push(...t.clean())}return f}try{let{getSessionAndUser:A,deleteSession:_,updateSession:S}=n,H=await A(h);if(H&&H.session.expires.valueOf()<Date.now()&&(await _(h),H=null),H){let{user:T,session:g}=H,u=e.session.updateAge,m=g.expires.valueOf()-1e3*c+1e3*u,w=Ut(c);m<=Date.now()&&await S({sessionToken:h,expires:w});let E=await l.session({session:{...g,user:T},user:T,newSession:a,...i?{trigger:"update"}:{}});f.body=E,f.cookies?.push({name:e.cookies.sessionToken.name,value:h,options:{...e.cookies.sessionToken.options,expires:w}}),await s.session?.({session:E})}else h&&f.cookies?.push(...t.clean())}catch(A){p.error(new kt(A))}return f}async function rc(e,t){let r,i,{logger:a,provider:n}=t,o=n.authorization?.url;if(!o||o.host==="authjs.dev"){let h=new URL(n.issuer),A=await Ri(h,{[Ye]:n[it],[Ze]:!0}),_=await $i(h,A).catch(S=>{throw!(S instanceof TypeError)||S.message!=="Invalid URL"?S:TypeError(`Discovery request responded with an invalid issuer. expected: ${h}`)});if(!_.authorization_endpoint)throw TypeError("Authorization server did not provide an authorization endpoint.");o=new URL(_.authorization_endpoint)}let s=o.searchParams,l=n.callbackUrl;!t.isOnRedirectProxy&&n.redirectProxyUrl&&(l=n.redirectProxyUrl,i=n.callbackUrl,a.debug("using redirect proxy",{redirect_uri:l,data:i}));let p=Object.assign({response_type:"code",client_id:n.clientId,redirect_uri:l,...n.authorization?.params},Object.fromEntries(n.authorization?.url.searchParams??[]),e);for(let h in p)s.set(h,p[h]);let d=[];n.authorization?.url.searchParams.get("response_mode")==="form_post"&&(t.cookies.state.options.sameSite="none",t.cookies.state.options.secure=!0,t.cookies.nonce.options.sameSite="none",t.cookies.nonce.options.secure=!0);let c=await Li.create(t,i);if(c&&(s.set("state",c.value),d.push(c.cookie)),n.checks?.includes("pkce"))if(r&&!r.code_challenge_methods_supported?.includes("S256"))n.type==="oidc"&&(n.checks=["nonce"]);else{let{value:h,cookie:A}=await _a.create(t);s.set("code_challenge",h),s.set("code_challenge_method","S256"),d.push(A)}let f=await Aa.create(t);return f&&(s.set("nonce",f.value),d.push(f.cookie)),n.type!=="oidc"||o.searchParams.has("scope")||o.searchParams.set("scope","openid profile email"),a.debug("authorization url is ready",{url:o,cookies:d,provider:n}),{redirect:o.toString(),cookies:d}}async function ic(e,t){let r,{body:i}=e,{provider:a,callbacks:n,adapter:o}=t,s=(a.normalizeIdentifier??function(g){if(!g)throw Error("Missing email from request body.");let[u,m]=g.toLowerCase().trim().split("@");return m=m.split(",")[0],`${u}@${m}`})(i?.email),l={id:crypto.randomUUID(),email:s,emailVerified:null},p=await o.getUserByEmail(s)??l,d={providerAccountId:s,userId:p.id,type:"email",provider:a.id};try{r=await n.signIn({user:p,account:d,email:{verificationRequest:!0}})}catch(g){throw new b(g)}if(!r)throw new b("AccessDenied");if(typeof r=="string")return{redirect:await n.redirect({url:r,baseUrl:t.url.origin})};let{callbackUrl:c,theme:f}=t,h=await a.generateVerificationToken?.()??wi(32),A=new Date(Date.now()+(a.maxAge??86400)*1e3),_=a.secret??t.secret,S=new URL(t.basePath,t.url.origin),H=a.sendVerificationRequest({identifier:s,token:h,expires:A,url:`${S}/callback/${a.id}?${new URLSearchParams({callbackUrl:c,token:h,email:s})}`,provider:a,theme:f,request:new Request(e.url,{headers:e.headers,method:e.method,body:e.method==="POST"?JSON.stringify(e.body??{}):void 0})}),T=o.createVerificationToken?.({identifier:s,token:await Ur(`${h}${_}`),expires:A});return await Promise.all([H,T]),{redirect:`${S}/verify-request?${new URLSearchParams({provider:a.id,type:a.type})}`}}async function nc(e,t,r){let i=`${r.url.origin}${r.basePath}/signin`;if(!r.provider)return{redirect:i,cookies:t};switch(r.provider.type){case"oauth":case"oidc":{let{redirect:a,cookies:n}=await rc(e.query,r);return n&&t.push(...n),{redirect:a,cookies:t}}case"email":return{...await ic(e,r),cookies:t};default:return{redirect:i,cookies:t}}}async function ac(e,t,r){let{jwt:i,events:a,callbackUrl:n,logger:o,session:s}=r,l=t.value;if(!l)return{redirect:n,cookies:e};try{if(s.strategy==="jwt"){let p=r.cookies.sessionToken.name,d=await i.decode({...i,token:l,salt:p});await a.signOut?.({token:d})}else{let p=await r.adapter?.deleteSession(l);await a.signOut?.({session:p})}}catch(p){o.error(new Yt(p))}return e.push(...t.clean()),{redirect:n,cookies:e}}async function oc(e,t){let{adapter:r,jwt:i,session:{strategy:a}}=e,n=t.value;if(!n)return null;if(a==="jwt"){let o=e.cookies.sessionToken.name,s=await i.decode({...i,token:n,salt:o});if(s&&s.sub)return{id:s.sub,name:s.name,email:s.email,image:s.picture}}else{let o=await r?.getSessionAndUser(n);if(o)return o.user}return null}async function sc(e,t,r,i){let a=Ta(t),{provider:n}=a,{action:o}=e.query??{};if(o!=="register"&&o!=="authenticate"&&o!==void 0)return{status:400,body:{error:"Invalid action"},cookies:i,headers:{"Content-Type":"application/json"}};let s=await oc(t,r),l=s?{user:s,exists:!0}:await n.getUserInfo(t,e),p=l?.user;switch(function(d,c,f){let{user:h,exists:A=!1}=f??{};switch(d){case"authenticate":return"authenticate";case"register":if(h&&c===A)return"register";break;case void 0:if(!c)return h?A?"authenticate":"register":"authenticate"}return null}(o,!!s,l)){case"authenticate":return Zs(a,e,p,i);case"register":if(typeof p?.email=="string")return Xs(a,e,p,i);break;default:return{status:400,body:{error:"Invalid request"},cookies:i,headers:{"Content-Type":"application/json"}}}}async function cc(e,t){let{action:r,providerId:i,error:a,method:n}=e,o=t.skipCSRFCheck===$r,{options:s,cookies:l}=await Wo({authOptions:t,action:r,providerId:i,url:e.url,callbackUrl:e.body?.callbackUrl??e.query?.callbackUrl,csrfToken:e.body?.csrfToken,cookies:e.cookies,isPost:n==="POST",csrfDisabled:o}),p=new Me(s.cookies.sessionToken,e.cookies,s.logger);if(n==="GET"){let d=zn({...s,query:e.query,cookies:l});switch(r){case"callback":return await Ua(e,s,p,l);case"csrf":return d.csrf(o,s,l);case"error":return d.error(a);case"providers":return d.providers(s.providers);case"session":return await Ca(s,p,l);case"signin":return d.signin(i,a);case"signout":return d.signout();case"verify-request":return d.verifyRequest();case"webauthn-options":return await sc(e,s,p,l)}}else{let{csrfTokenVerified:d}=s;switch(r){case"callback":return s.provider.type==="credentials"&&Cr(r,d),await Ua(e,s,p,l);case"session":return Cr(r,d),await Ca(s,p,l,!0,e.body?.data);case"signin":return Cr(r,d),await nc(e,l,s);case"signout":return Cr(r,d),await ac(l,p,s)}}throw new qe(`Cannot handle action: ${r}`)}function ti(e,t,r,i,a){let n,o=a?.basePath,s=i.AUTH_URL??i.NEXTAUTH_URL;if(s)n=new URL(s),o&&o!=="/"&&n.pathname!=="/"&&(n.pathname!==o&&cr(a).warn("env-url-basepath-mismatch"),n.pathname="/");else{let p=r.get("x-forwarded-host")??r.get("host"),d=r.get("x-forwarded-proto")??t??"https",c=d.endsWith(":")?d:d+":";n=new URL(`${c}//${p}`)}let l=n.toString().replace(/\/$/,"");if(o){let p=o?.replace(/(^\/|\/$)/g,"")??"";return new URL(`${l}/${p}/${e}`)}return new URL(`${l}/${e}`)}async function Gt(e,t){let r=cr(t),i=await Ro(e,t);if(!i)return Response.json("Bad request.",{status:400});let a=function(s,l){let{url:p}=s,d=[];if(!ct&&l.debug&&d.push("debug-enabled"),!l.trustHost)return new Wt(`Host must be trusted. URL was: ${s.url}`);if(!l.secret?.length)return new ze("Please define a `secret`");let c=s.query?.callbackUrl;if(c&&!ir(c,p.origin))return new xe(`Invalid callback URL. Received: ${c}`);let{callbackUrl:f}=Ee(l.useSecureCookies??p.protocol==="https:"),h=s.cookies?.[l.cookies?.callbackUrl?.name??f.name];if(h&&!ir(h,p.origin))return new xe(`Invalid callback URL. Received: ${h}`);let A=!1;for(let g of l.providers){let u=typeof g=="function"?g():g;if((u.type==="oauth"||u.type==="oidc")&&!(u.issuer??u.options?.issuer)){let m,{authorization:w,token:E,userinfo:U}=u;if(typeof w=="string"||w?.url?typeof E=="string"||E?.url?typeof U=="string"||U?.url||(m="userinfo"):m="token":m="authorization",m)return new Z(`Provider "${u.id}" is missing both \`issuer\` and \`${m}\` endpoint config. At least one of them is required`)}if(u.type==="credentials")lt=!0;else if(u.type==="email")St=!0;else if(u.type==="webauthn"){var _;if(ut=!0,u.simpleWebAuthnBrowserVersion&&(_=u.simpleWebAuthnBrowserVersion,!/^v\d+(?:\.\d+){0,2}$/.test(_)))return new B(`Invalid provider config for "${u.id}": simpleWebAuthnBrowserVersion "${u.simpleWebAuthnBrowserVersion}" must be a valid semver string.`);if(u.enableConditionalUI){if(A)return new Kt("Multiple webauthn providers have 'enableConditionalUI' set to True. Only one provider can have this option enabled at a time");if(A=!0,!Object.values(u.formFields).some(m=>m.autocomplete&&m.autocomplete.toString().indexOf("webauthn")>-1))return new rr(`Provider "${u.id}" has 'enableConditionalUI' set to True, but none of its formFields have 'webauthn' in their autocomplete param`)}}}if(lt){let g=l.session?.strategy==="database",u=!l.providers.some(m=>(typeof m=="function"?m():m).type!=="credentials");if(g&&u)return new Qt("Signing in with credentials only supported if JWT strategy is enabled");if(l.providers.some(m=>{let w=typeof m=="function"?m():m;return w.type==="credentials"&&!w.authorize}))return new Be("Must define an authorize() handler to use credentials authentication provider")}let{adapter:S,session:H}=l,T=[];if(St||H?.strategy==="database"||!H?.strategy&&S)if(St){if(!S)return new O("Email login requires an adapter");T.push(...nr)}else{if(!S)return new O("Database session requires an adapter");T.push(..._r)}if(ut){if(!l.experimental?.enableWebAuthn)return new vr("WebAuthn is an experimental feature. To enable it, set `experimental.enableWebAuthn` to `true` in your config");if(d.push("experimental-webauthn"),!S)return new O("WebAuthn requires an adapter");T.push(...kr)}if(S){let g=T.filter(u=>!(u in S));if(g.length)return new ue(`Required adapter methods were missing: ${g.join(", ")}`)}return ct||(ct=!0),d}(i,t);if(Array.isArray(a))a.forEach(r.warn);else if(a){if(r.error(a),!new Set(["signin","signout","error","verify-request"]).has(i.action)||i.method!=="GET")return Response.json({message:"There was a problem with the server configuration. Check the server logs for more information."},{status:500});let{pages:s,theme:l}=t,p=s?.error&&i.url.searchParams.get("callbackUrl")?.startsWith(s.error);if(!s?.error||p)return p&&r.error(new v(`The error page ${s?.error} should not require authentication`)),An(zn({theme:l}).error("Configuration"));let d=`${i.url.origin}${s.error}?error=Configuration`;return Response.redirect(d)}let n=e.headers?.has("X-Auth-Return-Redirect"),o=t.raw===Ir;try{let s=await cc(i,t);if(o)return s;let l=An(s),p=l.headers.get("Location");return!n||!p?l:Response.json({url:p},{headers:l.headers})}catch(s){r.error(s);let l=s instanceof B;if(l&&o&&!n)throw s;if(e.method==="POST"&&i.action==="session")return Response.json(null,{status:400});let p=new URLSearchParams({error:s instanceof B&&tr.has(s.type)?s.type:"Configuration"});s instanceof De&&p.set("code",s.code);let d=l&&s.kind||"error",c=t.pages?.[d]??`${t.basePath}/${d.toLowerCase()}`,f=`${i.url.origin}${c}?${p}`;return n?Response.json({url:f}):Response.redirect(f)}}var ri=V(70974);function Mi(e){let t=process.env.AUTH_URL??process.env.NEXTAUTH_URL;if(!t)return e;let{origin:r}=new URL(t),{href:i,origin:a}=e.nextUrl;return new ri.J8(i.replace(a,r),e)}function Xt(e){try{e.secret??(e.secret=process.env.AUTH_SECRET??process.env.NEXTAUTH_SECRET);let t=process.env.AUTH_URL??process.env.NEXTAUTH_URL;if(!t)return;let{pathname:r}=new URL(t);if(r==="/")return;e.basePath||(e.basePath=r)}catch{}finally{e.basePath||(e.basePath="/api/auth"),function(t,r,i=!1){try{let a=t.AUTH_URL;a&&(r.basePath?i||cr(r).warn("env-url-basepath-redundant"):r.basePath=new URL(a).pathname)}catch{}finally{r.basePath??(r.basePath="/auth")}if(!r.secret?.length){r.secret=[];let a=t.AUTH_SECRET;for(let n of(a&&r.secret.push(a),[1,2,3])){let o=t[`AUTH_SECRET_${n}`];o&&r.secret.unshift(o)}}r.redirectProxyUrl??(r.redirectProxyUrl=t.AUTH_REDIRECT_PROXY_URL),r.trustHost??(r.trustHost=!!(t.AUTH_URL??t.AUTH_TRUST_HOST??t.VERCEL??t.CF_PAGES??t.NODE_ENV!=="production")),r.providers=r.providers.map(a=>{let{id:n}=typeof a=="function"?a({}):a,o=n.toUpperCase().replace(/-/g,"_"),s=t[`AUTH_${o}_ID`],l=t[`AUTH_${o}_SECRET`],p=t[`AUTH_${o}_ISSUER`],d=t[`AUTH_${o}_KEY`],c=typeof a=="function"?a({clientId:s,clientSecret:l,issuer:p,apiKey:d}):a;return c.type==="oauth"||c.type==="oidc"?(c.clientId??(c.clientId=s),c.clientSecret??(c.clientSecret=l),c.issuer??(c.issuer=p)):c.type==="email"&&(c.apiKey??(c.apiKey=d)),c})}(process.env,e,!0)}}var _t=V(22710);async function br(e,t){return Gt(new Request(ti("session",e.get("x-forwarded-proto"),e,process.env,t),{headers:{cookie:e.get("cookie")??""}}),{...t,callbacks:{...t.callbacks,async session(...r){let i=await t.callbacks?.session?.(...r)??{...r[0].session,expires:r[0].session.expires?.toISOString?.()??r[0].session.expires};return{user:r[0].user??r[0].token,...i}}}})}function Pa(e){return typeof e=="function"}function Ra(e,t){return typeof e=="function"?async(...r)=>{if(!r.length){let o=await(0,_t.b3)(),s=await e(void 0);return t?.(s),br(o,s).then(l=>l.json())}if(r[0]instanceof Request){let o=r[0],s=r[1],l=await e(o);return t?.(l),ii([o,s],l)}if(Pa(r[0])){let o=r[0];return async(...s)=>{let l=await e(s[0]);return t?.(l),ii(s,l,o)}}let i="req"in r[0]?r[0].req:r[0],a="res"in r[0]?r[0].res:r[1],n=await e(i);return t?.(n),br(new Headers(i.headers),n).then(async o=>{let s=await o.json();for(let l of o.headers.getSetCookie())"headers"in a?a.headers.append("set-cookie",l):a.appendHeader("set-cookie",l);return s})}:(...r)=>{if(!r.length)return Promise.resolve((0,_t.b3)()).then(n=>br(n,e).then(o=>o.json()));if(r[0]instanceof Request)return ii([r[0],r[1]],e);if(Pa(r[0])){let n=r[0];return async(...o)=>ii(o,e,n).then(s=>s)}let i="req"in r[0]?r[0].req:r[0],a="res"in r[0]?r[0].res:r[1];return br(new Headers(i.headers),e).then(async n=>{let o=await n.json();for(let s of n.headers.getSetCookie())"headers"in a?a.headers.append("set-cookie",s):a.appendHeader("set-cookie",s);return o})}}async function ii(e,t,r){let i=Mi(e[0]),a=await br(i.headers,t),n=await a.json(),o=!0;t.callbacks?.authorized&&(o=await t.callbacks.authorized({request:i,auth:n}));let s=ri.Rp.next?.();if(o instanceof Response){s=o;let p=o.headers.get("Location"),{pathname:d}=i.nextUrl;p&&function(c,f,h){let A=f.replace(`${c}/`,""),_=Object.values(h.pages??{});return(lc.has(A)||_.includes(f))&&f===c}(d,new URL(p).pathname,t)&&(o=!0)}else if(r)i.auth=n,s=await r(i,e[1])??ri.Rp.next();else if(!o){let p=t.pages?.signIn??`${t.basePath}/signin`;if(i.nextUrl.pathname!==p){let d=i.nextUrl.clone();d.pathname=p,d.searchParams.set("callbackUrl",i.nextUrl.href),s=ri.Rp.redirect(d)}}let l=new Response(s?.body,s);for(let p of a.headers.getSetCookie())l.headers.append("set-cookie",p);return l}let lc=new Set(["providers","session","csrf","signin","signout","callback","verify-request","error"]);var ni=V(32945);async function $a(e,t={},r,i){let a=new Headers(await(0,_t.b3)()),{redirect:n=!0,redirectTo:o,...s}=t instanceof FormData?Object.fromEntries(t):t,l=o?.toString()??a.get("Referer")??"/",p=ti("signin",a.get("x-forwarded-proto"),a,process.env,i);if(!e)return p.searchParams.append("callbackUrl",l),n&&(0,ni.V2)(p.toString()),p.toString();let d=`${p}/${e}?${new URLSearchParams(r)}`,c={};for(let S of i.providers){let{options:H,...T}=typeof S=="function"?S():S,g=H?.id??T.id;if(g===e){c={id:g,type:H?.type??T.type};break}}if(!c.id){let S=`${p}?${new URLSearchParams({callbackUrl:l})}`;return n&&(0,ni.V2)(S),S}c.type==="credentials"&&(d=d.replace("signin","callback")),a.set("Content-Type","application/x-www-form-urlencoded");let f=new Request(d,{method:"POST",headers:a,body:new URLSearchParams({...s,callbackUrl:l})}),h=await Gt(f,{...i,raw:Ir,skipCSRFCheck:$r}),A=await(0,_t.UL)();for(let S of h?.cookies??[])A.set(S.name,S.value,S.options);let _=(h instanceof Response?h.headers.get("Location"):h.redirect)??d;return n?(0,ni.V2)(_):_}async function Ia(e,t){let r=new Headers(await(0,_t.b3)());r.set("Content-Type","application/x-www-form-urlencoded");let i=ti("signout",r.get("x-forwarded-proto"),r,process.env,t),a=new URLSearchParams({callbackUrl:e?.redirectTo??r.get("Referer")??"/"}),n=new Request(i,{method:"POST",headers:r,body:a}),o=await Gt(n,{...t,raw:Ir,skipCSRFCheck:$r}),s=await(0,_t.UL)();for(let l of o?.cookies??[])s.set(l.name,l.value,l.options);return e?.redirect??!0?(0,ni.V2)(o.redirect):o}async function Oa(e,t){let r=new Headers(await(0,_t.b3)());r.set("Content-Type","application/json");let i=new Request(ti("session",r.get("x-forwarded-proto"),r,process.env,t),{method:"POST",headers:r,body:JSON.stringify({data:e})}),a=await Gt(i,{...t,raw:Ir,skipCSRFCheck:$r}),n=await(0,_t.UL)();for(let o of a?.cookies??[])n.set(o.name,o.value,o.options);return a.body}function uc(e){if(typeof e=="function"){let r=async i=>{let a=await e(i);return Xt(a),Gt(Mi(i),a)};return{handlers:{GET:r,POST:r},auth:Ra(e,i=>Xt(i)),signIn:async(i,a,n)=>{let o=await e(void 0);return Xt(o),$a(i,a,n,o)},signOut:async i=>{let a=await e(void 0);return Xt(a),Ia(i,a)},unstable_update:async i=>{let a=await e(void 0);return Xt(a),Oa(i,a)}}}Xt(e);let t=r=>Gt(Mi(r),e);return{handlers:{GET:t,POST:t},auth:Ra(e),signIn:(r,i,a)=>$a(r,i,a,e),signOut:r=>Ia(r,e),unstable_update:r=>Oa(r,e)}}},at.__chunk_56474=(Ge,Ue,V)=>{"use strict";V.d(Ue,{X:()=>function ie(J){if((0,He.p)(J)||(0,Ce.C)(J)||(0,fe.isDynamicServerError)(J)||(0,ne.I3)(J)||(0,be.D)(J)||(0,ge.T)(J))throw J;J instanceof Error&&"cause"in J&&ie(J.cause)}});var ge=V(10252),be=V(6133),Ce=V(44430),He=V(770),ne=V(899),fe=V(40007)},at.__chunk_42409=(Ge,Ue,V)=>{var ge;(()=>{var be={226:function(ne,fe){(function(ie,J){"use strict";var de="function",Ee="undefined",Me="object",B="string",Pe="major",k="model",b="name",y="type",v="vendor",P="version",xe="architecture",De="console",Z="mobile",q="tablet",R="smarttv",O="wearable",ue="embedded",Be="Amazon",ze="Apple",ot="ASUS",It="BlackBerry",et="Browser",kt="Chrome",Ot="Firefox",Ht="Google",Yt="Huawei",qe="Microsoft",Qt="Motorola",tt="Opera",Wt="Samsung",er="Sharp",At="Sony",tr="Xiaomi",Kt="Zebra",rr="Facebook",st="Chromium OS",Dt="Mac OS",vr=function(ee,ae){var N={};for(var oe in ee)ae[oe]&&ae[oe].length%2==0?N[oe]=ae[oe].concat(ee[oe]):N[oe]=ee[oe];return N},ct=function(ee){for(var ae={},N=0;N<ee.length;N++)ae[ee[N].toUpperCase()]=ee[N];return ae},ir=function(ee,ae){return typeof ee===B&&lt(ae).indexOf(lt(ee))!==-1},lt=function(ee){return ee.toLowerCase()},St=function(ee,ae){if(typeof ee===B)return ee=ee.replace(/^\s\s*/,""),typeof ae===Ee?ee:ee.substring(0,350)},ut=function(ee,ae){for(var N,oe,ve,te,je,F,ce=0;ce<ae.length&&!je;){var _e=ae[ce],Ne=ae[ce+1];for(N=oe=0;N<_e.length&&!je&&_e[N];)if(je=_e[N++].exec(ee))for(ve=0;ve<Ne.length;ve++)F=je[++oe],typeof(te=Ne[ve])===Me&&te.length>0?te.length===2?typeof te[1]==de?this[te[0]]=te[1].call(this,F):this[te[0]]=te[1]:te.length===3?typeof te[1]!==de||te[1].exec&&te[1].test?this[te[0]]=F?F.replace(te[1],te[2]):void 0:this[te[0]]=F?te[1].call(this,F,te[2]):void 0:te.length===4&&(this[te[0]]=F?te[3].call(this,F.replace(te[1],te[2])):J):this[te]=F||J;ce+=2}},nr=function(ee,ae){for(var N in ae)if(typeof ae[N]===Me&&ae[N].length>0){for(var oe=0;oe<ae[N].length;oe++)if(ir(ae[N][oe],ee))return N==="?"?J:N}else if(ir(ae[N],ee))return N==="?"?J:N;return ee},_r={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},kr={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[P,[b,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[P,[b,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[b,P],[/opios[\/ ]+([\w\.]+)/i],[P,[b,tt+" Mini"]],[/\bopr\/([\w\.]+)/i],[P,[b,tt]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[b,P],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[P,[b,"UC"+et]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[P,[b,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[P,[b,"WeChat"]],[/konqueror\/([\w\.]+)/i],[P,[b,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[P,[b,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[P,[b,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[b,/(.+)/,"$1 Secure "+et],P],[/\bfocus\/([\w\.]+)/i],[P,[b,Ot+" Focus"]],[/\bopt\/([\w\.]+)/i],[P,[b,tt+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[P,[b,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[P,[b,"Dolphin"]],[/coast\/([\w\.]+)/i],[P,[b,tt+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[P,[b,"MIUI "+et]],[/fxios\/([-\w\.]+)/i],[P,[b,Ot]],[/\bqihu|(qi?ho?o?|360)browser/i],[[b,"360 "+et]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[b,/(.+)/,"$1 "+et],P],[/(comodo_dragon)\/([\w\.]+)/i],[[b,/_/g," "],P],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[b,P],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[b],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[b,rr],P],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[b,P],[/\bgsa\/([\w\.]+) .*safari\//i],[P,[b,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[P,[b,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[P,[b,kt+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[b,kt+" WebView"],P],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[P,[b,"Android "+et]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[b,P],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[P,[b,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[P,b],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[b,[P,nr,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[b,P],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[b,"Netscape"],P],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[P,[b,Ot+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[b,P],[/(cobalt)\/([\w\.]+)/i],[b,[P,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[xe,"amd64"]],[/(ia32(?=;))/i],[[xe,lt]],[/((?:i[346]|x)86)[;\)]/i],[[xe,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[xe,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[xe,"armhf"]],[/windows (ce|mobile); ppc;/i],[[xe,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[xe,/ower/,"",lt]],[/(sun4\w)[;\)]/i],[[xe,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[xe,lt]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[k,[v,Wt],[y,q]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[k,[v,Wt],[y,Z]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[k,[v,ze],[y,Z]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[k,[v,ze],[y,q]],[/(macintosh);/i],[k,[v,ze]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[k,[v,er],[y,Z]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[k,[v,Yt],[y,q]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[k,[v,Yt],[y,Z]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[k,/_/g," "],[v,tr],[y,Z]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[k,/_/g," "],[v,tr],[y,q]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[k,[v,"OPPO"],[y,Z]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[k,[v,"Vivo"],[y,Z]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[k,[v,"Realme"],[y,Z]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[k,[v,Qt],[y,Z]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[k,[v,Qt],[y,q]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[k,[v,"LG"],[y,q]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[k,[v,"LG"],[y,Z]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[k,[v,"Lenovo"],[y,q]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[k,/_/g," "],[v,"Nokia"],[y,Z]],[/(pixel c)\b/i],[k,[v,Ht],[y,q]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[k,[v,Ht],[y,Z]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[k,[v,At],[y,Z]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[k,"Xperia Tablet"],[v,At],[y,q]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[k,[v,"OnePlus"],[y,Z]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[k,[v,Be],[y,q]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[k,/(.+)/g,"Fire Phone $1"],[v,Be],[y,Z]],[/(playbook);[-\w\),; ]+(rim)/i],[k,v,[y,q]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[k,[v,It],[y,Z]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[k,[v,ot],[y,q]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[k,[v,ot],[y,Z]],[/(nexus 9)/i],[k,[v,"HTC"],[y,q]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[v,[k,/_/g," "],[y,Z]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[k,[v,"Acer"],[y,q]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[k,[v,"Meizu"],[y,Z]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[v,k,[y,Z]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[v,k,[y,q]],[/(surface duo)/i],[k,[v,qe],[y,q]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[k,[v,"Fairphone"],[y,Z]],[/(u304aa)/i],[k,[v,"AT&T"],[y,Z]],[/\bsie-(\w*)/i],[k,[v,"Siemens"],[y,Z]],[/\b(rct\w+) b/i],[k,[v,"RCA"],[y,q]],[/\b(venue[\d ]{2,7}) b/i],[k,[v,"Dell"],[y,q]],[/\b(q(?:mv|ta)\w+) b/i],[k,[v,"Verizon"],[y,q]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[k,[v,"Barnes & Noble"],[y,q]],[/\b(tm\d{3}\w+) b/i],[k,[v,"NuVision"],[y,q]],[/\b(k88) b/i],[k,[v,"ZTE"],[y,q]],[/\b(nx\d{3}j) b/i],[k,[v,"ZTE"],[y,Z]],[/\b(gen\d{3}) b.+49h/i],[k,[v,"Swiss"],[y,Z]],[/\b(zur\d{3}) b/i],[k,[v,"Swiss"],[y,q]],[/\b((zeki)?tb.*\b) b/i],[k,[v,"Zeki"],[y,q]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[v,"Dragon Touch"],k,[y,q]],[/\b(ns-?\w{0,9}) b/i],[k,[v,"Insignia"],[y,q]],[/\b((nxa|next)-?\w{0,9}) b/i],[k,[v,"NextBook"],[y,q]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[v,"Voice"],k,[y,Z]],[/\b(lvtel\-)?(v1[12]) b/i],[[v,"LvTel"],k,[y,Z]],[/\b(ph-1) /i],[k,[v,"Essential"],[y,Z]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[k,[v,"Envizen"],[y,q]],[/\b(trio[-\w\. ]+) b/i],[k,[v,"MachSpeed"],[y,q]],[/\btu_(1491) b/i],[k,[v,"Rotor"],[y,q]],[/(shield[\w ]+) b/i],[k,[v,"Nvidia"],[y,q]],[/(sprint) (\w+)/i],[v,k,[y,Z]],[/(kin\.[onetw]{3})/i],[[k,/\./g," "],[v,qe],[y,Z]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[k,[v,Kt],[y,q]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[k,[v,Kt],[y,Z]],[/smart-tv.+(samsung)/i],[v,[y,R]],[/hbbtv.+maple;(\d+)/i],[[k,/^/,"SmartTV"],[v,Wt],[y,R]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[v,"LG"],[y,R]],[/(apple) ?tv/i],[v,[k,ze+" TV"],[y,R]],[/crkey/i],[[k,kt+"cast"],[v,Ht],[y,R]],[/droid.+aft(\w)( bui|\))/i],[k,[v,Be],[y,R]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[k,[v,er],[y,R]],[/(bravia[\w ]+)( bui|\))/i],[k,[v,At],[y,R]],[/(mitv-\w{5}) bui/i],[k,[v,tr],[y,R]],[/Hbbtv.*(technisat) (.*);/i],[v,k,[y,R]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[v,St],[k,St],[y,R]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[y,R]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[v,k,[y,De]],[/droid.+; (shield) bui/i],[k,[v,"Nvidia"],[y,De]],[/(playstation [345portablevi]+)/i],[k,[v,At],[y,De]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[k,[v,qe],[y,De]],[/((pebble))app/i],[v,k,[y,O]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[k,[v,ze],[y,O]],[/droid.+; (glass) \d/i],[k,[v,Ht],[y,O]],[/droid.+; (wt63?0{2,3})\)/i],[k,[v,Kt],[y,O]],[/(quest( 2| pro)?)/i],[k,[v,rr],[y,O]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[v,[y,ue]],[/(aeobc)\b/i],[k,[v,Be],[y,ue]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[k,[y,Z]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[k,[y,q]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[y,q]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[y,Z]],[/(android[-\w\. ]{0,9});.+buil/i],[k,[v,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[P,[b,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[P,[b,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[b,P],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[P,b]],os:[[/microsoft (windows) (vista|xp)/i],[b,P],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[b,[P,nr,_r]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[b,"Windows"],[P,nr,_r]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[P,/_/g,"."],[b,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[b,Dt],[P,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[P,b],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[b,P],[/\(bb(10);/i],[P,[b,It]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[P,[b,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[P,[b,Ot+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[P,[b,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[P,[b,"watchOS"]],[/crkey\/([\d\.]+)/i],[P,[b,kt+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[b,st],P],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[b,P],[/(sunos) ?([\w\.\d]*)/i],[[b,"Solaris"],P],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[b,P]]},Ie=function(ee,ae){if(typeof ee===Me&&(ae=ee,ee=J),!(this instanceof Ie))return new Ie(ee,ae).getResult();var N=typeof ie!==Ee&&ie.navigator?ie.navigator:J,oe=ee||(N&&N.userAgent?N.userAgent:""),ve=N&&N.userAgentData?N.userAgentData:J,te=ae?vr(kr,ae):kr,je=N&&N.userAgent==oe;return this.getBrowser=function(){var F,ce={};return ce[b]=J,ce[P]=J,ut.call(ce,oe,te.browser),ce[Pe]=typeof(F=ce[P])===B?F.replace(/[^\d\.]/g,"").split(".")[0]:J,je&&N&&N.brave&&typeof N.brave.isBrave==de&&(ce[b]="Brave"),ce},this.getCPU=function(){var F={};return F[xe]=J,ut.call(F,oe,te.cpu),F},this.getDevice=function(){var F={};return F[v]=J,F[k]=J,F[y]=J,ut.call(F,oe,te.device),je&&!F[y]&&ve&&ve.mobile&&(F[y]=Z),je&&F[k]=="Macintosh"&&N&&typeof N.standalone!==Ee&&N.maxTouchPoints&&N.maxTouchPoints>2&&(F[k]="iPad",F[y]=q),F},this.getEngine=function(){var F={};return F[b]=J,F[P]=J,ut.call(F,oe,te.engine),F},this.getOS=function(){var F={};return F[b]=J,F[P]=J,ut.call(F,oe,te.os),je&&!F[b]&&ve&&ve.platform!="Unknown"&&(F[b]=ve.platform.replace(/chrome os/i,st).replace(/macos/i,Dt)),F},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return oe},this.setUA=function(F){return oe=typeof F===B&&F.length>350?St(F,350):F,this},this.setUA(oe),this};Ie.VERSION="1.0.35",Ie.BROWSER=ct([b,P,Pe]),Ie.CPU=ct([xe]),Ie.DEVICE=ct([k,v,y,De,Z,R,q,O,ue]),Ie.ENGINE=Ie.OS=ct([b,P]),typeof fe!==Ee?(ne.exports&&(fe=ne.exports=Ie),fe.UAParser=Ie):V.amdO?(ge=function(){return Ie}.call(Ue,V,Ue,Ge))===void 0||(Ge.exports=ge):typeof ie!==Ee&&(ie.UAParser=Ie);var dt=typeof ie!==Ee&&(ie.jQuery||ie.Zepto);if(dt&&!dt.ua){var pt=new Ie;dt.ua=pt.getResult(),dt.ua.get=function(){return pt.getUA()},dt.ua.set=function(ee){pt.setUA(ee);var ae=pt.getResult();for(var N in ae)dt.ua[N]=ae[N]}}})(typeof window=="object"?window:this)}},Ce={};function He(ne){var fe=Ce[ne];if(fe!==void 0)return fe.exports;var ie=Ce[ne]={exports:{}},J=!0;try{be[ne].call(ie.exports,ie,ie.exports,He),J=!1}finally{J&&delete Ce[ne]}return ie.exports}He.ab="//",Ge.exports=He(226)})()},at.__chunk_39491=(Ge,Ue,V)=>{"use strict";V.d(Ue,{hr:()=>He});let ge=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,be={baseKeyPrefix:"",accountKeyPrefix:"user:account:",accountByUserIdPrefix:"user:account:by-user-id:",emailKeyPrefix:"user:email:",sessionKeyPrefix:"user:session:",sessionByUserIdKeyPrefix:"user:session:by-user-id:",userKeyPrefix:"user:",verificationTokenKeyPrefix:"user:token:"};function Ce(ne){return Object.entries(ne).reduce((fe,[ie,J])=>(fe[ie]=typeof J=="string"&&ge.test(J)&&!isNaN(Date.parse(J))?new Date(J):J,fe),{})}function He(ne,fe={}){let ie={...be,...fe},{baseKeyPrefix:J}=ie,de=J+ie.accountKeyPrefix,Ee=J+ie.accountByUserIdPrefix,Me=J+ie.emailKeyPrefix,B=J+ie.sessionKeyPrefix,Pe=J+ie.sessionByUserIdKeyPrefix,k=J+ie.userKeyPrefix,b=J+ie.verificationTokenKeyPrefix,y=async(R,O)=>await ne.set(R,JSON.stringify(O)),v=async(R,O)=>{let ue=de+R;return await y(ue,O),await ne.set(Ee+O.userId,ue),O},P=async R=>{let O=await ne.get(de+R);return O?Ce(O):null},xe=async(R,O)=>{let ue=B+R;return await y(ue,O),await ne.set(Pe+O.userId,ue),O},De=async R=>{let O=await ne.get(B+R);return O?Ce(O):null},Z=async(R,O)=>(await y(k+R,O),await ne.set(`${Me}${O.email}`,R),O),q=async R=>{let O=await ne.get(k+R);return O?Ce(O):null};return{async createUser(R){let O=crypto.randomUUID();return await Z(O,{...R,id:O})},getUser:q,async getUserByEmail(R){let O=await ne.get(Me+R);return O?await q(O):null},async getUserByAccount(R){let O=await P(`${R.provider}:${R.providerAccountId}`);return O?await q(O.userId):null},async updateUser(R){let O=R.id,ue=await q(O);return await Z(O,{...ue,...R})},async linkAccount(R){let O=`${R.provider}:${R.providerAccountId}`;return await v(O,{...R,id:O})},createSession:R=>xe(R.sessionToken,R),async getSessionAndUser(R){let O=await De(R);if(!O)return null;let ue=await q(O.userId);return ue?{session:O,user:ue}:null},async updateSession(R){let O=await De(R.sessionToken);return O?await xe(R.sessionToken,{...O,...R}):null},async deleteSession(R){await ne.del(B+R)},createVerificationToken:async R=>(await y(b+R.identifier+":"+R.token,R),R),async useVerificationToken(R){let O=b+R.identifier+":"+R.token,ue=await ne.get(O);return ue?(await ne.del(O),Ce(ue)):null},async unlinkAccount(R){let O=`${R.provider}:${R.providerAccountId}`,ue=await P(O);if(!ue)return;let Be=`${de}${O}`;await ne.del(Be,`${Ee} + ${ue.userId}`)},async deleteUser(R){let O=await q(R);if(!O)return;let ue=Ee+R,Be=await ne.get(ue),ze=Pe+R,ot=await ne.get(ze);await ne.del(k+R,`${Me}${O.email}`,Be,ue,ot,ze)}}}},at.__chunk_35237=(Ge,Ue,V)=>{"use strict";function ge(be){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:be}}V.d(Ue,{A:()=>ge})},at.__chunk_32945=(Ge,Ue,V)=>{"use strict";V.d(Ue,{V2:()=>ge.V2});var ge=V(21353);V(71290);var be=V(29160);be.s8,be.s8,be.s8,V(56474).X},at);export{Ac as __getNamedExports};
